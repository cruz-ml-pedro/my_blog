{
  "hash": "f71723f1459be6a2df3180a602ec3aa1",
  "result": {
    "markdown": "---\ntitle: \"Cotação do ouro - Parte 4\"\nsubtitle: \"Modelos ARIMA\"\nauthor: \"Pedro Lima\"\ndate: \"2023-10-30\"\ncategories: [Modelos Estatísticos, Série-Temporal,R]\ntoc: true\ntoc-depth: 3\ndraft: true\n---\n\n::: {.cell}\n\n:::\n\n::: {.cell hash='index_cache/html/unnamed-chunk-2_a76af237a2ee277a9fa1f2bb8a0cf36e'}\n\n:::\n\n::: {.cell hash='index_cache/html/unnamed-chunk-3_da42cf6586779db4fc129bf9135930a1'}\n\n:::\n\n\n# Introdução\n\nNessa segunda post sobre a cotação do ouro, vou criar o primeiro modelo para realizar previsão dos valores de interesse. Os dados utilizados, assim como a escolha dos parâmetros utilizados para criar os modelos a seguir foram, respectivamente, adiquridos e escolhidos na [parte um]() dessa série de postos.\n\n# Modelos ARIMA-SARIMA\n\nModelos ARIMA (Autoregressive Integrated Moving Average) e SARIMA (Seasonal ARIMA) são poderosas ferramentas de análise e previsão de séries temporais amplamente usadas em estatísticas e ciência de dados.\n\nOs modelos ARIMA combinam três componentes principais: o componente autoregressivo (AR), que leva em consideração as dependências lineares entre observações passadas; o componente de média móvel (MA), que modela o ruído da série; e a diferenciação integrada (I), que lida com tendências e sazonalidades não estacionárias.\n\nOs modelos ARIMA podem ser representados da seguinte forma:\n\n$$(1 - \\phi_1 L - \\phi_2 L^2 - \\ldots - \\phi_p L^p)(1 - L)^d X_t = (1 + \\theta_1 L + \\theta_2 L^2 + \\ldots + \\theta_q L^q) \\varepsilon_t$$\n\nOnde:\n\n-   $(X_t)$ é a série temporal.\n-   $(L)$ é o operador de defasagem (lag).\n-   $(p)$ é a ordem do componente AR (auto-regressivo).\n-   $(d)$ é o número de diferenciações necessárias para tornar a série temporal estacionária.\n-   $(q)$ é a ordem do componente MA (média móvel).\n-   $(\\phi_1, \\phi_2, \\ldots, \\phi_p)$ são os coeficientes AR.\n-   $(\\theta_1, \\theta_2, \\ldots, \\theta_q)$ são os coeficientes MA.\n-   $(\\varepsilon_t)$ são erros aleatórios.\n\nOs modelos SARIMA, por sua vez, estendem os modelos ARIMA para acomodar dados que exibam componentes periódicos, fazendo isso através da inclusão da componente (S) as demais componentes presentes nos modelos ARIMA.\n\nOs modelos SARIMA podem ser representados da seguinte forma:\n\n$$\\begin{split}\n& (1 - \\phi_1 L - \\phi_2 L^2 - \\ldots - \\phi_p L^p)(1 - L)^d \\cdot \\\\\n& (1 - \\Phi_1 L^S - \\Phi_2 L^{2S} - \\ldots - \\Phi_P L^{PS})X_t = \\cdot \\\\\n& (1 + \\theta_1 L + \\theta_2 L^2 + \\ldots + \\theta_q L^q)(1 + \\Theta_1 L^S + \\Theta_2 L^{2S} + \\ldots + \\Theta_Q L^{QS})\\varepsilon_t\n\\end{split}$$\n\nOnde:\n\n-   $(X_t)$ é a série temporal.\n-   $(L)$ é o operador de defasagem (lag).\n-   $(p)$ é a ordem do componente AR (auto-regressivo).\n-   $(d)$ é o número de diferenciações necessárias para tornar a série temporal estacionária.\n-   $(q)$ é a ordem do componente MA (média móvel).\n-   $(P)$ é a ordem do componente SAR (auto-regressivo sazonal).\n-   $(D)$ é a ordem da diferenciação sazonal.\n-   $(Q)$ é a ordem do componente SMA (média móvel sazonal).\n-   $(S)$ é o período sazonal.\n-   $(\\phi_1, \\phi_2, \\ldots, \\phi_p)$ são os coeficientes AR.\n-   $(\\theta_1, \\theta_2, \\ldots, \\theta_q)$ são os coeficientes MA.\n-   $(\\Phi_1, \\Phi_2, \\ldots, \\Phi_P)$ são os coeficientes SAR.\n-   $(\\Theta_1, \\Theta_2, \\ldots, \\Theta_Q)$ são os coeficientes SMA.\n-   $(\\varepsilon_t)$ são erros aleatórios.\n\nAmbos os modelos exigem a escolha adequada das ordens dos componentes (p, d, q) e (P, D, Q, S), respectivamente, O que pode ser realizado por meio de [análise exploratória]() dos dados. Uma vez ajustados, esses componentes permitem modelar e prever uma ampla variedade de padrões em séries temporais univariadas.\n\n# Validação cruzada\n\nAntes de iniciarmos a construção do modelo vamos estabelecer um plano de validação cruzada.\n\nA validação cruzada é uma técnica fundamental em aprendizado de máquina e estatística. Ela ajuda a avaliar o desempenho de modelos ao dividir os dados em conjuntos de treinamento e teste múltiplos, mitigando o viés de seleção do conjunto de teste e fornecendo uma estimativa mais confiável do desempenho do modelo em dados não vistos. Isso é essencial para escolher e ajustar modelos de maneira adequada e geralmente envolve k-folds, onde o conjunto de dados é dividido em k partes iguais, alternando entre treinamento e teste para cada iteração.\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-4_3461f924a5ee9cede3abb9ff8379713f'}\n\n```{.r .cell-code}\ncv <- \n  gold_mean %>% \n  time_series_cv(\n    assess      = 12 * 1,\n    initial     = 12 * 7,\n    skip        = 12 * 0.5,\n    slice_limit = 8,\n    culmulatime = TRUE\n  )\n```\n:::\n\n::: {.cell hash='index_cache/html/unnamed-chunk-5_1af899da8c98373256d2c4b2ea926a00'}\n\n```{.r .cell-code}\ncv %>% \n  tk_time_series_cv_plan() %>% \n  plot_time_series_cv_plan(mes,media, .facet_ncol = 2, .interactive = FALSE)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=1440}\n:::\n:::\n\n\n# Modelos\n\nA seguir, serão criados diversos modelos, todos eles pertencentes à família ARIMA, e, posteriormente, serão comparados. Para a criação desses modelos, diferentes funções e \"motores\" serão empregados, e estes serão melhor explicados nos próximos tópicos. É importante destacar que a mesma função pode ser utilizada com diferentes \"motores\". A escolha dos \"motores\" é sempre feita por meio da função `set_engine()`.\n\n## Auto ARIMA\n\nA função auto_arima foi projetada para facilitar a modelagem e previsão de séries temporais, automatizando o processo de seleção do melhor modelo ARIMA. A função utiliza critérios de avaliação estatística, como o Critério de Informação de Akaike (AIC) e o Critério de Informação Bayesiano (BIC), para avaliar e comparar o ajuste de diferentes modelos. Além dos parâmetros ARIMA, a função também pode lidar com modelos SARIMA e selecionar automaticamente os parâmetros sazonais (P, D, Q, S) quando a série apresenta sazonalidade.\n\nApesar da automação também é permitido que você insira algumas restrições ou diretrizes para o processo de seleção, como limitar os valores máximos de p, d e q, ou forçar a inclusão de sazonalidade. Contudo a função será utilizado apenas em sua forma automática, deixando os parametros identificados durante a EDA para os demais modelos.\n\nO código a seguir faz a seleção automática do melhor modelo ARIMA através da função `arima_reg()` e do \"motor\" `auto_arima`.\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-6_444500648d5c1ea54452208c684ec360'}\n\n```{.r .cell-code}\nauto_arima <- \n  arima_reg() %>% \n  set_engine(\"auto_arima\") %>% \n  fit(media ~ mes, training(cv$splits[[1]]))\n```\n:::\n\n\n## SARIMA\n\nPara ajustar o modelo SARIMA, será utilizada a mesma função anterior, `arima_reg()`, mas com a 'engine' arima. Neste modelo, todos os parâmetros (p, d, q) e (P, D, Q, S) serão empregados. Para fins de comparação, serão criados dois modelos SARIMA, um com um componente S de 18 meses e outro com um componente S de 12 meses.\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-7_8526b5a71319b644b01e5381ac8e94c7'}\n\n```{.r .cell-code}\nmodel_arima <- \n  arima_reg(\n    seasonal_period = 16,\n    non_seasonal_ar = 1,\n        non_seasonal_differences = 1,\n        non_seasonal_ma          = 0,\n        seasonal_ar              = 1,\n        seasonal_differences     = 1,\n        seasonal_ma              = 0\n    ) %>% \n  set_engine(\"arima\") %>% \n  fit(media ~ mes, training(cv$splits[[1]]))\n```\n:::\n\n::: {.cell hash='index_cache/html/unnamed-chunk-8_c769f7bae0d422e3d36c489fd6c28410'}\n\n```{.r .cell-code}\nmodel_arima2 <- \n  arima_reg(\n    seasonal_period = 12,\n    non_seasonal_ar = 1,\n        non_seasonal_differences = 1,\n        non_seasonal_ma          = 0,\n        seasonal_ar              = 1,\n        seasonal_differences     = 1,\n        seasonal_ma              = 0\n    ) %>% \n  set_engine(\"arima\") %>% \n  fit(media ~ mes, training(cv$splits[[1]]))\n```\n:::\n\n\n## SARIMA com multiplas periodicidades\n\nTrata-se de uma extensão do modelo SARIMA tradicional, que possibilita a incorporação de múltiplas sazonalidades em uma série temporal. Este modelo é especialmente útil quando os dados apresentam padrões sazonais em diferentes escalas de tempo.\n\nPara a criação desse modelo foi utilizada a função `season_reg()` e a 'engine' `stlm_arima`. Uma aordagem que combina a decomposição de sazonalidade e tendência usando STLM (Seasonal and Trend decomposition using Loess) com a modelagem ARIMA para fazer previsões em séries temporais. Isso é comum ao usar a decomposição STLM para entender a estrutura da série temporal e, em seguida, aplicar modelos ARIMA ajustados aos dados decompostos para fazer previsões mais precisas.\n\nSerão consideradas apenas as componentes de 18 e 12 meses, uma vez que a componente de 6 meses não se mostrou consistente ao longo dos dados.\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-9_4638342f85410503776da0350411ad1c'}\n\n```{.r .cell-code}\narima_m_season <- \n  seasonal_reg(\n    seasonal_period_1 = 16,\n    seasonal_period_2 = 12\n  ) %>% \n  set_engine(\"stlm_arima\") %>% \n  fit(media ~ mes, training(cv$splits[[1]]))\n```\n:::\n\n\n## ARIMA + XGBOOST dos erros\n\nA combinação de modelos SARIMA com algoritmos de machine learning, como o XGBoost (Extreme Gradient Boosting), é uma abordagem útil para melhorar a previsão de séries temporais, especialmente quando os dados exibem padrões complexos e não lineares. A ideia principal é aproveitar a capacidade de ambos os modelos para capturar diferentes aspectos da série temporal.\n\nA função aqui utilizada, arima_boost(), é uma maneira de gerar uma especificação de um modelo de série temporal que utiliza o boosting para melhorar a modelagem de erros (residuais) em Regressores Exógenos. Funciona tanto com o ARIMA \"automático\" (auto_arima) quanto com o ARIMA padrão (arima). Os principais algoritmos são:\n\n-   engine = auto_arima_xgboost\n\n-   ngine = arima_xgboost\n\nEsta função permite não apenas a seleção dos parâmetros comuns aos modelos SARIMA, mas também a seleção dos parâmetros associados ao modelo XGBoost. Como mencionado, essa abordagem tem como foco a melhoria dos resultados relacionados aos regressores exógenos, que são criados no seguinte trecho de código: `media ~ mes + as.numeric(mes) + factor(month(mes, label = TRUE), ordered = F)`.\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-10_5ea4bf549ec43b4eddb468de54e7d688'}\n\n```{.r .cell-code}\nmodel_fit_arima_boosted <- \n  arima_boost(\n    seasonal_period = 16,\n    non_seasonal_ar = 1,\n    non_seasonal_differences = 1,\n    non_seasonal_ma = 0,\n    seasonal_ar     = 1,\n    seasonal_differences = 1,\n    seasonal_ma     = 0,\n\n    # XGBoost Args\n    tree_depth = 6,\n    learn_rate = 0.015,\n    min_n = 2) %>% \n  set_engine(\"arima_xgboost\") %>% \n  fit(media ~ mes + as.numeric(mes) + factor(month(mes, label = TRUE), ordered = F),\n        data = training(cv$splits[[1]]))\n```\n:::\n\n\n# Comparando os modelos\n\nPara realizar a comparação dos modelos ajustados, o pacote `modeltime` disponibiliza a função `model_table()`, que permite a aplicação de diferentes procedimentos a todos os modelos de uma só vez.\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-11_1bd60c0fd6c1f276f117ef016f4db3be'}\n\n```{.r .cell-code}\nmodel_table <- \nmodeltime_table(\n  auto_arima,\n  model_arima,\n  model_arima2,\n  arima_m_season,\n  model_fit_arima_boosted\n)\n```\n:::\n\n\n# Calibrando\n\nA seguir, iremos calibrar os modelos usando os dados de teste. A calibração estabelece os fundamentos para a criação dos resultados de acurácia, resíduos dos modelos, e dos intervalos de confiança nas previsões.\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-12_ff993982f82befff4d60dea8e2311e84'}\n\n```{.r .cell-code}\ncalib_table <- \n  model_table %>% \n  modeltime_calibrate(testing(cv$splits[[1]]))\n```\n:::\n\n\n# Residual\n\nCom os modelos calibrados, podemos avaliar os resíduos dos modelos. A função `modeltime_residuals()`, em conjunto com a função `plot_modeltime_residuals()`, oferece diversas opções de visualização dos resíduos, que incluem:\n\n-   timeplot\n-   acf\n-   seasonality\n\nAqui será utilizado a opção acf/pacf\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-13_4bd82df54af4108b64d96c1658a9f37d'}\n\n```{.r .cell-code}\ncalib_table %>% \n  modeltime_residuals() %>% \n  plot_modeltime_residuals(\n     .type = \"acf\",\n     .interactive = FALSE\n     )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-13-1.png){width=1440}\n:::\n:::\n\n\n# Acurácia\n\nOperando da mesma forma que as funções relacionadas aos resíduos dos modelos, o código a seguir gera uma tabela com os valores das métricas usadas para avaliar a qualidade dos modelos.\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-14_232d548f1e2fdf9f9c9f6656cd5a6d75'}\n\n```{.r .cell-code}\ncalib_table %>% \n  modeltime_accuracy() %>% \n  table_modeltime_accuracy(.interactive = FALSE)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"swmgsjztja\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#swmgsjztja table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#swmgsjztja thead, #swmgsjztja tbody, #swmgsjztja tfoot, #swmgsjztja tr, #swmgsjztja td, #swmgsjztja th {\n  border-style: none;\n}\n\n#swmgsjztja p {\n  margin: 0;\n  padding: 0;\n}\n\n#swmgsjztja .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#swmgsjztja .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#swmgsjztja .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#swmgsjztja .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#swmgsjztja .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#swmgsjztja .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#swmgsjztja .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#swmgsjztja .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#swmgsjztja .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#swmgsjztja .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#swmgsjztja .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#swmgsjztja .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#swmgsjztja .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#swmgsjztja .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#swmgsjztja .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#swmgsjztja .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#swmgsjztja .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#swmgsjztja .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#swmgsjztja .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#swmgsjztja .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#swmgsjztja .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#swmgsjztja .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#swmgsjztja .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#swmgsjztja .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#swmgsjztja .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#swmgsjztja .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#swmgsjztja .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#swmgsjztja .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#swmgsjztja .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#swmgsjztja .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#swmgsjztja .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#swmgsjztja .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#swmgsjztja .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#swmgsjztja .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#swmgsjztja .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#swmgsjztja .gt_left {\n  text-align: left;\n}\n\n#swmgsjztja .gt_center {\n  text-align: center;\n}\n\n#swmgsjztja .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#swmgsjztja .gt_font_normal {\n  font-weight: normal;\n}\n\n#swmgsjztja .gt_font_bold {\n  font-weight: bold;\n}\n\n#swmgsjztja .gt_font_italic {\n  font-style: italic;\n}\n\n#swmgsjztja .gt_super {\n  font-size: 65%;\n}\n\n#swmgsjztja .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#swmgsjztja .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#swmgsjztja .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#swmgsjztja .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#swmgsjztja .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#swmgsjztja .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#swmgsjztja .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"9\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>Accuracy Table</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\".model_id\">.model_id</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\".model_desc\">.model_desc</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\".type\">.type</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mae\">mae</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mape\">mape</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mase\">mase</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"smape\">smape</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"rmse\">rmse</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"rsq\">rsq</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\".model_id\" class=\"gt_row gt_right\">1</td>\n<td headers=\".model_desc\" class=\"gt_row gt_left\">ARIMA(1,1,0)</td>\n<td headers=\".type\" class=\"gt_row gt_left\">Test</td>\n<td headers=\"mae\" class=\"gt_row gt_right\">21.82</td>\n<td headers=\"mape\" class=\"gt_row gt_right\">12.22</td>\n<td headers=\"mase\" class=\"gt_row gt_right\">5.16</td>\n<td headers=\"smape\" class=\"gt_row gt_right\">13.09</td>\n<td headers=\"rmse\" class=\"gt_row gt_right\">22.86</td>\n<td headers=\"rsq\" class=\"gt_row gt_right\">0.64</td></tr>\n    <tr><td headers=\".model_id\" class=\"gt_row gt_right\">2</td>\n<td headers=\".model_desc\" class=\"gt_row gt_left\">ARIMA(1,1,0)(1,1,0)[16]</td>\n<td headers=\".type\" class=\"gt_row gt_left\">Test</td>\n<td headers=\"mae\" class=\"gt_row gt_right\">13.06</td>\n<td headers=\"mape\" class=\"gt_row gt_right\">7.36</td>\n<td headers=\"mase\" class=\"gt_row gt_right\">3.09</td>\n<td headers=\"smape\" class=\"gt_row gt_right\">7.67</td>\n<td headers=\"rmse\" class=\"gt_row gt_right\">13.64</td>\n<td headers=\"rsq\" class=\"gt_row gt_right\">0.67</td></tr>\n    <tr><td headers=\".model_id\" class=\"gt_row gt_right\">3</td>\n<td headers=\".model_desc\" class=\"gt_row gt_left\">ARIMA(1,1,0)(1,1,0)[12]</td>\n<td headers=\".type\" class=\"gt_row gt_left\">Test</td>\n<td headers=\"mae\" class=\"gt_row gt_right\">23.67</td>\n<td headers=\"mape\" class=\"gt_row gt_right\">13.27</td>\n<td headers=\"mase\" class=\"gt_row gt_right\">5.60</td>\n<td headers=\"smape\" class=\"gt_row gt_right\">14.34</td>\n<td headers=\"rmse\" class=\"gt_row gt_right\">25.11</td>\n<td headers=\"rsq\" class=\"gt_row gt_right\">0.00</td></tr>\n    <tr><td headers=\".model_id\" class=\"gt_row gt_right\">4</td>\n<td headers=\".model_desc\" class=\"gt_row gt_left\">SEASONAL DECOMP: ARIMA(0,1,1)</td>\n<td headers=\".type\" class=\"gt_row gt_left\">Test</td>\n<td headers=\"mae\" class=\"gt_row gt_right\">14.29</td>\n<td headers=\"mape\" class=\"gt_row gt_right\">8.04</td>\n<td headers=\"mase\" class=\"gt_row gt_right\">3.38</td>\n<td headers=\"smape\" class=\"gt_row gt_right\">8.40</td>\n<td headers=\"rmse\" class=\"gt_row gt_right\">14.86</td>\n<td headers=\"rsq\" class=\"gt_row gt_right\">0.66</td></tr>\n    <tr><td headers=\".model_id\" class=\"gt_row gt_right\">5</td>\n<td headers=\".model_desc\" class=\"gt_row gt_left\">ARIMA(1,1,0)(1,1,0)[16] W/ XGBOOST ERRORS</td>\n<td headers=\".type\" class=\"gt_row gt_left\">Test</td>\n<td headers=\"mae\" class=\"gt_row gt_right\">12.53</td>\n<td headers=\"mape\" class=\"gt_row gt_right\">7.07</td>\n<td headers=\"mase\" class=\"gt_row gt_right\">2.97</td>\n<td headers=\"smape\" class=\"gt_row gt_right\">7.35</td>\n<td headers=\"rmse\" class=\"gt_row gt_right\">13.13</td>\n<td headers=\"rsq\" class=\"gt_row gt_right\">0.67</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n# Visualização do conjunto de testes\n\nVamos agora avaliar o desempenho dos modelos em relação aos dados de teste. É importante lembrar que os modelos não foram treinados com o conjunto de dados completo, que abrange aproximadamente 10 anos, mas sim com um intervalo de 7 anos, conforme explicado durante o planejamento da validação cruzada.\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-15_073d2e0f67f684536bde65b80650fd36'}\n\n```{.r .cell-code}\ncalib_table %>% \n  modeltime_forecast(\n    new_data = testing(cv$splits[[1]]),\n    actual_data = gold_mean\n  ) %>% \n  plot_modeltime_forecast(.interactive = FALSE)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-1.png){width=1440}\n:::\n:::\n\n\n# Validação Cruzada - K-fold\n\nAté o momento utilizamos apenas o primeiro folder criado para realização da validação cruzada. Vamos agora varificar o desempenho médio em todos folders criados. A principal vantagem dessa abordagem é fornecer uma avaliação robusta e imparcial do desempenho de um modelo, mitigando problemas como overfitting (ajuste excessivo) e subajuste (underfitting).\n\nPara realizar essa etapa é necessário a utilização do pacote `modeltime.resample`, uma extenção do pacote `modeltime`.\n\n## Ajustando os modelos aos diferentes conjuntos de dados (folds).\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-16_257d643eae6a10a79967dcabb27ef690'}\n\n```{.r .cell-code}\nresamples_fitted <- model_table %>%\n    modeltime_fit_resamples(\n        resamples = cv,\n        control   = control_resamples(verbose = FALSE)\n    )\n\nresamples_fitted\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# Modeltime Table\n# A tibble: 5 × 4\n  .model_id .model   .model_desc                               .resample_results\n      <int> <list>   <chr>                                     <list>           \n1         1 <fit[+]> ARIMA(1,1,0)                              <rsmp[+]>        \n2         2 <fit[+]> ARIMA(1,1,0)(1,1,0)[16]                   <rsmp[+]>        \n3         3 <fit[+]> ARIMA(1,1,0)(1,1,0)[12]                   <rsmp[+]>        \n4         4 <fit[+]> SEASONAL DECOMP: ARIMA(0,1,1)             <rsmp[+]>        \n5         5 <fit[+]> ARIMA(1,1,0)(1,1,0)[16] W/ XGBOOST ERRORS <lgl [1]>        \n```\n:::\n:::\n\n\n# Visualizando o desempenho dos modelos nos diferentes conjuntos de dados (folds)\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-17_94e6fe3a8deb54257b760d365c5e39a1'}\n\n```{.r .cell-code}\nresamples_fitted %>%\n    plot_modeltime_resamples(\n      .point_size  = 3, \n      .point_alpha = 0.8,\n      .interactive = FALSE\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-17-1.png){width=1440}\n:::\n:::\n\n\n# Tabela com o desempenho médios dos modelos\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-18_d11360c61c6716f19fe9608660f97cac'}\n\n```{.r .cell-code}\nresamples_fitted %>%\n    modeltime_resample_accuracy(summary_fns = mean) %>%\n    table_modeltime_accuracy(.interactive = FALSE)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"agzlvvbraw\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#agzlvvbraw table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#agzlvvbraw thead, #agzlvvbraw tbody, #agzlvvbraw tfoot, #agzlvvbraw tr, #agzlvvbraw td, #agzlvvbraw th {\n  border-style: none;\n}\n\n#agzlvvbraw p {\n  margin: 0;\n  padding: 0;\n}\n\n#agzlvvbraw .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#agzlvvbraw .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#agzlvvbraw .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#agzlvvbraw .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#agzlvvbraw .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#agzlvvbraw .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#agzlvvbraw .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#agzlvvbraw .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#agzlvvbraw .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#agzlvvbraw .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#agzlvvbraw .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#agzlvvbraw .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#agzlvvbraw .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#agzlvvbraw .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#agzlvvbraw .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#agzlvvbraw .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#agzlvvbraw .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#agzlvvbraw .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#agzlvvbraw .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#agzlvvbraw .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#agzlvvbraw .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#agzlvvbraw .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#agzlvvbraw .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#agzlvvbraw .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#agzlvvbraw .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#agzlvvbraw .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#agzlvvbraw .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#agzlvvbraw .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#agzlvvbraw .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#agzlvvbraw .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#agzlvvbraw .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#agzlvvbraw .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#agzlvvbraw .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#agzlvvbraw .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#agzlvvbraw .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#agzlvvbraw .gt_left {\n  text-align: left;\n}\n\n#agzlvvbraw .gt_center {\n  text-align: center;\n}\n\n#agzlvvbraw .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#agzlvvbraw .gt_font_normal {\n  font-weight: normal;\n}\n\n#agzlvvbraw .gt_font_bold {\n  font-weight: bold;\n}\n\n#agzlvvbraw .gt_font_italic {\n  font-style: italic;\n}\n\n#agzlvvbraw .gt_super {\n  font-size: 65%;\n}\n\n#agzlvvbraw .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#agzlvvbraw .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#agzlvvbraw .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#agzlvvbraw .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#agzlvvbraw .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#agzlvvbraw .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#agzlvvbraw .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"10\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>Accuracy Table</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\".model_id\">.model_id</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\".model_desc\">.model_desc</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\".type\">.type</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"n\">n</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mae\">mae</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mape\">mape</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mase\">mase</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"smape\">smape</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"rmse\">rmse</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"rsq\">rsq</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\".model_id\" class=\"gt_row gt_right\">1</td>\n<td headers=\".model_desc\" class=\"gt_row gt_left\">ARIMA(1,1,0)</td>\n<td headers=\".type\" class=\"gt_row gt_left\">Resamples</td>\n<td headers=\"n\" class=\"gt_row gt_right\">6</td>\n<td headers=\"mae\" class=\"gt_row gt_right\">13.18</td>\n<td headers=\"mape\" class=\"gt_row gt_right\">7.71</td>\n<td headers=\"mase\" class=\"gt_row gt_right\">3.40</td>\n<td headers=\"smape\" class=\"gt_row gt_right\">7.60</td>\n<td headers=\"rmse\" class=\"gt_row gt_right\">15.01</td>\n<td headers=\"rsq\" class=\"gt_row gt_right\">NA</td></tr>\n    <tr><td headers=\".model_id\" class=\"gt_row gt_right\">2</td>\n<td headers=\".model_desc\" class=\"gt_row gt_left\">ARIMA(1,1,0)(1,1,0)[16]</td>\n<td headers=\".type\" class=\"gt_row gt_left\">Resamples</td>\n<td headers=\"n\" class=\"gt_row gt_right\">6</td>\n<td headers=\"mae\" class=\"gt_row gt_right\">11.70</td>\n<td headers=\"mape\" class=\"gt_row gt_right\">6.89</td>\n<td headers=\"mase\" class=\"gt_row gt_right\">3.07</td>\n<td headers=\"smape\" class=\"gt_row gt_right\">6.72</td>\n<td headers=\"rmse\" class=\"gt_row gt_right\">13.57</td>\n<td headers=\"rsq\" class=\"gt_row gt_right\">0.22</td></tr>\n    <tr><td headers=\".model_id\" class=\"gt_row gt_right\">3</td>\n<td headers=\".model_desc\" class=\"gt_row gt_left\">ARIMA(1,1,0)(1,1,0)[12]</td>\n<td headers=\".type\" class=\"gt_row gt_left\">Resamples</td>\n<td headers=\"n\" class=\"gt_row gt_right\">6</td>\n<td headers=\"mae\" class=\"gt_row gt_right\">16.55</td>\n<td headers=\"mape\" class=\"gt_row gt_right\">9.72</td>\n<td headers=\"mase\" class=\"gt_row gt_right\">4.22</td>\n<td headers=\"smape\" class=\"gt_row gt_right\">9.53</td>\n<td headers=\"rmse\" class=\"gt_row gt_right\">18.81</td>\n<td headers=\"rsq\" class=\"gt_row gt_right\">0.16</td></tr>\n    <tr><td headers=\".model_id\" class=\"gt_row gt_right\">4</td>\n<td headers=\".model_desc\" class=\"gt_row gt_left\">SEASONAL DECOMP: ARIMA(0,1,1)</td>\n<td headers=\".type\" class=\"gt_row gt_left\">Resamples</td>\n<td headers=\"n\" class=\"gt_row gt_right\">6</td>\n<td headers=\"mae\" class=\"gt_row gt_right\">11.86</td>\n<td headers=\"mape\" class=\"gt_row gt_right\">6.96</td>\n<td headers=\"mase\" class=\"gt_row gt_right\">3.17</td>\n<td headers=\"smape\" class=\"gt_row gt_right\">6.80</td>\n<td headers=\"rmse\" class=\"gt_row gt_right\">13.66</td>\n<td headers=\"rsq\" class=\"gt_row gt_right\">0.32</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n# Criando as previsões\n\nPor último vamos criar previsões futuras dos diferentes modelo que foram ajustados. Para isso vamos reajustar os modelos, desta vez no conjunto de dados completo.\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-19_17495263b7bb9d4fbbfa4886ea1bc840'}\n\n```{.r .cell-code}\nfuture_forecast_tbl <- \n  calib_table %>% \n  modeltime_refit(gold_mean) %>% \n  modeltime_forecast(\n    h  = \"1 year\",\n    actual_data = gold_mean\n  )\n```\n:::\n\n::: {.cell hash='index_cache/html/unnamed-chunk-20_e144ae1e0da8a8592ac2c48424326e1d'}\n\n```{.r .cell-code}\nfuture_forecast_tbl %>% \n  plot_modeltime_forecast(.interactive = FALSE)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-20-1.png){width=1440}\n:::\n:::\n\n\n# Conclusão\n\n# Referências\n\n-   [Forecasting: Principles and Practice (3rd ed)/Chapter 9 ARIMA models](https://otexts.com/fpp3/arima.html)\n\n-   [Getting Started with Modeltime](https://business-science.github.io/modeltime/articles/getting-started-with-modeltime.html)\n\n-   [General Interface for ARIMA Regression Models](https://business-science.github.io/modeltime/reference/arima_reg.html)\n\n-   [Getting Started with Modeltime Resample](https://business-science.github.io/modeltime.resample/articles/getting-started.html)\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}