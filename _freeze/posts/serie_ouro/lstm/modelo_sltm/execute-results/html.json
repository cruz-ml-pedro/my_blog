{
  "hash": "67c578e1cfdad84a7cb6add4da732cb3",
  "result": {
    "markdown": "---\ntitle: \"Cotação do ouro - Parte 5 \"\nsubtitle: \"Modelo LSTM\"\nauthor: \"Pedro Lima\"\ndate: \"2023-08-05\"\ncategories: [Modelagem, Série-Temporal,R]\ntoc: true\ntoc-depth: 3\ndraft: false\n---\n\n::: {.cell}\n\n:::\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-2_8c596a97d78f7494101597ed1933a487'}\n\n:::\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-3_ecd89674a0f18e9d06f2fc2cc8972e1b'}\n\n:::\n\n\nDesenvolvendo uma estratégia de Backtesting\n\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-4_38a3066c20423588ea835e814230c0b5'}\n\n```{.r .cell-code}\n# Realizar o backtesting com a função rolling_origin()\nperiods_train <- 12 * 4\nperiods_test  <- 12 * 1\nskip_span     <- 12 * 2\n\n\nrolling_origin_resamples <- rsample::rolling_origin(\n    gold_mean,\n    initial    = periods_train,\n    assess     = periods_test,\n    cumulative = FALSE,\n    skip       = skip_span\n)\nrolling_origin_resamples\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# Rolling origin forecast resampling \n# A tibble: 3 × 2\n  splits          id    \n  <list>          <chr> \n1 <split [48/12]> Slice1\n2 <split [48/12]> Slice2\n3 <split [48/12]> Slice3\n```\n:::\n:::\n\n\nCriando uma função para visualizar os blocos de Backtest\n\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-5_b126a59a8331fcfeeeac2e5326981cdd'}\n\n```{.r .cell-code}\n# Plotting function for a single split\nplot_split <- function(split, expand_y_axis = TRUE, alpha = 1, size = 1, base_size = 14) {\n    \n    # Manipulate data\n    train_tbl <- training(split) %>%\n        add_column(key = \"training\") \n    \n    test_tbl  <- testing(split) %>%\n        add_column(key = \"testing\") \n    \n    data_manipulated <- bind_rows(train_tbl, test_tbl) %>%\n        as_tbl_time(index = index) %>%\n        mutate(key = fct_relevel(key, \"training\", \"testing\"))\n        \n    # Collect attributes\n    train_time_summary <- train_tbl %>%\n        tk_index() %>%\n        tk_get_timeseries_summary()\n    \n    test_time_summary <- test_tbl %>%\n        tk_index() %>%\n        tk_get_timeseries_summary()\n    \n    # Visualize\n    g <- data_manipulated %>%\n        ggplot(aes(x = index, y = value, color = key)) +\n        geom_line(linewidth = size, alpha = alpha) +\n        theme_tq(base_size = base_size) +\n        scale_color_tq() +\n        labs(\n            title    = glue(\"Split: {split$id}\"),\n            subtitle = glue(\"{train_time_summary$start} to {test_time_summary$end}\"),\n            y = \"\", x = \"\"\n        ) +\n        theme(legend.position = \"none\") \n    \n    if (expand_y_axis) {\n        \n        gold_ts_time_summary <- gold_mean %>% \n            tk_index() %>% \n            tk_get_timeseries_summary()\n        \n        g <- g +\n            scale_x_date(limits = c(gold_ts_time_summary$start, \n                                    gold_ts_time_summary$end))\n    }\n    \n    return(g)\n}\n```\n:::\n\n\nVerificando um dos blocos de Backtest\n\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-6_6b27477a573abf432faf3fddd57e0c26'}\n\n```{.r .cell-code}\nrolling_origin_resamples$splits[[1]] %>%\n    plot_split(expand_y_axis = TRUE) +\n    theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](modelo_sltm_files/figure-html/unnamed-chunk-6-1.png){width=1440}\n:::\n:::\n\n\nFunção para colocar os gráficos na escala de tempo do recorte dos dados\n\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-7_5ac77e8aa9842edd4ae90be256df9f78'}\n\n```{.r .cell-code}\n# Plotting function that scales to all splits \nplot_sampling_plan <- function(sampling_tbl, expand_y_axis = TRUE, \n                               ncol = 3, alpha = 1, size = 1, base_size = 14, \n                               title = \"Sampling Plan\") {\n    \n    # Map plot_split() to sampling_tbl\n    sampling_tbl_with_plots <- sampling_tbl %>%\n        mutate(gg_plots = map(splits, plot_split, \n                              expand_y_axis = expand_y_axis,\n                              alpha = alpha, base_size = base_size))\n    \n    # Make plots with cowplot\n    plot_list <- sampling_tbl_with_plots$gg_plots \n    \n    p_temp <- plot_list[[1]] + theme(legend.position = \"bottom\")\n    legend <- get_legend(p_temp)\n    \n    p_body  <- plot_grid(plotlist = plot_list, ncol = ncol)\n    \n    p_title <- ggdraw() + \n        draw_label(title, size = 18, fontface = \"bold\", colour = palette_light()[[1]])\n    \n    g <- plot_grid(p_title, p_body, legend, ncol = 1, rel_heights = c(0.05, 1, 0.05))\n    \n    return(g)\n    \n}\n```\n:::\n\n\nPlotando todos os blocos de teste\n\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-8_504b62fe625c162c4d796efb6cd61077'}\n\n```{.r .cell-code}\nrolling_origin_resamples %>%\n    plot_sampling_plan(expand_y_axis = T, ncol = 3, alpha = 1, size = 1, base_size = 10, \n                       title = \"Backtesting Strategy: Rolling Origin Sampling Plan\")\n```\n\n::: {.cell-output-display}\n![](modelo_sltm_files/figure-html/unnamed-chunk-8-1.png){width=1440}\n:::\n:::\n\n\nPlotando os gráficos em uma escala mais apropriada \"zoom\"\n\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-9_5f0f3dae12c6720f86a5f144a0b6d50b'}\n\n```{.r .cell-code}\nrolling_origin_resamples %>%\n    plot_sampling_plan(expand_y_axis = F, ncol = 3, alpha = 1, size = 1, base_size = 10, \n                       title = \"Backtesting Strategy: Zoomed In\")\n```\n\n::: {.cell-output-display}\n![](modelo_sltm_files/figure-html/unnamed-chunk-9-1.png){width=1440}\n:::\n:::\n\n\n## Modelagem The Keras Stateful LSTM Model\n\n## Single LSTM\n\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-10_f9865962af1177df22fe249c52986cdb'}\n\n```{.r .cell-code}\nsplit    <- rolling_origin_resamples$splits[[1]]\nsplit_id <- rolling_origin_resamples$id[[1]]\n```\n:::\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-11_a1502baf408ca0e865200f733b14d0a9'}\n\n```{.r .cell-code}\nplot_split(split, expand_y_axis = FALSE, size = 0.5) +\n    theme(legend.position = \"bottom\") +\n    ggtitle(glue(\"Split: {split_id}\"))\n```\n\n::: {.cell-output-display}\n![](modelo_sltm_files/figure-html/unnamed-chunk-11-1.png){width=1440}\n:::\n:::\n\n\nCriando um index para treino e teste e combinando em um df\n\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-12_f784c72782b3c51dc42b24210720a8fc'}\n\n```{.r .cell-code}\ndf_trn <- training(split)\ndf_tst <- testing(split)\n\ndf <- bind_rows(\n    df_trn %>% add_column(key = \"training\"),\n    df_tst %>% add_column(key = \"testing\")\n) %>% \n    as_tbl_time(index = index)\n\ndf\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A time tibble: 60 × 3\n# Index:         index\n   index      value key     \n   <date>     <dbl> <chr>   \n 1 2013-01-01  162. training\n 2 2013-02-01  158. training\n 3 2013-03-01  154. training\n 4 2013-04-01  144. training\n 5 2013-05-01  137. training\n 6 2013-06-01  130. training\n 7 2013-07-01  124. training\n 8 2013-08-01  131. training\n 9 2013-09-01  130. training\n10 2013-10-01  127. training\n# ℹ 50 more rows\n```\n:::\n:::\n\n\n## Preprocessing With Recipes\n\nThe LSTM algorithm requires the input data to be centered and scaled. We can preprocess the data using the recipes package.\n\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-13_0794e72dae38bbe02d429e3bd410acce'}\n\n```{.r .cell-code}\nrec_obj <- recipe(value ~ ., df) %>%\n    step_sqrt(value) %>%\n    step_center(value) %>%\n    step_scale(value) %>%\n   # step_BoxCox(value) %>% \n    prep()\n\ndf_processed_tbl <- bake(rec_obj, df)\n\ndf_processed_tbl\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 60 × 3\n   index      key      value\n   <date>     <fct>    <dbl>\n 1 2013-01-01 training 3.40 \n 2 2013-02-01 training 3.08 \n 3 2013-03-01 training 2.80 \n 4 2013-04-01 training 1.93 \n 5 2013-05-01 training 1.37 \n 6 2013-06-01 training 0.733\n 7 2013-07-01 training 0.277\n 8 2013-08-01 training 0.823\n 9 2013-09-01 training 0.783\n10 2013-10-01 training 0.500\n# ℹ 50 more rows\n```\n:::\n:::\n\n\nA seguir, vamos capturar o histórico do centro/escala para que possamos inverter o centro e a escala após a modelagem. A transformação da raiz quadrada pode ser revertida ao elevar ao quadrado os valores invertidos do centro/escala.\n\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-14_dfeef46c246eeb55f7195596a3bbe4b2'}\n\n```{.r .cell-code}\n   center_history <- rec_obj$steps[[2]]$means[\"value\"]\n   scale_history  <- rec_obj$steps[[3]]$sds[\"value\"]\n\nc(\"center\" = center_history, \"scale\" = scale_history)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ncenter.value  scale.value \n  11.0197810    0.4985484 \n```\n:::\n:::\n\n\n## LSTM Plan\n\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-15_e8412d7abaad66268bf4dad27a3a86c7'}\n\n```{.r .cell-code}\n# Model inputs\nlag_setting  <- 12 # = nrow(df_tst)\nbatch_size   <- 1\ntrain_length <- 12*6\ntsteps       <- 1\nepochs       <- 50\n```\n:::\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-16_dcff4586d04be2f1d0b6812bd4e0da65'}\n\n```{.r .cell-code}\n# Training Set\nlag_train_tbl <- df_processed_tbl %>%\n    mutate(value_lag = lag(value, n = lag_setting)) %>%\n    filter(!is.na(value_lag)) %>%\n    filter(key == \"training\") %>%\n    tail(train_length)\n\nx_train_vec <- lag_train_tbl$value_lag\nx_train_arr <- array(data = x_train_vec, dim = c(length(x_train_vec), 1, 1))\n\ny_train_vec <- lag_train_tbl$value\ny_train_arr <- array(data = y_train_vec, dim = c(length(y_train_vec), 1))\n\n# Testing Set\nlag_test_tbl <- df_processed_tbl %>%\n    mutate(\n        value_lag = lag(value, n = lag_setting)\n    ) %>%\n    filter(!is.na(value_lag)) %>%\n    filter(key == \"testing\")\n\nx_test_vec <- lag_test_tbl$value_lag\nx_test_arr <- array(data = x_test_vec, dim = c(length(x_test_vec), 1, 1))\n\ny_test_vec <- lag_test_tbl$value\ny_test_arr <- array(data = y_test_vec, dim = c(length(y_test_vec), 1))\n```\n:::\n\n\n### Construindo o modelo LSTM\n\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-17_142894e40a77bd53a8efb3e2e4bba527'}\n\n```{.r .cell-code}\nmodel <- keras_model_sequential()\n\nmodel %>%\n    layer_lstm(units            = 50, \n               input_shape      = c(tsteps, 1), \n               batch_size       = batch_size,\n               return_sequences = TRUE, \n               stateful         = TRUE) %>% \n     layer_lstm(units            = 50, \n                return_sequences = FALSE, \n                stateful         = TRUE) %>% \n    layer_dense(units = 1)\n\nmodel %>% \n    compile(\n      loss = 'mae',\n      optimizer = 'adam',\n      ) \n  \n\nmodel\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nModel: \"sequential\"\n________________________________________________________________________________\n Layer (type)                       Output Shape                    Param #     \n================================================================================\n lstm_1 (LSTM)                      (1, 1, 50)                      10400       \n lstm (LSTM)                        (1, 50)                         20200       \n dense (Dense)                      (1, 1)                          51          \n================================================================================\nTotal params: 30,651\nTrainable params: 30,651\nNon-trainable params: 0\n________________________________________________________________________________\n```\n:::\n:::\n\n\n### Fitting The LSTM Model\n\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-18_ee558b06a58a2788768970deebeb3b6b'}\n\n```{.r .cell-code}\nfor (i in 1:epochs) {\n    model %>% fit(x          = x_train_arr, \n                  y          = y_train_arr, \n                  batch_size = batch_size,\n                  epochs     = 1, \n                  verbose    = 1, \n                  shuffle    = FALSE)\n    \n    model %>% reset_states()\n    cat(\"Epoch: \", i)\n    \n}\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n 1/36 [..............................] - ETA: 3:00 - loss: 0.1243\n13/36 [=========>....................] - ETA: 0s - loss: 0.4318  \n19/36 [==============>...............] - ETA: 0s - loss: 0.5704\n32/36 [=========================>....] - ETA: 0s - loss: 0.6901\n36/36 [==============================] - 5s 5ms/step - loss: 0.6645\nEpoch:  1\n 1/36 [..............................] - ETA: 0s - loss: 0.1467\n11/36 [========>.....................] - ETA: 0s - loss: 0.3043\n24/36 [===================>..........] - ETA: 0s - loss: 0.5850\n35/36 [============================>.] - ETA: 0s - loss: 0.5647\n36/36 [==============================] - 0s 5ms/step - loss: 0.5695\nEpoch:  2\n 1/36 [..............................] - ETA: 0s - loss: 0.1486\n15/36 [===========>..................] - ETA: 0s - loss: 0.2500\n31/36 [========================>.....] - ETA: 0s - loss: 0.4841\n36/36 [==============================] - 0s 3ms/step - loss: 0.4988\nEpoch:  3\n 1/36 [..............................] - ETA: 0s - loss: 0.1409\n17/36 [=============>................] - ETA: 0s - loss: 0.2064\n33/36 [==========================>...] - ETA: 0s - loss: 0.4307\n36/36 [==============================] - 0s 3ms/step - loss: 0.4298\nEpoch:  4\n 1/36 [..............................] - ETA: 0s - loss: 0.1175\n15/36 [===========>..................] - ETA: 0s - loss: 0.2427\n30/36 [========================>.....] - ETA: 0s - loss: 0.4171\n36/36 [==============================] - 0s 4ms/step - loss: 0.4952\nEpoch:  5\n 1/36 [..............................] - ETA: 0s - loss: 0.1757\n16/36 [============>.................] - ETA: 0s - loss: 0.5734\n31/36 [========================>.....] - ETA: 0s - loss: 0.5841\n36/36 [==============================] - 0s 4ms/step - loss: 0.5819\nEpoch:  6\n 1/36 [..............................] - ETA: 0s - loss: 0.0461\n17/36 [=============>................] - ETA: 0s - loss: 0.4321\n26/36 [====================>.........] - ETA: 0s - loss: 0.6246\n36/36 [==============================] - 0s 4ms/step - loss: 0.5631\nEpoch:  7\n 1/36 [..............................] - ETA: 0s - loss: 0.0969\n17/36 [=============>................] - ETA: 0s - loss: 0.2807\n28/36 [======================>.......] - ETA: 0s - loss: 0.4755\n36/36 [==============================] - 0s 4ms/step - loss: 0.5151\nEpoch:  8\n 1/36 [..............................] - ETA: 0s - loss: 0.1292\n15/36 [===========>..................] - ETA: 0s - loss: 0.2458\n25/36 [===================>..........] - ETA: 0s - loss: 0.4488\n36/36 [==============================] - 0s 4ms/step - loss: 0.4624\nEpoch:  9\n 1/36 [..............................] - ETA: 0s - loss: 0.0639\n16/36 [============>.................] - ETA: 0s - loss: 0.2729\n28/36 [======================>.......] - ETA: 0s - loss: 0.4001\n36/36 [==============================] - 0s 4ms/step - loss: 0.4741\nEpoch:  10\n 1/36 [..............................] - ETA: 0s - loss: 0.1547\n13/36 [=========>....................] - ETA: 0s - loss: 0.4588\n30/36 [========================>.....] - ETA: 0s - loss: 0.5089\n36/36 [==============================] - 0s 4ms/step - loss: 0.5267\nEpoch:  11\n 1/36 [..............................] - ETA: 0s - loss: 0.0314\n11/36 [========>.....................] - ETA: 0s - loss: 0.4457\n22/36 [=================>............] - ETA: 0s - loss: 0.4224\n32/36 [=========================>....] - ETA: 0s - loss: 0.5152\n36/36 [==============================] - 0s 6ms/step - loss: 0.5176\nEpoch:  12\n 1/36 [..............................] - ETA: 0s - loss: 0.0910\n12/36 [=========>....................] - ETA: 0s - loss: 0.1971\n25/36 [===================>..........] - ETA: 0s - loss: 0.3761\n36/36 [==============================] - 0s 4ms/step - loss: 0.4396\nEpoch:  13\n 1/36 [..............................] - ETA: 0s - loss: 0.0319\n15/36 [===========>..................] - ETA: 0s - loss: 0.3109\n31/36 [========================>.....] - ETA: 0s - loss: 0.4136\n36/36 [==============================] - 0s 4ms/step - loss: 0.4416\nEpoch:  14\n 1/36 [..............................] - ETA: 0s - loss: 0.1291\n16/36 [============>.................] - ETA: 0s - loss: 0.3056\n30/36 [========================>.....] - ETA: 0s - loss: 0.4298\n36/36 [==============================] - 0s 4ms/step - loss: 0.4613\nEpoch:  15\n 1/36 [..............................] - ETA: 0s - loss: 0.0386\n14/36 [==========>...................] - ETA: 0s - loss: 0.3788\n27/36 [=====================>........] - ETA: 0s - loss: 0.4192\n36/36 [==============================] - 0s 4ms/step - loss: 0.5487\nEpoch:  16\n 1/36 [..............................] - ETA: 0s - loss: 0.1373\n18/36 [==============>...............] - ETA: 0s - loss: 0.2367\n26/36 [====================>.........] - ETA: 0s - loss: 0.4756\n35/36 [============================>.] - ETA: 0s - loss: 0.4319\n36/36 [==============================] - 0s 5ms/step - loss: 0.4471\nEpoch:  17\n 1/36 [..............................] - ETA: 0s - loss: 0.1056\n14/36 [==========>...................] - ETA: 0s - loss: 0.2104\n28/36 [======================>.......] - ETA: 0s - loss: 0.3645\n35/36 [============================>.] - ETA: 0s - loss: 0.3699\n36/36 [==============================] - 0s 5ms/step - loss: 0.3901\nEpoch:  18\n 1/36 [..............................] - ETA: 0s - loss: 0.0995\n16/36 [============>.................] - ETA: 0s - loss: 0.2136\n28/36 [======================>.......] - ETA: 0s - loss: 0.3064\n36/36 [==============================] - 0s 4ms/step - loss: 0.3577\nEpoch:  19\n 1/36 [..............................] - ETA: 0s - loss: 0.0615\n16/36 [============>.................] - ETA: 0s - loss: 0.2026\n23/36 [==================>...........] - ETA: 0s - loss: 0.2314\n36/36 [==============================] - 0s 4ms/step - loss: 0.3305\nEpoch:  20\n 1/36 [..............................] - ETA: 0s - loss: 0.0694\n 9/36 [======>.......................] - ETA: 0s - loss: 0.1583\n21/36 [================>.............] - ETA: 0s - loss: 0.2660\n36/36 [==============================] - 0s 4ms/step - loss: 0.3743\nEpoch:  21\n 1/36 [..............................] - ETA: 0s - loss: 0.0566\n18/36 [==============>...............] - ETA: 0s - loss: 0.2504\n34/36 [===========================>..] - ETA: 0s - loss: 0.3632\n36/36 [==============================] - 0s 3ms/step - loss: 0.4082\nEpoch:  22\n 1/36 [..............................] - ETA: 0s - loss: 0.1442\n17/36 [=============>................] - ETA: 0s - loss: 0.1770\n34/36 [===========================>..] - ETA: 0s - loss: 0.4192\n36/36 [==============================] - 0s 3ms/step - loss: 0.4180\nEpoch:  23\n 1/36 [..............................] - ETA: 0s - loss: 0.1505\n18/36 [==============>...............] - ETA: 0s - loss: 0.2297\n34/36 [===========================>..] - ETA: 0s - loss: 0.3695\n36/36 [==============================] - 0s 3ms/step - loss: 0.3876\nEpoch:  24\n 1/36 [..............................] - ETA: 0s - loss: 0.0478\n15/36 [===========>..................] - ETA: 0s - loss: 0.2641\n27/36 [=====================>........] - ETA: 0s - loss: 0.3524\n36/36 [==============================] - 0s 4ms/step - loss: 0.3763\nEpoch:  25\n 1/36 [..............................] - ETA: 0s - loss: 0.0894\n16/36 [============>.................] - ETA: 0s - loss: 0.2783\n33/36 [==========================>...] - ETA: 0s - loss: 0.3993\n36/36 [==============================] - 0s 3ms/step - loss: 0.4062\nEpoch:  26\n 1/36 [..............................] - ETA: 0s - loss: 0.0367\n15/36 [===========>..................] - ETA: 0s - loss: 0.1881\n32/36 [=========================>....] - ETA: 0s - loss: 0.3248\n36/36 [==============================] - 0s 4ms/step - loss: 0.3462\nEpoch:  27\n 1/36 [..............................] - ETA: 0s - loss: 0.0145\n18/36 [==============>...............] - ETA: 0s - loss: 0.1862\n34/36 [===========================>..] - ETA: 0s - loss: 0.3052\n36/36 [==============================] - 0s 3ms/step - loss: 0.3250\nEpoch:  28\n 1/36 [..............................] - ETA: 0s - loss: 0.0817\n18/36 [==============>...............] - ETA: 0s - loss: 0.2294\n33/36 [==========================>...] - ETA: 0s - loss: 0.3295\n36/36 [==============================] - 0s 3ms/step - loss: 0.3434\nEpoch:  29\n 1/36 [..............................] - ETA: 0s - loss: 0.0826\n18/36 [==============>...............] - ETA: 0s - loss: 0.3017\n33/36 [==========================>...] - ETA: 0s - loss: 0.3068\n36/36 [==============================] - 0s 3ms/step - loss: 0.3187\nEpoch:  30\n 1/36 [..............................] - ETA: 0s - loss: 0.0711\n15/36 [===========>..................] - ETA: 0s - loss: 0.1930\n30/36 [========================>.....] - ETA: 0s - loss: 0.4104\n36/36 [==============================] - 0s 4ms/step - loss: 0.4402\nEpoch:  31\n 1/36 [..............................] - ETA: 0s - loss: 0.0767\n14/36 [==========>...................] - ETA: 0s - loss: 0.1753\n28/36 [======================>.......] - ETA: 0s - loss: 0.3256\n36/36 [==============================] - 0s 4ms/step - loss: 0.3594\nEpoch:  32\n 1/36 [..............................] - ETA: 0s - loss: 0.0837\n18/36 [==============>...............] - ETA: 0s - loss: 0.1827\n35/36 [============================>.] - ETA: 0s - loss: 0.2828\n36/36 [==============================] - 0s 3ms/step - loss: 0.3033\nEpoch:  33\n 1/36 [..............................] - ETA: 0s - loss: 0.0510\n18/36 [==============>...............] - ETA: 0s - loss: 0.2474\n35/36 [============================>.] - ETA: 0s - loss: 0.3199\n36/36 [==============================] - 0s 3ms/step - loss: 0.3424\nEpoch:  34\n 1/36 [..............................] - ETA: 0s - loss: 0.0468\n17/36 [=============>................] - ETA: 0s - loss: 0.1937\n32/36 [=========================>....] - ETA: 0s - loss: 0.4436\n36/36 [==============================] - 0s 3ms/step - loss: 0.4448\nEpoch:  35\n 1/36 [..............................] - ETA: 0s - loss: 0.0494\n18/36 [==============>...............] - ETA: 0s - loss: 0.1585\n34/36 [===========================>..] - ETA: 0s - loss: 0.3010\n36/36 [==============================] - 0s 3ms/step - loss: 0.3154\nEpoch:  36\n 1/36 [..............................] - ETA: 0s - loss: 0.0161\n18/36 [==============>...............] - ETA: 0s - loss: 0.2359\n34/36 [===========================>..] - ETA: 0s - loss: 0.3025\n36/36 [==============================] - 0s 3ms/step - loss: 0.3217\nEpoch:  37\n 1/36 [..............................] - ETA: 0s - loss: 0.0493\n18/36 [==============>...............] - ETA: 0s - loss: 0.1486\n34/36 [===========================>..] - ETA: 0s - loss: 0.3525\n36/36 [==============================] - 0s 3ms/step - loss: 0.3656\nEpoch:  38\n 1/36 [..............................] - ETA: 0s - loss: 0.0474\n17/36 [=============>................] - ETA: 0s - loss: 0.2141\n34/36 [===========================>..] - ETA: 0s - loss: 0.3205\n36/36 [==============================] - 0s 3ms/step - loss: 0.3370\nEpoch:  39\n 1/36 [..............................] - ETA: 0s - loss: 0.0948\n17/36 [=============>................] - ETA: 0s - loss: 0.2909\n34/36 [===========================>..] - ETA: 0s - loss: 0.3675\n36/36 [==============================] - 0s 3ms/step - loss: 0.3881\nEpoch:  40\n 1/36 [..............................] - ETA: 0s - loss: 0.0078\n18/36 [==============>...............] - ETA: 0s - loss: 0.1668\n34/36 [===========================>..] - ETA: 0s - loss: 0.3506\n36/36 [==============================] - 0s 3ms/step - loss: 0.3645\nEpoch:  41\n 1/36 [..............................] - ETA: 0s - loss: 0.0494\n17/36 [=============>................] - ETA: 0s - loss: 0.2053\n34/36 [===========================>..] - ETA: 0s - loss: 0.2934\n36/36 [==============================] - 0s 3ms/step - loss: 0.3140\nEpoch:  42\n 1/36 [..............................] - ETA: 0s - loss: 0.0443\n18/36 [==============>...............] - ETA: 0s - loss: 0.2114\n35/36 [============================>.] - ETA: 0s - loss: 0.2626\n36/36 [==============================] - 0s 3ms/step - loss: 0.2887\nEpoch:  43\n 1/36 [..............................] - ETA: 0s - loss: 0.0025\n18/36 [==============>...............] - ETA: 0s - loss: 0.1334\n35/36 [============================>.] - ETA: 0s - loss: 0.3064\n36/36 [==============================] - 0s 3ms/step - loss: 0.3291\nEpoch:  44\n 1/36 [..............................] - ETA: 0s - loss: 0.0159\n18/36 [==============>...............] - ETA: 0s - loss: 0.1999\n35/36 [============================>.] - ETA: 0s - loss: 0.2743\n36/36 [==============================] - 0s 3ms/step - loss: 0.2980\nEpoch:  45\n 1/36 [..............................] - ETA: 0s - loss: 0.0955\n16/36 [============>.................] - ETA: 0s - loss: 0.2496\n32/36 [=========================>....] - ETA: 0s - loss: 0.3432\n36/36 [==============================] - 0s 3ms/step - loss: 0.3563\nEpoch:  46\n 1/36 [..............................] - ETA: 0s - loss: 0.0217\n17/36 [=============>................] - ETA: 0s - loss: 0.2108\n32/36 [=========================>....] - ETA: 0s - loss: 0.3665\n36/36 [==============================] - 0s 3ms/step - loss: 0.3771\nEpoch:  47\n 1/36 [..............................] - ETA: 0s - loss: 0.0277\n16/36 [============>.................] - ETA: 0s - loss: 0.1914\n31/36 [========================>.....] - ETA: 0s - loss: 0.3271\n36/36 [==============================] - 0s 4ms/step - loss: 0.3495\nEpoch:  48\n 1/36 [..............................] - ETA: 0s - loss: 0.0255\n17/36 [=============>................] - ETA: 0s - loss: 0.1785\n32/36 [=========================>....] - ETA: 0s - loss: 0.3308\n36/36 [==============================] - 0s 3ms/step - loss: 0.3450\nEpoch:  49\n 1/36 [..............................] - ETA: 0s - loss: 0.0929\n17/36 [=============>................] - ETA: 0s - loss: 0.2178\n33/36 [==========================>...] - ETA: 0s - loss: 0.3201\n36/36 [==============================] - 0s 3ms/step - loss: 0.3302\nEpoch:  50\n```\n:::\n:::\n\n\n### Predicting Using The LSTM Model\n\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-19_bc2a6006bab2e46410bb8c8ee513f857'}\n\n```{.r .cell-code}\n# Make Predictions\npred_out <- model %>% \n    predict(x_test_arr, batch_size = batch_size) %>%\n    .[,1] \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n 1/12 [=>............................] - ETA: 10s\n12/12 [==============================] - 1s 2ms/step\n```\n:::\n\n```{.r .cell-code}\n# Retransform values\npred_tbl <- tibble(\n    index   = lag_test_tbl$index,\n    value   = (pred_out * scale_history + center_history)^2\n) \n\n# Combine actual data with predictions\ntbl_1 <- df_trn %>%\n    add_column(key = \"actual\")\n\ntbl_2 <- df_tst %>%\n    add_column(key = \"actual\")\n\ntbl_3 <- pred_tbl %>%\n    add_column(key = \"predict\")\n\n# Create time_bind_rows() to solve dplyr issue\ntime_bind_rows <- function(data_1, data_2, index) {\n    index_expr <- enquo(index)\n    bind_rows(data_1, data_2) %>%\n        as_tbl_time(index = !! index_expr)\n}\n\nret <- list(tbl_1, tbl_2, tbl_3) %>%\n    reduce(time_bind_rows, index = index) %>%\n    arrange(key, index) %>%\n    mutate(key = as_factor(key))\n\nret\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A time tibble: 72 × 3\n# Index:         index\n   index      value key   \n   <date>     <dbl> <fct> \n 1 2013-01-01  162. actual\n 2 2013-02-01  158. actual\n 3 2013-03-01  154. actual\n 4 2013-04-01  144. actual\n 5 2013-05-01  137. actual\n 6 2013-06-01  130. actual\n 7 2013-07-01  124. actual\n 8 2013-08-01  131. actual\n 9 2013-09-01  130. actual\n10 2013-10-01  127. actual\n# ℹ 62 more rows\n```\n:::\n:::\n\n\n### Assessing Performance Of The LSTM On A Single Split\n\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-20_f1e1cb74d86b5702931eead4f9aa6bee'}\n\n```{.r .cell-code}\ncalc_rmse <- function(prediction_tbl) {\n    \n    rmse_calculation <- function(data) {\n        data %>%\n            spread(key = key, value = value) %>%\n            select(-index) %>%\n            filter(!is.na(predict)) %>%\n            rename(\n                truth    = actual,\n                estimate = predict\n            ) %>%\n            rmse(truth, estimate) %>% \n      select(.estimate)\n    }\n    \n    safe_rmse <- possibly(rmse_calculation, otherwise = NA)\n    \n    safe_rmse(prediction_tbl)\n        \n}\n```\n:::\n\n\nverificando o RMSE\n\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-21_7eeb29b8d9455f71d5665551f135e955'}\n\n```{.r .cell-code}\ncalc_rmse(ret)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  .estimate\n      <dbl>\n1      2.88\n```\n:::\n:::\n\n\n### Visualizing The Single Prediction\n\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-22_6e70dc64a5d74cda9e521349b9af76c6'}\n\n```{.r .cell-code}\n# Setup single plot function\nplot_prediction <- function(data, id, alpha = 1, size = 2, base_size = 14) {\n    \n    rmse_val <- calc_rmse(data)\n    \n    g <- data %>%\n        ggplot(aes(index, value, color = key)) +\n        geom_point(alpha = alpha, size = size) + \n        theme_tq(base_size = base_size) +\n        scale_color_tq() +\n        theme(legend.position = \"none\") +\n        labs(\n            title = glue(\"{id}, RMSE: {round(rmse_val, digits = 1)}\"),\n            x = \"\", y = \"\"\n        )\n    \n    return(g)\n}\n```\n:::\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-23_0fdd6df5cde645d5b99eac3d75c1373d'}\n\n```{.r .cell-code}\nret %>% \n    plot_prediction(id = split_id, alpha = 0.65) +\n    theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](modelo_sltm_files/figure-html/unnamed-chunk-23-1.png){width=1440}\n:::\n:::\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-24_1a1e3f1842f78cd6f8cf019562da7676'}\n\n```{.r .cell-code}\n# trend <- fit %>% \n#    filter(index >=  \"2023-01-08\", index <= \"2023-02-06\") %>% \n#    select(trend) %>% \n#    tibble()\n# \n# \n# predito <- ret %>% \n#   filter(key==\"predict\") %>% \n#   mutate(\n#     value = value + trend\n#   )\n# \n# original <- gold_original %>% \n#   filter(index >=  \"2023-01-08\", index <= \"2023-02-06\")\n# \n# left_join(original, predito, by = \"index\") %>% \n#   ggplot(aes(x=index))+\n#   geom_line(aes(y=value.x))+\n#   geom_line(aes(y=value.y$trend), color=\"blue\")\n```\n:::\n\n\n### Backtesting The LSTM On All Samples Creating An LSTM Prediction Function\n\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-25_c5f65cb6b6209bd5c3722c6f98f89e92'}\n\n```{.r .cell-code}\npredict_keras_lstm <- function(split, epochs = 50, ...) {\n    \n    lstm_prediction <- function(split, epochs, ...) {\n        \n        # 5.1.2 Data Setup\n        df_trn <- training(split)\n        df_tst <- testing(split)\n        \n        df <- bind_rows(\n            df_trn %>% add_column(key = \"training\"),\n            df_tst %>% add_column(key = \"testing\")\n        ) %>% \n            as_tbl_time(index = index)\n        \n        # 5.1.3 Preprocessing\n        rec_obj <- recipe(value ~ ., df) %>%\n            step_sqrt(value) %>%\n            step_center(value) %>%\n            step_scale(value) %>%\n            prep()\n        \n        df_processed_tbl <- bake(rec_obj, df)\n        \n        center_history <- rec_obj$steps[[2]]$means[\"value\"]\n        scale_history  <- rec_obj$steps[[3]]$sds[\"value\"]\n        \n        # 5.1.4 LSTM Plan\n        lag_setting  <- 12 # = nrow(df_tst)\n        batch_size   <- 1\n        train_length <- 12*5\n        tsteps       <- 1\n        epochs       <- epochs\n        \n        # 5.1.5 Train/Test Setup\n        lag_train_tbl <- df_processed_tbl %>%\n            mutate(value_lag = lag(value, n = lag_setting)) %>%\n            filter(!is.na(value_lag)) %>%\n            filter(key == \"training\") %>%\n            tail(train_length)\n        \n        x_train_vec <- lag_train_tbl$value_lag\n        x_train_arr <- array(data = x_train_vec, dim = c(length(x_train_vec), 1, 1))\n        \n        y_train_vec <- lag_train_tbl$value\n        y_train_arr <- array(data = y_train_vec, dim = c(length(y_train_vec), 1))\n        \n        lag_test_tbl <- df_processed_tbl %>%\n            mutate(\n                value_lag = lag(value, n = lag_setting)\n            ) %>%\n            filter(!is.na(value_lag)) %>%\n            filter(key == \"testing\")\n        \n        x_test_vec <- lag_test_tbl$value_lag\n        x_test_arr <- array(data = x_test_vec, dim = c(length(x_test_vec), 1, 1))\n        \n        y_test_vec <- lag_test_tbl$value\n        y_test_arr <- array(data = y_test_vec, dim = c(length(y_test_vec), 1))\n                \n        # 5.1.6 LSTM Model\n        model <- keras_model_sequential()\n\n        model %>%\n            layer_lstm(units            = 50, \n                       input_shape      = c(tsteps, 1), \n                       batch_size       = batch_size,\n                       return_sequences = TRUE, \n                       stateful         = TRUE) %>% \n            layer_lstm(units            = 50, \n                       return_sequences = FALSE, \n                       stateful         = TRUE) %>% \n            layer_dense(units = 1)\n        \n        model %>% \n            compile(loss = 'mae', optimizer = 'adam')\n        \n        # 5.1.7 Fitting LSTM\n        for (i in 1:epochs) {\n            model %>% fit(x          = x_train_arr, \n                          y          = y_train_arr, \n                          batch_size = batch_size,\n                          epochs     = 1, \n                          verbose    = 1, \n                          shuffle    = FALSE)\n            \n            model %>% reset_states()\n            cat(\"Epoch: \", i)\n            \n        }\n        \n        # 5.1.8 Predict and Return Tidy Data\n        # Make Predictions\n        pred_out <- model %>% \n            predict(x_test_arr, batch_size = batch_size) %>%\n            .[,1] \n        \n        # Retransform values\n        pred_tbl <- tibble(\n            index   = lag_test_tbl$index,\n            value   = (pred_out * scale_history + center_history)^2\n        ) \n        \n        # Combine actual data with predictions\n        tbl_1 <- df_trn %>%\n            add_column(key = \"actual\")\n        \n        tbl_2 <- df_tst %>%\n            add_column(key = \"actual\")\n        \n        tbl_3 <- pred_tbl %>%\n            add_column(key = \"predict\")\n        \n        # Create time_bind_rows() to solve dplyr issue\n        time_bind_rows <- function(data_1, data_2, index) {\n            index_expr <- enquo(index)\n            bind_rows(data_1, data_2) %>%\n                as_tbl_time(index = !! index_expr)\n        }\n        \n        ret <- list(tbl_1, tbl_2, tbl_3) %>%\n            reduce(time_bind_rows, index = index) %>%\n            arrange(key, index) %>%\n            mutate(key = as_factor(key))\n\n        return(ret)\n        \n    }\n    \n    safe_lstm <- possibly(lstm_prediction, otherwise = NA)\n    \n    safe_lstm(split, epochs, ...)\n    \n}\n```\n:::\n\n\ntestando\n\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-26_6d08ca40b3e333f3d80d5719c22e0fae'}\n\n```{.r .cell-code}\npredict_keras_lstm(split, epochs = 10)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n 1/36 [..............................] - ETA: 2:05 - loss: 0.1131\n17/36 [=============>................] - ETA: 0s - loss: 0.5612  \n33/36 [==========================>...] - ETA: 0s - loss: 0.7333\n36/36 [==============================] - 4s 3ms/step - loss: 0.7037\nEpoch:  1\n 1/36 [..............................] - ETA: 0s - loss: 0.1400\n16/36 [============>.................] - ETA: 0s - loss: 0.3220\n31/36 [========================>.....] - ETA: 0s - loss: 0.5406\n36/36 [==============================] - 0s 4ms/step - loss: 0.5454\nEpoch:  2\n 1/36 [..............................] - ETA: 0s - loss: 0.1209\n16/36 [============>.................] - ETA: 0s - loss: 0.2583\n32/36 [=========================>....] - ETA: 0s - loss: 0.5068\n36/36 [==============================] - 0s 3ms/step - loss: 0.5182\nEpoch:  3\n 1/36 [..............................] - ETA: 0s - loss: 0.1461\n16/36 [============>.................] - ETA: 0s - loss: 0.2193\n31/36 [========================>.....] - ETA: 0s - loss: 0.3845\n36/36 [==============================] - 0s 3ms/step - loss: 0.4089\nEpoch:  4\n 1/36 [..............................] - ETA: 0s - loss: 0.0806\n16/36 [============>.................] - ETA: 0s - loss: 0.3829\n32/36 [=========================>....] - ETA: 0s - loss: 0.5230\n36/36 [==============================] - 0s 3ms/step - loss: 0.5190\nEpoch:  5\n 1/36 [..............................] - ETA: 0s - loss: 0.1778\n17/36 [=============>................] - ETA: 0s - loss: 0.3816\n32/36 [=========================>....] - ETA: 0s - loss: 0.5146\n36/36 [==============================] - 0s 4ms/step - loss: 0.5149\nEpoch:  6\n 1/36 [..............................] - ETA: 0s - loss: 0.0640\n15/36 [===========>..................] - ETA: 0s - loss: 0.4098\n29/36 [=======================>......] - ETA: 0s - loss: 0.4974\n36/36 [==============================] - 0s 4ms/step - loss: 0.5160\nEpoch:  7\n 1/36 [..............................] - ETA: 0s - loss: 0.1149\n16/36 [============>.................] - ETA: 0s - loss: 0.2257\n31/36 [========================>.....] - ETA: 0s - loss: 0.4316\n36/36 [==============================] - 0s 4ms/step - loss: 0.4561\nEpoch:  8\n 1/36 [..............................] - ETA: 0s - loss: 0.0993\n17/36 [=============>................] - ETA: 0s - loss: 0.1982\n32/36 [=========================>....] - ETA: 0s - loss: 0.4050\n36/36 [==============================] - 0s 3ms/step - loss: 0.4216\nEpoch:  9\n 1/36 [..............................] - ETA: 0s - loss: 0.1228\n16/36 [============>.................] - ETA: 0s - loss: 0.2277\n31/36 [========================>.....] - ETA: 0s - loss: 0.3579\n36/36 [==============================] - 0s 4ms/step - loss: 0.3944\nEpoch:  10\n 1/12 [=>............................] - ETA: 11s\n12/12 [==============================] - 1s 2ms/step\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n# A time tibble: 72 × 3\n# Index:         index\n   index      value key   \n   <date>     <dbl> <fct> \n 1 2013-01-01  162. actual\n 2 2013-02-01  158. actual\n 3 2013-03-01  154. actual\n 4 2013-04-01  144. actual\n 5 2013-05-01  137. actual\n 6 2013-06-01  130. actual\n 7 2013-07-01  124. actual\n 8 2013-08-01  131. actual\n 9 2013-09-01  130. actual\n10 2013-10-01  127. actual\n# ℹ 62 more rows\n```\n:::\n:::\n\n\n### Mapping The LSTM Prediction Function Over The Samples\n\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-27_85f155ce6f0823ce03c5e5423b4dcd5e'}\n\n```{.r .cell-code}\nsample_predictions_lstm_tbl <- rolling_origin_resamples %>%\n     mutate(predict = map(splits, predict_keras_lstm, epochs = 50))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n 1/36 [..............................] - ETA: 2:22 - loss: 0.1293\n16/36 [============>.................] - ETA: 0s - loss: 0.5531  \n31/36 [========================>.....] - ETA: 0s - loss: 0.7498\n36/36 [==============================] - 4s 3ms/step - loss: 0.7178\nEpoch:  1\n 1/36 [..............................] - ETA: 0s - loss: 0.1395\n17/36 [=============>................] - ETA: 0s - loss: 0.3604\n32/36 [=========================>....] - ETA: 0s - loss: 0.5733\n36/36 [==============================] - 0s 3ms/step - loss: 0.5627\nEpoch:  2\n 1/36 [..............................] - ETA: 0s - loss: 0.1365\n17/36 [=============>................] - ETA: 0s - loss: 0.2893\n33/36 [==========================>...] - ETA: 0s - loss: 0.5449\n36/36 [==============================] - 0s 3ms/step - loss: 0.5338\nEpoch:  3\n 1/36 [..............................] - ETA: 0s - loss: 0.1493\n17/36 [=============>................] - ETA: 0s - loss: 0.2044\n30/36 [========================>.....] - ETA: 0s - loss: 0.3803\n36/36 [==============================] - 0s 4ms/step - loss: 0.4155\nEpoch:  4\n 1/36 [..............................] - ETA: 0s - loss: 0.0819\n16/36 [============>.................] - ETA: 0s - loss: 0.4520\n31/36 [========================>.....] - ETA: 0s - loss: 0.5468\n36/36 [==============================] - 0s 4ms/step - loss: 0.5453\nEpoch:  5\n 1/36 [..............................] - ETA: 0s - loss: 0.1864\n14/36 [==========>...................] - ETA: 0s - loss: 0.3830\n25/36 [===================>..........] - ETA: 0s - loss: 0.6012\n35/36 [============================>.] - ETA: 0s - loss: 0.5206\n36/36 [==============================] - 0s 5ms/step - loss: 0.5335\nEpoch:  6\n 1/36 [..............................] - ETA: 0s - loss: 0.0905\n13/36 [=========>....................] - ETA: 0s - loss: 0.3459\n26/36 [====================>.........] - ETA: 0s - loss: 0.5613\n36/36 [==============================] - 0s 4ms/step - loss: 0.5248\nEpoch:  7\n 1/36 [..............................] - ETA: 0s - loss: 0.1253\n14/36 [==========>...................] - ETA: 0s - loss: 0.2312\n26/36 [====================>.........] - ETA: 0s - loss: 0.4667\n36/36 [==============================] - 0s 4ms/step - loss: 0.5013\nEpoch:  8\n 1/36 [..............................] - ETA: 0s - loss: 0.1580\n15/36 [===========>..................] - ETA: 0s - loss: 0.2496\n27/36 [=====================>........] - ETA: 0s - loss: 0.4226\n36/36 [==============================] - 0s 4ms/step - loss: 0.4409\nEpoch:  9\n 1/36 [..............................] - ETA: 0s - loss: 0.0905\n13/36 [=========>....................] - ETA: 0s - loss: 0.2942\n27/36 [=====================>........] - ETA: 0s - loss: 0.4302\n36/36 [==============================] - 0s 4ms/step - loss: 0.4601\nEpoch:  10\n 1/36 [..............................] - ETA: 0s - loss: 0.1805\n14/36 [==========>...................] - ETA: 0s - loss: 0.3993\n27/36 [=====================>........] - ETA: 0s - loss: 0.4885\n36/36 [==============================] - 0s 4ms/step - loss: 0.4703\nEpoch:  11\n 1/36 [..............................] - ETA: 0s - loss: 0.0420\n13/36 [=========>....................] - ETA: 0s - loss: 0.4062\n25/36 [===================>..........] - ETA: 0s - loss: 0.5588\n36/36 [==============================] - 0s 4ms/step - loss: 0.5201\nEpoch:  12\n 1/36 [..............................] - ETA: 0s - loss: 0.0746\n12/36 [=========>....................] - ETA: 0s - loss: 0.2865\n24/36 [===================>..........] - ETA: 0s - loss: 0.4345\n36/36 [==============================] - 0s 4ms/step - loss: 0.4921\nEpoch:  13\n 1/36 [..............................] - ETA: 0s - loss: 0.1050\n13/36 [=========>....................] - ETA: 0s - loss: 0.2147\n24/36 [===================>..........] - ETA: 0s - loss: 0.3511\n35/36 [============================>.] - ETA: 0s - loss: 0.3971\n36/36 [==============================] - 0s 5ms/step - loss: 0.4144\nEpoch:  14\n 1/36 [..............................] - ETA: 0s - loss: 0.0978\n12/36 [=========>....................] - ETA: 0s - loss: 0.1673\n23/36 [==================>...........] - ETA: 0s - loss: 0.2998\n34/36 [===========================>..] - ETA: 0s - loss: 0.3732\n36/36 [==============================] - 0s 5ms/step - loss: 0.3942\nEpoch:  15\n 1/36 [..............................] - ETA: 0s - loss: 0.1381\n14/36 [==========>...................] - ETA: 0s - loss: 0.2469\n26/36 [====================>.........] - ETA: 0s - loss: 0.3806\n36/36 [==============================] - 0s 4ms/step - loss: 0.4020\nEpoch:  16\n 1/36 [..............................] - ETA: 0s - loss: 0.0988\n16/36 [============>.................] - ETA: 0s - loss: 0.2573\n32/36 [=========================>....] - ETA: 0s - loss: 0.3877\n36/36 [==============================] - 0s 3ms/step - loss: 0.4110\nEpoch:  17\n 1/36 [..............................] - ETA: 0s - loss: 0.1783\n16/36 [============>.................] - ETA: 0s - loss: 0.2975\n30/36 [========================>.....] - ETA: 0s - loss: 0.4049\n36/36 [==============================] - 0s 4ms/step - loss: 0.4429\nEpoch:  18\n 1/36 [..............................] - ETA: 0s - loss: 0.1018\n12/36 [=========>....................] - ETA: 0s - loss: 0.3248\n24/36 [===================>..........] - ETA: 0s - loss: 0.4614\n36/36 [==============================] - 0s 4ms/step - loss: 0.4601\nEpoch:  19\n 1/36 [..............................] - ETA: 0s - loss: 0.1772\n12/36 [=========>....................] - ETA: 0s - loss: 0.2426\n24/36 [===================>..........] - ETA: 0s - loss: 0.3944\n36/36 [==============================] - ETA: 0s - loss: 0.4227\n36/36 [==============================] - 0s 5ms/step - loss: 0.4227\nEpoch:  20\n 1/36 [..............................] - ETA: 0s - loss: 0.1457\n13/36 [=========>....................] - ETA: 0s - loss: 0.1917\n25/36 [===================>..........] - ETA: 0s - loss: 0.3422\n36/36 [==============================] - 0s 5ms/step - loss: 0.3707\nEpoch:  21\n 1/36 [..............................] - ETA: 0s - loss: 0.1353\n13/36 [=========>....................] - ETA: 0s - loss: 0.2007\n25/36 [===================>..........] - ETA: 0s - loss: 0.3341\n36/36 [==============================] - 0s 4ms/step - loss: 0.3983\nEpoch:  22\n 1/36 [..............................] - ETA: 0s - loss: 0.1229\n12/36 [=========>....................] - ETA: 0s - loss: 0.1489\n23/36 [==================>...........] - ETA: 0s - loss: 0.2384\n34/36 [===========================>..] - ETA: 0s - loss: 0.2841\n36/36 [==============================] - 0s 5ms/step - loss: 0.3214\nEpoch:  23\n 1/36 [..............................] - ETA: 0s - loss: 0.1348\n13/36 [=========>....................] - ETA: 0s - loss: 0.1794\n28/36 [======================>.......] - ETA: 0s - loss: 0.3703\n36/36 [==============================] - 0s 4ms/step - loss: 0.4169\nEpoch:  24\n 1/36 [..............................] - ETA: 0s - loss: 0.1636\n16/36 [============>.................] - ETA: 0s - loss: 0.1821\n31/36 [========================>.....] - ETA: 0s - loss: 0.2690\n36/36 [==============================] - 0s 4ms/step - loss: 0.3023\nEpoch:  25\n 1/36 [..............................] - ETA: 0s - loss: 0.0698\n14/36 [==========>...................] - ETA: 0s - loss: 0.2095\n27/36 [=====================>........] - ETA: 0s - loss: 0.3802\n36/36 [==============================] - 0s 4ms/step - loss: 0.3790\nEpoch:  26\n 1/36 [..............................] - ETA: 0s - loss: 0.1537\n16/36 [============>.................] - ETA: 0s - loss: 0.2179\n28/36 [======================>.......] - ETA: 0s - loss: 0.4200\n36/36 [==============================] - 0s 4ms/step - loss: 0.4491\nEpoch:  27\n 1/36 [..............................] - ETA: 0s - loss: 0.2531\n14/36 [==========>...................] - ETA: 0s - loss: 0.3155\n27/36 [=====================>........] - ETA: 0s - loss: 0.4601\n36/36 [==============================] - 0s 4ms/step - loss: 0.4531\nEpoch:  28\n 1/36 [..............................] - ETA: 0s - loss: 0.0740\n12/36 [=========>....................] - ETA: 0s - loss: 0.2099\n23/36 [==================>...........] - ETA: 0s - loss: 0.2642\n34/36 [===========================>..] - ETA: 0s - loss: 0.3904\n36/36 [==============================] - 0s 5ms/step - loss: 0.4086\nEpoch:  29\n 1/36 [..............................] - ETA: 0s - loss: 0.1113\n14/36 [==========>...................] - ETA: 0s - loss: 0.2349\n27/36 [=====================>........] - ETA: 0s - loss: 0.4397\n36/36 [==============================] - 0s 4ms/step - loss: 0.4259\nEpoch:  30\n 1/36 [..............................] - ETA: 0s - loss: 0.1075\n13/36 [=========>....................] - ETA: 0s - loss: 0.1785\n24/36 [===================>..........] - ETA: 0s - loss: 0.3077\n35/36 [============================>.] - ETA: 0s - loss: 0.3377\n36/36 [==============================] - 0s 5ms/step - loss: 0.3546\nEpoch:  31\n 1/36 [..............................] - ETA: 0s - loss: 0.1164\n15/36 [===========>..................] - ETA: 0s - loss: 0.2058\n29/36 [=======================>......] - ETA: 0s - loss: 0.3337\n36/36 [==============================] - 0s 4ms/step - loss: 0.4077\nEpoch:  32\n 1/36 [..............................] - ETA: 0s - loss: 0.1603\n15/36 [===========>..................] - ETA: 0s - loss: 0.2179\n29/36 [=======================>......] - ETA: 0s - loss: 0.3982\n36/36 [==============================] - 0s 4ms/step - loss: 0.4160\nEpoch:  33\n 1/36 [..............................] - ETA: 0s - loss: 0.0897\n15/36 [===========>..................] - ETA: 0s - loss: 0.1814\n27/36 [=====================>........] - ETA: 0s - loss: 0.2648\n36/36 [==============================] - 0s 4ms/step - loss: 0.3482\nEpoch:  34\n 1/36 [..............................] - ETA: 0s - loss: 0.1472\n15/36 [===========>..................] - ETA: 0s - loss: 0.2773\n31/36 [========================>.....] - ETA: 0s - loss: 0.4083\n36/36 [==============================] - 0s 4ms/step - loss: 0.4211\nEpoch:  35\n 1/36 [..............................] - ETA: 0s - loss: 0.0039\n18/36 [==============>...............] - ETA: 0s - loss: 0.2432\n35/36 [============================>.] - ETA: 0s - loss: 0.3889\n36/36 [==============================] - 0s 3ms/step - loss: 0.4053\nEpoch:  36\n 1/36 [..............................] - ETA: 0s - loss: 0.0608\n16/36 [============>.................] - ETA: 0s - loss: 0.2032\n30/36 [========================>.....] - ETA: 0s - loss: 0.3470\n36/36 [==============================] - 0s 4ms/step - loss: 0.3793\nEpoch:  37\n 1/36 [..............................] - ETA: 0s - loss: 0.0601\n18/36 [==============>...............] - ETA: 0s - loss: 0.2094\n34/36 [===========================>..] - ETA: 0s - loss: 0.3602\n36/36 [==============================] - 0s 3ms/step - loss: 0.3726\nEpoch:  38\n 1/36 [..............................] - ETA: 0s - loss: 0.0647\n17/36 [=============>................] - ETA: 0s - loss: 0.1630\n33/36 [==========================>...] - ETA: 0s - loss: 0.2993\n36/36 [==============================] - 0s 3ms/step - loss: 0.3093\nEpoch:  39\n 1/36 [..............................] - ETA: 0s - loss: 0.1166\n16/36 [============>.................] - ETA: 0s - loss: 0.2701\n33/36 [==========================>...] - ETA: 0s - loss: 0.4348\n36/36 [==============================] - 0s 3ms/step - loss: 0.4350\nEpoch:  40\n 1/36 [..............................] - ETA: 0s - loss: 0.0306\n17/36 [=============>................] - ETA: 0s - loss: 0.2182\n34/36 [===========================>..] - ETA: 0s - loss: 0.3266\n36/36 [==============================] - 0s 3ms/step - loss: 0.3439\nEpoch:  41\n 1/36 [..............................] - ETA: 0s - loss: 0.0733\n17/36 [=============>................] - ETA: 0s - loss: 0.1752\n33/36 [==========================>...] - ETA: 0s - loss: 0.5937\n36/36 [==============================] - 0s 3ms/step - loss: 0.6043\nEpoch:  42\n 1/36 [..............................] - ETA: 0s - loss: 0.0153\n17/36 [=============>................] - ETA: 0s - loss: 0.1818\n33/36 [==========================>...] - ETA: 0s - loss: 0.3982\n36/36 [==============================] - 0s 3ms/step - loss: 0.4003\nEpoch:  43\n 1/36 [..............................] - ETA: 0s - loss: 0.0708\n17/36 [=============>................] - ETA: 0s - loss: 0.1865\n34/36 [===========================>..] - ETA: 0s - loss: 0.3292\n36/36 [==============================] - 0s 3ms/step - loss: 0.3453\nEpoch:  44\n 1/36 [..............................] - ETA: 0s - loss: 0.0681\n17/36 [=============>................] - ETA: 0s - loss: 0.1888\n33/36 [==========================>...] - ETA: 0s - loss: 0.3057\n36/36 [==============================] - 0s 3ms/step - loss: 0.3170\nEpoch:  45\n 1/36 [..............................] - ETA: 0s - loss: 0.0065\n17/36 [=============>................] - ETA: 0s - loss: 0.1320\n33/36 [==========================>...] - ETA: 0s - loss: 0.3746\n36/36 [==============================] - 0s 3ms/step - loss: 0.3792\nEpoch:  46\n 1/36 [..............................] - ETA: 0s - loss: 0.0386\n18/36 [==============>...............] - ETA: 0s - loss: 0.1704\n32/36 [=========================>....] - ETA: 0s - loss: 0.2923\n36/36 [==============================] - 0s 3ms/step - loss: 0.3118\nEpoch:  47\n 1/36 [..............................] - ETA: 0s - loss: 0.0730\n16/36 [============>.................] - ETA: 0s - loss: 0.1829\n32/36 [=========================>....] - ETA: 0s - loss: 0.2795\n36/36 [==============================] - 0s 3ms/step - loss: 0.3002\nEpoch:  48\n 1/36 [..............................] - ETA: 0s - loss: 0.0295\n17/36 [=============>................] - ETA: 0s - loss: 0.1935\n33/36 [==========================>...] - ETA: 0s - loss: 0.3884\n36/36 [==============================] - 0s 3ms/step - loss: 0.3936\nEpoch:  49\n 1/36 [..............................] - ETA: 0s - loss: 0.0079\n17/36 [=============>................] - ETA: 0s - loss: 0.1416\n33/36 [==========================>...] - ETA: 0s - loss: 0.2533\n36/36 [==============================] - 0s 3ms/step - loss: 0.2715\nEpoch:  50\n 1/12 [=>............................] - ETA: 11s\n12/12 [==============================] - 1s 2ms/step\n\n 1/36 [..............................] - ETA: 2:06 - loss: 0.6188\n18/36 [==============>...............] - ETA: 0s - loss: 0.3858  \n34/36 [===========================>..] - ETA: 0s - loss: 0.4170\n36/36 [==============================] - 4s 3ms/step - loss: 0.4048\nEpoch:  1\n 1/36 [..............................] - ETA: 0s - loss: 0.6185\n17/36 [=============>................] - ETA: 0s - loss: 0.3626\n34/36 [===========================>..] - ETA: 0s - loss: 0.3996\n36/36 [==============================] - 0s 3ms/step - loss: 0.3883\nEpoch:  2\n 1/36 [..............................] - ETA: 0s - loss: 0.6241\n18/36 [==============>...............] - ETA: 0s - loss: 0.3455\n34/36 [===========================>..] - ETA: 0s - loss: 0.3917\n36/36 [==============================] - 0s 3ms/step - loss: 0.3807\nEpoch:  3\n 1/36 [..............................] - ETA: 0s - loss: 0.6247\n18/36 [==============>...............] - ETA: 0s - loss: 0.3386\n35/36 [============================>.] - ETA: 0s - loss: 0.3856\n36/36 [==============================] - 0s 3ms/step - loss: 0.3764\nEpoch:  4\n 1/36 [..............................] - ETA: 0s - loss: 0.6375\n18/36 [==============>...............] - ETA: 0s - loss: 0.3382\n34/36 [===========================>..] - ETA: 0s - loss: 0.3738\n36/36 [==============================] - 0s 3ms/step - loss: 0.3637\nEpoch:  5\n 1/36 [..............................] - ETA: 0s - loss: 0.6320\n17/36 [=============>................] - ETA: 0s - loss: 0.3643\n34/36 [===========================>..] - ETA: 0s - loss: 0.3803\n36/36 [==============================] - 0s 3ms/step - loss: 0.3706\nEpoch:  6\n 1/36 [..............................] - ETA: 0s - loss: 0.6491\n17/36 [=============>................] - ETA: 0s - loss: 0.4066\n33/36 [==========================>...] - ETA: 0s - loss: 0.4022\n36/36 [==============================] - 0s 3ms/step - loss: 0.3961\nEpoch:  7\n 1/36 [..............................] - ETA: 0s - loss: 0.6340\n17/36 [=============>................] - ETA: 0s - loss: 0.3658\n33/36 [==========================>...] - ETA: 0s - loss: 0.3867\n36/36 [==============================] - 0s 3ms/step - loss: 0.3815\nEpoch:  8\n 1/36 [..............................] - ETA: 0s - loss: 0.6268\n18/36 [==============>...............] - ETA: 0s - loss: 0.3415\n35/36 [============================>.] - ETA: 0s - loss: 0.3838\n36/36 [==============================] - 0s 3ms/step - loss: 0.3762\nEpoch:  9\n 1/36 [..............................] - ETA: 0s - loss: 0.6257\n18/36 [==============>...............] - ETA: 0s - loss: 0.3358\n35/36 [============================>.] - ETA: 0s - loss: 0.3776\n36/36 [==============================] - 0s 3ms/step - loss: 0.3689\nEpoch:  10\n 1/36 [..............................] - ETA: 0s - loss: 0.6385\n18/36 [==============>...............] - ETA: 0s - loss: 0.3400\n34/36 [===========================>..] - ETA: 0s - loss: 0.3746\n36/36 [==============================] - 0s 3ms/step - loss: 0.3645\nEpoch:  11\n 1/36 [..............................] - ETA: 0s - loss: 0.6335\n17/36 [=============>................] - ETA: 0s - loss: 0.3401\n33/36 [==========================>...] - ETA: 0s - loss: 0.3611\n36/36 [==============================] - 0s 3ms/step - loss: 0.3600\nEpoch:  12\n 1/36 [..............................] - ETA: 0s - loss: 0.6416\n17/36 [=============>................] - ETA: 0s - loss: 0.3601\n34/36 [===========================>..] - ETA: 0s - loss: 0.3831\n36/36 [==============================] - 0s 3ms/step - loss: 0.3728\nEpoch:  13\n 1/36 [..............................] - ETA: 0s - loss: 0.6343\n18/36 [==============>...............] - ETA: 0s - loss: 0.3318\n35/36 [============================>.] - ETA: 0s - loss: 0.3723\n36/36 [==============================] - 0s 3ms/step - loss: 0.3633\nEpoch:  14\n 1/36 [..............................] - ETA: 0s - loss: 0.6394\n15/36 [===========>..................] - ETA: 0s - loss: 0.3762\n25/36 [===================>..........] - ETA: 0s - loss: 0.3093\n35/36 [============================>.] - ETA: 0s - loss: 0.3670\n36/36 [==============================] - 0s 5ms/step - loss: 0.3587\nEpoch:  15\n 1/36 [..............................] - ETA: 0s - loss: 0.6355\n18/36 [==============>...............] - ETA: 0s - loss: 0.3333\n35/36 [============================>.] - ETA: 0s - loss: 0.3653\n36/36 [==============================] - 0s 3ms/step - loss: 0.3579\nEpoch:  16\n 1/36 [..............................] - ETA: 0s - loss: 0.6293\n17/36 [=============>................] - ETA: 0s - loss: 0.3378\n34/36 [===========================>..] - ETA: 0s - loss: 0.3715\n36/36 [==============================] - 0s 3ms/step - loss: 0.3617\nEpoch:  17\n 1/36 [..............................] - ETA: 0s - loss: 0.6265\n18/36 [==============>...............] - ETA: 0s - loss: 0.3566\n34/36 [===========================>..] - ETA: 0s - loss: 0.3735\n36/36 [==============================] - 0s 3ms/step - loss: 0.3643\nEpoch:  18\n 1/36 [..............................] - ETA: 0s - loss: 0.6431\n17/36 [=============>................] - ETA: 0s - loss: 0.3983\n33/36 [==========================>...] - ETA: 0s - loss: 0.3995\n36/36 [==============================] - 0s 3ms/step - loss: 0.3929\nEpoch:  19\n 1/36 [..............................] - ETA: 0s - loss: 0.6293\n17/36 [=============>................] - ETA: 0s - loss: 0.3614\n33/36 [==========================>...] - ETA: 0s - loss: 0.3818\n36/36 [==============================] - 0s 3ms/step - loss: 0.3768\nEpoch:  20\n 1/36 [..............................] - ETA: 0s - loss: 0.6226\n18/36 [==============>...............] - ETA: 0s - loss: 0.3382\n35/36 [============================>.] - ETA: 0s - loss: 0.3735\n36/36 [==============================] - 0s 3ms/step - loss: 0.3660\nEpoch:  21\n 1/36 [..............................] - ETA: 0s - loss: 0.6279\n18/36 [==============>...............] - ETA: 0s - loss: 0.3322\n35/36 [============================>.] - ETA: 0s - loss: 0.3605\n36/36 [==============================] - 0s 3ms/step - loss: 0.3541\nEpoch:  22\n 1/36 [..............................] - ETA: 0s - loss: 0.6360\n17/36 [=============>................] - ETA: 0s - loss: 0.3701\n33/36 [==========================>...] - ETA: 0s - loss: 0.3805\n36/36 [==============================] - 0s 3ms/step - loss: 0.3764\nEpoch:  23\n 1/36 [..............................] - ETA: 0s - loss: 0.6298\n18/36 [==============>...............] - ETA: 0s - loss: 0.3452\n34/36 [===========================>..] - ETA: 0s - loss: 0.3727\n36/36 [==============================] - 0s 3ms/step - loss: 0.3630\nEpoch:  24\n 1/36 [..............................] - ETA: 0s - loss: 0.6233\n17/36 [=============>................] - ETA: 0s - loss: 0.3380\n33/36 [==========================>...] - ETA: 0s - loss: 0.3556\n36/36 [==============================] - 0s 3ms/step - loss: 0.3541\nEpoch:  25\n 1/36 [..............................] - ETA: 0s - loss: 0.6364\n16/36 [============>.................] - ETA: 0s - loss: 0.3893\n32/36 [=========================>....] - ETA: 0s - loss: 0.3744\n36/36 [==============================] - 0s 3ms/step - loss: 0.3778\nEpoch:  26\n 1/36 [..............................] - ETA: 0s - loss: 0.6303\n16/36 [============>.................] - ETA: 0s - loss: 0.3694\n30/36 [========================>.....] - ETA: 0s - loss: 0.3277\n36/36 [==============================] - 0s 4ms/step - loss: 0.3614\nEpoch:  27\n 1/36 [..............................] - ETA: 0s - loss: 0.6192\n17/36 [=============>................] - ETA: 0s - loss: 0.3387\n33/36 [==========================>...] - ETA: 0s - loss: 0.3561\n36/36 [==============================] - 0s 3ms/step - loss: 0.3544\nEpoch:  28\n 1/36 [..............................] - ETA: 0s - loss: 0.6301\n17/36 [=============>................] - ETA: 0s - loss: 0.3662\n33/36 [==========================>...] - ETA: 0s - loss: 0.3726\n36/36 [==============================] - 0s 3ms/step - loss: 0.3685\nEpoch:  29\n 1/36 [..............................] - ETA: 0s - loss: 0.6195\n17/36 [=============>................] - ETA: 0s - loss: 0.3359\n33/36 [==========================>...] - ETA: 0s - loss: 0.3557\n36/36 [==============================] - 0s 3ms/step - loss: 0.3523\nEpoch:  30\n 1/36 [..............................] - ETA: 0s - loss: 0.6023\n18/36 [==============>...............] - ETA: 0s - loss: 0.3679\n34/36 [===========================>..] - ETA: 0s - loss: 0.3727\n36/36 [==============================] - 0s 3ms/step - loss: 0.3639\nEpoch:  31\n 1/36 [..............................] - ETA: 0s - loss: 0.6276\n17/36 [=============>................] - ETA: 0s - loss: 0.3824\n33/36 [==========================>...] - ETA: 0s - loss: 0.4106\n36/36 [==============================] - 0s 3ms/step - loss: 0.4013\nEpoch:  32\n 1/36 [..............................] - ETA: 0s - loss: 0.6290\n17/36 [=============>................] - ETA: 0s - loss: 0.3631\n33/36 [==========================>...] - ETA: 0s - loss: 0.3723\n36/36 [==============================] - 0s 3ms/step - loss: 0.3680\nEpoch:  33\n 1/36 [..............................] - ETA: 0s - loss: 0.6248\n16/36 [============>.................] - ETA: 0s - loss: 0.3520\n32/36 [=========================>....] - ETA: 0s - loss: 0.3390\n36/36 [==============================] - 0s 3ms/step - loss: 0.3468\nEpoch:  34\n 1/36 [..............................] - ETA: 0s - loss: 0.6164\n18/36 [==============>...............] - ETA: 0s - loss: 0.3399\n35/36 [============================>.] - ETA: 0s - loss: 0.3477\n36/36 [==============================] - 0s 3ms/step - loss: 0.3458\nEpoch:  35\n 1/36 [..............................] - ETA: 0s - loss: 0.6088\n17/36 [=============>................] - ETA: 0s - loss: 0.3394\n33/36 [==========================>...] - ETA: 0s - loss: 0.3528\n36/36 [==============================] - 0s 3ms/step - loss: 0.3481\nEpoch:  36\n 1/36 [..............................] - ETA: 0s - loss: 0.6127\n18/36 [==============>...............] - ETA: 0s - loss: 0.3340\n35/36 [============================>.] - ETA: 0s - loss: 0.3365\n36/36 [==============================] - 0s 3ms/step - loss: 0.3381\nEpoch:  37\n 1/36 [..............................] - ETA: 0s - loss: 0.6093\n18/36 [==============>...............] - ETA: 0s - loss: 0.3439\n35/36 [============================>.] - ETA: 0s - loss: 0.3339\n36/36 [==============================] - 0s 3ms/step - loss: 0.3408\nEpoch:  38\n 1/36 [..............................] - ETA: 0s - loss: 0.6049\n17/36 [=============>................] - ETA: 0s - loss: 0.3419\n32/36 [=========================>....] - ETA: 0s - loss: 0.3660\n36/36 [==============================] - 0s 3ms/step - loss: 0.3617\nEpoch:  39\n 1/36 [..............................] - ETA: 0s - loss: 0.6303\n17/36 [=============>................] - ETA: 0s - loss: 0.5211\n34/36 [===========================>..] - ETA: 0s - loss: 0.5619\n36/36 [==============================] - 0s 3ms/step - loss: 0.5422\nEpoch:  40\n 1/36 [..............................] - ETA: 0s - loss: 0.6195\n17/36 [=============>................] - ETA: 0s - loss: 0.3507\n33/36 [==========================>...] - ETA: 0s - loss: 0.3773\n36/36 [==============================] - 0s 3ms/step - loss: 0.3724\nEpoch:  41\n 1/36 [..............................] - ETA: 0s - loss: 0.6189\n18/36 [==============>...............] - ETA: 0s - loss: 0.3245\n35/36 [============================>.] - ETA: 0s - loss: 0.3617\n36/36 [==============================] - 0s 3ms/step - loss: 0.3559\nEpoch:  42\n 1/36 [..............................] - ETA: 0s - loss: 0.6236\n17/36 [=============>................] - ETA: 0s - loss: 0.3264\n33/36 [==========================>...] - ETA: 0s - loss: 0.3468\n36/36 [==============================] - 0s 3ms/step - loss: 0.3463\nEpoch:  43\n 1/36 [..............................] - ETA: 0s - loss: 0.6221\n18/36 [==============>...............] - ETA: 0s - loss: 0.3474\n35/36 [============================>.] - ETA: 0s - loss: 0.3561\n36/36 [==============================] - 0s 3ms/step - loss: 0.3525\nEpoch:  44\n 1/36 [..............................] - ETA: 0s - loss: 0.6055\n18/36 [==============>...............] - ETA: 0s - loss: 0.3675\n35/36 [============================>.] - ETA: 0s - loss: 0.3526\n36/36 [==============================] - 0s 3ms/step - loss: 0.3517\nEpoch:  45\n 1/36 [..............................] - ETA: 0s - loss: 0.6062\n18/36 [==============>...............] - ETA: 0s - loss: 0.3726\n34/36 [===========================>..] - ETA: 0s - loss: 0.4219\n36/36 [==============================] - 0s 3ms/step - loss: 0.4105\nEpoch:  46\n 1/36 [..............................] - ETA: 0s - loss: 0.6075\n17/36 [=============>................] - ETA: 0s - loss: 0.3774\n33/36 [==========================>...] - ETA: 0s - loss: 0.4017\n36/36 [==============================] - 0s 3ms/step - loss: 0.3932\nEpoch:  47\n 1/36 [..............................] - ETA: 0s - loss: 0.6094\n17/36 [=============>................] - ETA: 0s - loss: 0.3702\n34/36 [===========================>..] - ETA: 0s - loss: 0.3973\n36/36 [==============================] - 0s 3ms/step - loss: 0.3871\nEpoch:  48\n 1/36 [..............................] - ETA: 0s - loss: 0.6098\n17/36 [=============>................] - ETA: 0s - loss: 0.3614\n33/36 [==========================>...] - ETA: 0s - loss: 0.3872\n36/36 [==============================] - 0s 3ms/step - loss: 0.3810\nEpoch:  49\n 1/36 [..............................] - ETA: 0s - loss: 0.6099\n17/36 [=============>................] - ETA: 0s - loss: 0.3486\n33/36 [==========================>...] - ETA: 0s - loss: 0.3782\n36/36 [==============================] - 0s 3ms/step - loss: 0.3732\nEpoch:  50\n 1/12 [=>............................] - ETA: 8s\n12/12 [==============================] - 1s 2ms/step\n\n 1/36 [..............................] - ETA: 1:58 - loss: 0.7248\n17/36 [=============>................] - ETA: 0s - loss: 0.6026  \n34/36 [===========================>..] - ETA: 0s - loss: 1.0176\n36/36 [==============================] - 4s 3ms/step - loss: 1.0300\nEpoch:  1\n 1/36 [..............................] - ETA: 0s - loss: 0.7135\n18/36 [==============>...............] - ETA: 0s - loss: 0.8785\n34/36 [===========================>..] - ETA: 0s - loss: 0.8507\n36/36 [==============================] - 0s 3ms/step - loss: 0.8692\nEpoch:  2\n 1/36 [..............................] - ETA: 0s - loss: 0.7138\n15/36 [===========>..................] - ETA: 0s - loss: 0.9735\n32/36 [=========================>....] - ETA: 0s - loss: 0.8140\n36/36 [==============================] - 0s 3ms/step - loss: 0.8614\nEpoch:  3\n 1/36 [..............................] - ETA: 0s - loss: 0.7084\n14/36 [==========>...................] - ETA: 0s - loss: 0.9619\n27/36 [=====================>........] - ETA: 0s - loss: 0.6935\n36/36 [==============================] - 0s 4ms/step - loss: 0.8500\nEpoch:  4\n 1/36 [..............................] - ETA: 0s - loss: 0.7107\n17/36 [=============>................] - ETA: 0s - loss: 0.9220\n33/36 [==========================>...] - ETA: 0s - loss: 0.8185\n36/36 [==============================] - 0s 3ms/step - loss: 0.8482\nEpoch:  5\n 1/36 [..............................] - ETA: 0s - loss: 0.7058\n17/36 [=============>................] - ETA: 0s - loss: 0.9036\n33/36 [==========================>...] - ETA: 0s - loss: 0.8152\n36/36 [==============================] - 0s 3ms/step - loss: 0.8435\nEpoch:  6\n 1/36 [..............................] - ETA: 0s - loss: 0.7069\n16/36 [============>.................] - ETA: 0s - loss: 0.9577\n32/36 [=========================>....] - ETA: 0s - loss: 0.8002\n36/36 [==============================] - 0s 3ms/step - loss: 0.8415\nEpoch:  7\n 1/36 [..............................] - ETA: 0s - loss: 0.7002\n16/36 [============>.................] - ETA: 0s - loss: 0.9350\n32/36 [=========================>....] - ETA: 0s - loss: 0.7999\n36/36 [==============================] - 0s 3ms/step - loss: 0.8382\nEpoch:  8\n 1/36 [..............................] - ETA: 0s - loss: 0.6996\n17/36 [=============>................] - ETA: 0s - loss: 0.9149\n34/36 [===========================>..] - ETA: 0s - loss: 0.8141\n36/36 [==============================] - 0s 3ms/step - loss: 0.8284\nEpoch:  9\n 1/36 [..............................] - ETA: 0s - loss: 0.7002\n17/36 [=============>................] - ETA: 0s - loss: 0.9266\n32/36 [=========================>....] - ETA: 0s - loss: 0.7885\n36/36 [==============================] - 0s 3ms/step - loss: 0.8227\nEpoch:  10\n 1/36 [..............................] - ETA: 0s - loss: 0.6990\n17/36 [=============>................] - ETA: 0s - loss: 0.9298\n33/36 [==========================>...] - ETA: 0s - loss: 0.7989\n36/36 [==============================] - 0s 3ms/step - loss: 0.8181\nEpoch:  11\n 1/36 [..............................] - ETA: 0s - loss: 0.6958\n17/36 [=============>................] - ETA: 0s - loss: 0.9340\n34/36 [===========================>..] - ETA: 0s - loss: 0.8016\n36/36 [==============================] - 0s 3ms/step - loss: 0.8080\nEpoch:  12\n 1/36 [..............................] - ETA: 0s - loss: 0.6899\n17/36 [=============>................] - ETA: 0s - loss: 0.9287\n34/36 [===========================>..] - ETA: 0s - loss: 0.8012\n36/36 [==============================] - 0s 3ms/step - loss: 0.7972\nEpoch:  13\n 1/36 [..............................] - ETA: 0s - loss: 0.6799\n17/36 [=============>................] - ETA: 0s - loss: 0.9371\n33/36 [==========================>...] - ETA: 0s - loss: 0.7793\n36/36 [==============================] - 0s 3ms/step - loss: 0.7380\nEpoch:  14\n 1/36 [..............................] - ETA: 0s - loss: 0.6619\n17/36 [=============>................] - ETA: 0s - loss: 0.9590\n33/36 [==========================>...] - ETA: 0s - loss: 0.7833\n36/36 [==============================] - 0s 3ms/step - loss: 0.7798\nEpoch:  15\n 1/36 [..............................] - ETA: 0s - loss: 0.6395\n17/36 [=============>................] - ETA: 0s - loss: 0.9803\n33/36 [==========================>...] - ETA: 0s - loss: 0.7849\n36/36 [==============================] - 0s 3ms/step - loss: 0.7844\nEpoch:  16\n 1/36 [..............................] - ETA: 0s - loss: 0.6263\n17/36 [=============>................] - ETA: 0s - loss: 0.9273\n32/36 [=========================>....] - ETA: 0s - loss: 0.7825\n36/36 [==============================] - 0s 3ms/step - loss: 0.7279\nEpoch:  17\n 1/36 [..............................] - ETA: 0s - loss: 0.6026\n17/36 [=============>................] - ETA: 0s - loss: 0.8639\n33/36 [==========================>...] - ETA: 0s - loss: 0.7567\n36/36 [==============================] - 0s 3ms/step - loss: 0.7677\nEpoch:  18\n 1/36 [..............................] - ETA: 0s - loss: 0.5775\n17/36 [=============>................] - ETA: 0s - loss: 0.8687\n33/36 [==========================>...] - ETA: 0s - loss: 0.7767\n36/36 [==============================] - 0s 3ms/step - loss: 0.7924\nEpoch:  19\n 1/36 [..............................] - ETA: 0s - loss: 0.5711\n17/36 [=============>................] - ETA: 0s - loss: 0.8327\n33/36 [==========================>...] - ETA: 0s - loss: 0.7646\n36/36 [==============================] - 0s 3ms/step - loss: 0.7532\nEpoch:  20\n 1/36 [..............................] - ETA: 0s - loss: 0.5494\n17/36 [=============>................] - ETA: 0s - loss: 0.7507\n33/36 [==========================>...] - ETA: 0s - loss: 0.7516\n36/36 [==============================] - 0s 3ms/step - loss: 0.7359\nEpoch:  21\n 1/36 [..............................] - ETA: 0s - loss: 0.5182\n16/36 [============>.................] - ETA: 0s - loss: 0.7901\n32/36 [=========================>....] - ETA: 0s - loss: 0.7391\n36/36 [==============================] - 0s 3ms/step - loss: 0.7257\nEpoch:  22\n 1/36 [..............................] - ETA: 0s - loss: 0.5004\n17/36 [=============>................] - ETA: 0s - loss: 0.6979\n33/36 [==========================>...] - ETA: 0s - loss: 0.7164\n36/36 [==============================] - 0s 3ms/step - loss: 0.6983\nEpoch:  23\n 1/36 [..............................] - ETA: 0s - loss: 0.4885\n17/36 [=============>................] - ETA: 0s - loss: 0.7953\n33/36 [==========================>...] - ETA: 0s - loss: 0.7302\n36/36 [==============================] - 0s 3ms/step - loss: 0.7581\nEpoch:  24\n 1/36 [..............................] - ETA: 0s - loss: 0.4890\n17/36 [=============>................] - ETA: 0s - loss: 0.7794\n34/36 [===========================>..] - ETA: 0s - loss: 0.7172\n36/36 [==============================] - 0s 3ms/step - loss: 0.7192\nEpoch:  25\n 1/36 [..............................] - ETA: 0s - loss: 0.4568\n17/36 [=============>................] - ETA: 0s - loss: 0.7196\n32/36 [=========================>....] - ETA: 0s - loss: 0.6748\n36/36 [==============================] - 0s 3ms/step - loss: 0.6194\nEpoch:  26\n 1/36 [..............................] - ETA: 0s - loss: 0.4293\n17/36 [=============>................] - ETA: 0s - loss: 0.7296\n33/36 [==========================>...] - ETA: 0s - loss: 0.6640\n36/36 [==============================] - 0s 3ms/step - loss: 0.6451\nEpoch:  27\n 1/36 [..............................] - ETA: 0s - loss: 0.4037\n17/36 [=============>................] - ETA: 0s - loss: 0.7974\n33/36 [==========================>...] - ETA: 0s - loss: 0.6785\n36/36 [==============================] - 0s 3ms/step - loss: 0.6721\nEpoch:  28\n 1/36 [..............................] - ETA: 0s - loss: 0.3729\n17/36 [=============>................] - ETA: 0s - loss: 0.7555\n33/36 [==========================>...] - ETA: 0s - loss: 0.5941\n36/36 [==============================] - 0s 3ms/step - loss: 0.5559\nEpoch:  29\n 1/36 [..............................] - ETA: 0s - loss: 0.3213\n17/36 [=============>................] - ETA: 0s - loss: 0.8689\n33/36 [==========================>...] - ETA: 0s - loss: 0.5752\n36/36 [==============================] - 0s 3ms/step - loss: 0.5554\nEpoch:  30\n 1/36 [..............................] - ETA: 0s - loss: 0.2320\n17/36 [=============>................] - ETA: 0s - loss: 0.5754\n34/36 [===========================>..] - ETA: 0s - loss: 0.7658\n36/36 [==============================] - 0s 3ms/step - loss: 0.7406\nEpoch:  31\n 1/36 [..............................] - ETA: 0s - loss: 0.2426\n18/36 [==============>...............] - ETA: 0s - loss: 0.8147\n34/36 [===========================>..] - ETA: 0s - loss: 0.6970\n36/36 [==============================] - 0s 3ms/step - loss: 0.6872\nEpoch:  32\n 1/36 [..............................] - ETA: 0s - loss: 0.1988\n17/36 [=============>................] - ETA: 0s - loss: 1.0346\n33/36 [==========================>...] - ETA: 0s - loss: 0.8468\n36/36 [==============================] - 0s 3ms/step - loss: 0.8704\nEpoch:  33\n 1/36 [..............................] - ETA: 0s - loss: 0.1989\n16/36 [============>.................] - ETA: 0s - loss: 0.7587\n32/36 [=========================>....] - ETA: 0s - loss: 0.8244\n36/36 [==============================] - 0s 3ms/step - loss: 0.9096\nEpoch:  34\n 1/36 [..............................] - ETA: 0s - loss: 0.1415\n17/36 [=============>................] - ETA: 0s - loss: 0.3925\n33/36 [==========================>...] - ETA: 0s - loss: 0.7331\n36/36 [==============================] - 0s 3ms/step - loss: 0.7041\nEpoch:  35\n 1/36 [..............................] - ETA: 0s - loss: 0.2047\n17/36 [=============>................] - ETA: 0s - loss: 0.6671\n32/36 [=========================>....] - ETA: 0s - loss: 0.9414\n36/36 [==============================] - 0s 3ms/step - loss: 0.9982\nEpoch:  36\n 1/36 [..............................] - ETA: 0s - loss: 0.2246\n17/36 [=============>................] - ETA: 0s - loss: 0.6411\n33/36 [==========================>...] - ETA: 0s - loss: 0.7844\n36/36 [==============================] - 0s 3ms/step - loss: 0.8466\nEpoch:  37\n 1/36 [..............................] - ETA: 0s - loss: 0.2275\n18/36 [==============>...............] - ETA: 0s - loss: 0.6330\n35/36 [============================>.] - ETA: 0s - loss: 0.8217\n36/36 [==============================] - 0s 3ms/step - loss: 0.8370\nEpoch:  38\n 1/36 [..............................] - ETA: 0s - loss: 0.2047\n17/36 [=============>................] - ETA: 0s - loss: 0.6594\n32/36 [=========================>....] - ETA: 0s - loss: 0.7459\n36/36 [==============================] - 0s 3ms/step - loss: 0.8321\nEpoch:  39\n 1/36 [..............................] - ETA: 0s - loss: 0.1733\n17/36 [=============>................] - ETA: 0s - loss: 0.6443\n34/36 [===========================>..] - ETA: 0s - loss: 0.6580\n36/36 [==============================] - 0s 3ms/step - loss: 0.6522\nEpoch:  40\n 1/36 [..............................] - ETA: 0s - loss: 0.1142\n17/36 [=============>................] - ETA: 0s - loss: 0.7031\n32/36 [=========================>....] - ETA: 0s - loss: 0.7977\n36/36 [==============================] - 0s 3ms/step - loss: 0.8732\nEpoch:  41\n 1/36 [..............................] - ETA: 0s - loss: 0.0621\n17/36 [=============>................] - ETA: 0s - loss: 0.6803\n34/36 [===========================>..] - ETA: 0s - loss: 0.7751\n36/36 [==============================] - 0s 3ms/step - loss: 0.8093\nEpoch:  42\n 1/36 [..............................] - ETA: 0s - loss: 0.0195\n16/36 [============>.................] - ETA: 0s - loss: 0.6962\n32/36 [=========================>....] - ETA: 0s - loss: 0.7188\n36/36 [==============================] - 0s 3ms/step - loss: 0.7990\nEpoch:  43\n 1/36 [..............................] - ETA: 0s - loss: 0.0544\n18/36 [==============>...............] - ETA: 0s - loss: 0.5680\n34/36 [===========================>..] - ETA: 0s - loss: 0.8015\n36/36 [==============================] - 0s 3ms/step - loss: 0.7780\nEpoch:  44\n 1/36 [..............................] - ETA: 0s - loss: 0.0039\n16/36 [============>.................] - ETA: 0s - loss: 0.5144\n32/36 [=========================>....] - ETA: 0s - loss: 0.7611\n36/36 [==============================] - 0s 3ms/step - loss: 0.7174\nEpoch:  45\n 1/36 [..............................] - ETA: 0s - loss: 0.1372\n17/36 [=============>................] - ETA: 0s - loss: 0.5956\n34/36 [===========================>..] - ETA: 0s - loss: 0.7304\n36/36 [==============================] - 0s 3ms/step - loss: 0.7017\nEpoch:  46\n 1/36 [..............................] - ETA: 0s - loss: 0.1300\n14/36 [==========>...................] - ETA: 0s - loss: 0.7374\n31/36 [========================>.....] - ETA: 0s - loss: 0.6977\n36/36 [==============================] - 0s 4ms/step - loss: 0.6134\nEpoch:  47\n 1/36 [..............................] - ETA: 0s - loss: 0.0946\n16/36 [============>.................] - ETA: 0s - loss: 0.6078\n32/36 [=========================>....] - ETA: 0s - loss: 0.6501\n36/36 [==============================] - 0s 3ms/step - loss: 0.6575\nEpoch:  48\n 1/36 [..............................] - ETA: 0s - loss: 0.0373\n17/36 [=============>................] - ETA: 0s - loss: 0.6315\n33/36 [==========================>...] - ETA: 0s - loss: 0.6516\n36/36 [==============================] - 0s 3ms/step - loss: 0.6352\nEpoch:  49\n 1/36 [..............................] - ETA: 0s - loss: 0.0461\n16/36 [============>.................] - ETA: 0s - loss: 0.5675\n32/36 [=========================>....] - ETA: 0s - loss: 0.6293\n36/36 [==============================] - 0s 3ms/step - loss: 0.5749\nEpoch:  50\n 1/12 [=>............................] - ETA: 8s\n12/12 [==============================] - 1s 2ms/step\n```\n:::\n:::\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-28_75b0582a88df80c52ee3ae3aa1e85efc'}\n\n```{.r .cell-code}\nsample_predictions_lstm_tbl\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# Rolling origin forecast resampling \n# A tibble: 3 × 3\n  splits          id     predict            \n  <list>          <chr>  <list>             \n1 <split [48/12]> Slice1 <tbl_time [72 × 3]>\n2 <split [48/12]> Slice2 <tbl_time [72 × 3]>\n3 <split [48/12]> Slice3 <tbl_time [72 × 3]>\n```\n:::\n:::\n\n\n### Assessing The Backtested Performance\n\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-29_2cbe91aee6ebfc94eef391a61a7e730f'}\n\n```{.r .cell-code}\nsample_rmse_tbl <- sample_predictions_lstm_tbl %>%\n    mutate(rmse = map_df(predict, calc_rmse)) %>%\n    select(id, rmse) \n\nsample_rmse_tbl\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 2\n  id     rmse$.estimate\n  <chr>           <dbl>\n1 Slice1           2.60\n2 Slice2          15.6 \n3 Slice3          24.9 \n```\n:::\n:::\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-30_6e9136c2929aefe62a6d99e921ff202f'}\n\n```{.r .cell-code}\nsample_rmse_tbl %>%\n    ggplot(aes(rmse$.estimate)) +\n    geom_histogram(aes(y = ..density..), fill = palette_light()[[1]], bins = 16) +\n    geom_density(fill = palette_light()[[1]], alpha = 0.5) +\n    theme_tq() +\n    ggtitle(\"Histogram of RMSE\")\n```\n\n::: {.cell-output-display}\n![](modelo_sltm_files/figure-html/unnamed-chunk-30-1.png){width=1440}\n:::\n:::\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-31_4638774763955ce49112e086357c87a6'}\n\n```{.r .cell-code}\nsample_rmse_tbl$rmse %>%\n    summarize(\n        mean_rmse = mean(.estimate),\n        sd_rmse   = sd(.estimate)\n    )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 2\n  mean_rmse sd_rmse\n      <dbl>   <dbl>\n1      14.4    11.2\n```\n:::\n:::\n\n\nVisualizing The Backtest Results\n\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-32_f4874b5a278536e473389ca466ba88f7'}\n\n```{.r .cell-code}\nplot_predictions <- function(sampling_tbl, predictions_col, \n                             ncol = 3, alpha = 1, size = 2, base_size = 14,\n                             title = \"Backtested Predictions\") {\n    \n    predictions_col_expr <- enquo(predictions_col)\n    \n    # Map plot_split() to sampling_tbl\n    sampling_tbl_with_plots <- sampling_tbl %>%\n        mutate(gg_plots = map2(!! predictions_col_expr, id, \n                               .f        = plot_prediction, \n                               alpha     = alpha, \n                               size      = size, \n                               base_size = base_size)) \n    \n    # Make plots with cowplot\n    plot_list <- sampling_tbl_with_plots$gg_plots \n    \n    p_temp <- plot_list[[1]] + theme(legend.position = \"bottom\")\n    legend <- get_legend(p_temp)\n    \n    p_body  <- plot_grid(plotlist = plot_list, ncol = ncol)\n    \n    \n    \n    p_title <- ggdraw() + \n        draw_label(title, size = 18, fontface = \"bold\", colour = palette_light()[[1]])\n    \n    g <- plot_grid(p_title, p_body, legend, ncol = 1, rel_heights = c(0.05, 1, 0.05))\n    \n    return(g)\n    \n}\n```\n:::\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-33_0172eec3c3506dfa6396b4d7cbc702cd'}\n\n```{.r .cell-code}\nsample_predictions_lstm_tbl %>%\n    plot_predictions(predictions_col = predict, alpha = 0.5, size = 1, base_size = 10,\n                     title = \"Keras Stateful LSTM: Backtested Predictions\")\n```\n\n::: {.cell-output-display}\n![](modelo_sltm_files/figure-html/unnamed-chunk-33-1.png){width=1440}\n:::\n:::\n\n\n### Predicting The Next 10 Years\n\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-34_0498861ce729040b974a563ad5a04876'}\n\n```{.r .cell-code}\npredict_keras_lstm_future <- function(data, epochs = 300, ...) {\n    \n    lstm_prediction <- function(data, epochs, ...) {\n        \n        # 5.1.2 Data Setup (MODIFIED)\n        df <- data\n        \n        # 5.1.3 Preprocessing\n        rec_obj <- recipe(value ~ ., df) %>%\n            step_sqrt(value) %>%\n            step_center(value) %>%\n            step_scale(value) %>%\n            prep()\n        \n        df_processed_tbl <- bake(rec_obj, df)\n        \n        center_history <- rec_obj$steps[[2]]$means[\"value\"]\n        scale_history  <- rec_obj$steps[[3]]$sds[\"value\"]\n        \n        # 5.1.4 LSTM Plan\n        lag_setting  <- 12 # = nrow(df_tst)\n        batch_size   <- 1\n        train_length <- 12*3\n        tsteps       <- 1\n        epochs       <- epochs\n        \n        # 5.1.5 Train Setup (MODIFIED)\n        lag_train_tbl <- df_processed_tbl %>%\n            mutate(value_lag = lag(value, n = lag_setting)) %>%\n            filter(!is.na(value_lag)) %>%\n            tail(train_length)\n        \n        x_train_vec <- lag_train_tbl$value_lag\n        x_train_arr <- array(data = x_train_vec, dim = c(length(x_train_vec), 1, 1))\n        \n        y_train_vec <- lag_train_tbl$value\n        y_train_arr <- array(data = y_train_vec, dim = c(length(y_train_vec), 1))\n        \n        x_test_vec <- y_train_vec %>% tail(lag_setting)\n        x_test_arr <- array(data = x_test_vec, dim = c(length(x_test_vec), 1, 1))\n                \n        # 5.1.6 LSTM Model\n        model <- keras_model_sequential()\n\n        model %>%\n            layer_lstm(units            = 50, \n                       input_shape      = c(tsteps, 1), \n                       batch_size       = batch_size,\n                       return_sequences = TRUE, \n                       stateful         = TRUE) %>% \n            layer_lstm(units            = 50, \n                       return_sequences = FALSE, \n                       stateful         = TRUE) %>% \n            layer_dense(units = 1)\n        \n        model %>% \n            compile(loss = 'mae', optimizer = 'adam')\n        \n        # 5.1.7 Fitting LSTM\n        for (i in 1:epochs) {\n            model %>% fit(x          = x_train_arr, \n                          y          = y_train_arr, \n                          batch_size = batch_size,\n                          epochs     = 1, \n                          verbose    = 1, \n                          shuffle    = FALSE)\n            \n            model %>% reset_states()\n            cat(\"Epoch: \", i)\n            \n        }\n        \n        # 5.1.8 Predict and Return Tidy Data (MODIFIED)\n        # Make Predictions\n        pred_out <- model %>% \n            predict(x_test_arr, batch_size = batch_size) %>%\n            .[,1] \n        \n        # Make future index using tk_make_future_timeseries()\n        idx <- data %>%\n            tk_index() %>%\n            tk_make_future_timeseries(length_out = lag_setting)\n        \n        # Retransform values\n        pred_tbl <- tibble(\n            index   = idx,\n            value   = (pred_out * scale_history + center_history)^2\n        )\n        \n        # Combine actual data with predictions\n        tbl_1 <- df %>%\n            add_column(key = \"actual\")\n\n        tbl_3 <- pred_tbl %>%\n            add_column(key = \"predict\")\n\n        # Create time_bind_rows() to solve dplyr issue\n        time_bind_rows <- function(data_1, data_2, index) {\n            index_expr <- enquo(index)\n            bind_rows(data_1, data_2) %>%\n                as_tbl_time(index = !! index_expr)\n        }\n\n        ret <- list(tbl_1, tbl_3) %>%\n            reduce(time_bind_rows, index = index) %>%\n            arrange(key, index) %>%\n            mutate(key = as_factor(key))\n\n        return(ret)\n        \n    }\n    \n    safe_lstm <- possibly(lstm_prediction, otherwise = NA)\n    \n    safe_lstm(data, epochs, ...)\n    \n}\n```\n:::\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-35_ce96c8508f34e7635cfa52ec37e64a7c'}\n\n```{.r .cell-code}\nfuture_gold_ts_tbl <- predict_keras_lstm_future(gold_mean, epochs = 300)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n 1/36 [..............................] - ETA: 2:00 - loss: 1.5409\n17/36 [=============>................] - ETA: 0s - loss: 0.8848  \n33/36 [==========================>...] - ETA: 0s - loss: 0.8329\n36/36 [==============================] - 4s 3ms/step - loss: 0.7856\nEpoch:  1\n 1/36 [..............................] - ETA: 0s - loss: 1.4715\n17/36 [=============>................] - ETA: 0s - loss: 0.6275\n33/36 [==========================>...] - ETA: 0s - loss: 0.5144\n36/36 [==============================] - 0s 3ms/step - loss: 0.5007\nEpoch:  2\n 1/36 [..............................] - ETA: 0s - loss: 1.4297\n17/36 [=============>................] - ETA: 0s - loss: 0.6316\n33/36 [==========================>...] - ETA: 0s - loss: 0.5545\n36/36 [==============================] - 0s 3ms/step - loss: 0.5638\nEpoch:  3\n 1/36 [..............................] - ETA: 0s - loss: 1.4154\n16/36 [============>.................] - ETA: 0s - loss: 0.5522\n32/36 [=========================>....] - ETA: 0s - loss: 0.4461\n36/36 [==============================] - 0s 3ms/step - loss: 0.4206\nEpoch:  4\n 1/36 [..............................] - ETA: 0s - loss: 1.3582\n17/36 [=============>................] - ETA: 0s - loss: 0.5188\n33/36 [==========================>...] - ETA: 0s - loss: 0.4561\n36/36 [==============================] - 0s 3ms/step - loss: 0.4538\nEpoch:  5\n 1/36 [..............................] - ETA: 0s - loss: 1.3433\n16/36 [============>.................] - ETA: 0s - loss: 0.4306\n32/36 [=========================>....] - ETA: 0s - loss: 0.3802\n36/36 [==============================] - 0s 3ms/step - loss: 0.3850\nEpoch:  6\n 1/36 [..............................] - ETA: 0s - loss: 1.3144\n17/36 [=============>................] - ETA: 0s - loss: 0.3556\n32/36 [=========================>....] - ETA: 0s - loss: 0.3484\n36/36 [==============================] - 0s 3ms/step - loss: 0.3559\nEpoch:  7\n 1/36 [..............................] - ETA: 0s - loss: 1.2928\n17/36 [=============>................] - ETA: 0s - loss: 0.3348\n33/36 [==========================>...] - ETA: 0s - loss: 0.3363\n36/36 [==============================] - 0s 3ms/step - loss: 0.3399\nEpoch:  8\n 1/36 [..............................] - ETA: 0s - loss: 1.2721\n16/36 [============>.................] - ETA: 0s - loss: 0.3567\n33/36 [==========================>...] - ETA: 0s - loss: 0.3397\n36/36 [==============================] - 0s 3ms/step - loss: 0.3452\nEpoch:  9\n 1/36 [..............................] - ETA: 0s - loss: 1.2557\n17/36 [=============>................] - ETA: 0s - loss: 0.3153\n33/36 [==========================>...] - ETA: 0s - loss: 0.3258\n36/36 [==============================] - 0s 3ms/step - loss: 0.3302\nEpoch:  10\n 1/36 [..............................] - ETA: 0s - loss: 1.2317\n17/36 [=============>................] - ETA: 0s - loss: 0.3171\n33/36 [==========================>...] - ETA: 0s - loss: 0.3287\n36/36 [==============================] - 0s 3ms/step - loss: 0.3344\nEpoch:  11\n 1/36 [..............................] - ETA: 0s - loss: 1.2119\n17/36 [=============>................] - ETA: 0s - loss: 0.2980\n32/36 [=========================>....] - ETA: 0s - loss: 0.3131\n36/36 [==============================] - 0s 3ms/step - loss: 0.3201\nEpoch:  12\n 1/36 [..............................] - ETA: 0s - loss: 1.1835\n17/36 [=============>................] - ETA: 0s - loss: 0.2962\n32/36 [=========================>....] - ETA: 0s - loss: 0.3125\n36/36 [==============================] - 0s 3ms/step - loss: 0.3218\nEpoch:  13\n 1/36 [..............................] - ETA: 0s - loss: 1.1617\n17/36 [=============>................] - ETA: 0s - loss: 0.2776\n34/36 [===========================>..] - ETA: 0s - loss: 0.3071\n36/36 [==============================] - 0s 3ms/step - loss: 0.3078\nEpoch:  14\n 1/36 [..............................] - ETA: 0s - loss: 1.1294\n17/36 [=============>................] - ETA: 0s - loss: 0.2742\n33/36 [==========================>...] - ETA: 0s - loss: 0.3018\n36/36 [==============================] - 0s 3ms/step - loss: 0.3060\nEpoch:  15\n 1/36 [..............................] - ETA: 0s - loss: 1.1065\n18/36 [==============>...............] - ETA: 0s - loss: 0.2717\n35/36 [============================>.] - ETA: 0s - loss: 0.3008\n36/36 [==============================] - 0s 3ms/step - loss: 0.3023\nEpoch:  16\n 1/36 [..............................] - ETA: 0s - loss: 1.0814\n18/36 [==============>...............] - ETA: 0s - loss: 0.2645\n34/36 [===========================>..] - ETA: 0s - loss: 0.2973\n36/36 [==============================] - 0s 3ms/step - loss: 0.2990\nEpoch:  17\n 1/36 [..............................] - ETA: 0s - loss: 1.0543\n17/36 [=============>................] - ETA: 0s - loss: 0.2488\n33/36 [==========================>...] - ETA: 0s - loss: 0.2901\n36/36 [==============================] - 0s 3ms/step - loss: 0.2961\nEpoch:  18\n 1/36 [..............................] - ETA: 0s - loss: 1.0249\n17/36 [=============>................] - ETA: 0s - loss: 0.2413\n32/36 [=========================>....] - ETA: 0s - loss: 0.2830\n36/36 [==============================] - 0s 3ms/step - loss: 0.2934\nEpoch:  19\n 1/36 [..............................] - ETA: 0s - loss: 0.9936\n17/36 [=============>................] - ETA: 0s - loss: 0.2343\n32/36 [=========================>....] - ETA: 0s - loss: 0.2787\n36/36 [==============================] - 0s 3ms/step - loss: 0.2891\nEpoch:  20\n 1/36 [..............................] - ETA: 0s - loss: 0.9598\n18/36 [==============>...............] - ETA: 0s - loss: 0.2333\n34/36 [===========================>..] - ETA: 0s - loss: 0.3035\n36/36 [==============================] - 0s 3ms/step - loss: 0.3090\nEpoch:  21\n 1/36 [..............................] - ETA: 0s - loss: 0.9158\n17/36 [=============>................] - ETA: 0s - loss: 0.2351\n33/36 [==========================>...] - ETA: 0s - loss: 0.2852\n36/36 [==============================] - 0s 3ms/step - loss: 0.2942\nEpoch:  22\n 1/36 [..............................] - ETA: 0s - loss: 0.8915\n17/36 [=============>................] - ETA: 0s - loss: 0.1969\n33/36 [==========================>...] - ETA: 0s - loss: 0.2675\n36/36 [==============================] - 0s 3ms/step - loss: 0.2785\nEpoch:  23\n 1/36 [..............................] - ETA: 0s - loss: 0.8509\n17/36 [=============>................] - ETA: 0s - loss: 0.1880\n33/36 [==========================>...] - ETA: 0s - loss: 0.2634\n36/36 [==============================] - 0s 3ms/step - loss: 0.2748\nEpoch:  24\n 1/36 [..............................] - ETA: 0s - loss: 0.8066\n17/36 [=============>................] - ETA: 0s - loss: 0.1789\n33/36 [==========================>...] - ETA: 0s - loss: 0.2588\n36/36 [==============================] - 0s 3ms/step - loss: 0.2705\nEpoch:  25\n 1/36 [..............................] - ETA: 0s - loss: 0.7590\n17/36 [=============>................] - ETA: 0s - loss: 0.1687\n33/36 [==========================>...] - ETA: 0s - loss: 0.2533\n36/36 [==============================] - 0s 3ms/step - loss: 0.2651\nEpoch:  26\n 1/36 [..............................] - ETA: 0s - loss: 0.7069\n17/36 [=============>................] - ETA: 0s - loss: 0.1512\n33/36 [==========================>...] - ETA: 0s - loss: 0.2417\n36/36 [==============================] - 0s 3ms/step - loss: 0.2519\nEpoch:  27\n 1/36 [..............................] - ETA: 0s - loss: 0.6650\n18/36 [==============>...............] - ETA: 0s - loss: 0.1758\n34/36 [===========================>..] - ETA: 0s - loss: 0.2500\n36/36 [==============================] - 0s 3ms/step - loss: 0.2537\nEpoch:  28\n 1/36 [..............................] - ETA: 0s - loss: 0.6035\n17/36 [=============>................] - ETA: 0s - loss: 0.1433\n33/36 [==========================>...] - ETA: 0s - loss: 0.2342\n36/36 [==============================] - 0s 3ms/step - loss: 0.2421\nEpoch:  29\n 1/36 [..............................] - ETA: 0s - loss: 0.6087\n16/36 [============>.................] - ETA: 0s - loss: 0.1638\n32/36 [=========================>....] - ETA: 0s - loss: 0.2413\n36/36 [==============================] - 0s 3ms/step - loss: 0.2598\nEpoch:  30\n 1/36 [..............................] - ETA: 0s - loss: 0.5576\n17/36 [=============>................] - ETA: 0s - loss: 0.1232\n33/36 [==========================>...] - ETA: 0s - loss: 0.2168\n36/36 [==============================] - 0s 3ms/step - loss: 0.2171\nEpoch:  31\n 1/36 [..............................] - ETA: 0s - loss: 0.4852\n16/36 [============>.................] - ETA: 0s - loss: 0.1740\n32/36 [=========================>....] - ETA: 0s - loss: 0.2436\n36/36 [==============================] - 0s 3ms/step - loss: 0.2491\nEpoch:  32\n 1/36 [..............................] - ETA: 0s - loss: 0.5447\n17/36 [=============>................] - ETA: 0s - loss: 0.1510\n32/36 [=========================>....] - ETA: 0s - loss: 0.2323\n36/36 [==============================] - 0s 3ms/step - loss: 0.2357\nEpoch:  33\n 1/36 [..............................] - ETA: 0s - loss: 0.4692\n17/36 [=============>................] - ETA: 0s - loss: 0.1245\n33/36 [==========================>...] - ETA: 0s - loss: 0.2208\n36/36 [==============================] - 0s 3ms/step - loss: 0.2217\nEpoch:  34\n 1/36 [..............................] - ETA: 0s - loss: 0.3938\n17/36 [=============>................] - ETA: 0s - loss: 0.2067\n33/36 [==========================>...] - ETA: 0s - loss: 0.2755\n36/36 [==============================] - 0s 3ms/step - loss: 0.2785\nEpoch:  35\n 1/36 [..............................] - ETA: 0s - loss: 0.4861\n17/36 [=============>................] - ETA: 0s - loss: 0.1641\n32/36 [=========================>....] - ETA: 0s - loss: 0.2403\n36/36 [==============================] - 0s 3ms/step - loss: 0.2401\nEpoch:  36\n 1/36 [..............................] - ETA: 0s - loss: 0.3228\n18/36 [==============>...............] - ETA: 0s - loss: 0.2095\n34/36 [===========================>..] - ETA: 0s - loss: 0.2697\n36/36 [==============================] - 0s 3ms/step - loss: 0.2743\nEpoch:  37\n 1/36 [..............................] - ETA: 0s - loss: 0.3780\n16/36 [============>.................] - ETA: 0s - loss: 0.1483\n32/36 [=========================>....] - ETA: 0s - loss: 0.2301\n36/36 [==============================] - 0s 3ms/step - loss: 0.2449\nEpoch:  38\n 1/36 [..............................] - ETA: 0s - loss: 0.3149\n18/36 [==============>...............] - ETA: 0s - loss: 0.1441\n34/36 [===========================>..] - ETA: 0s - loss: 0.2296\n36/36 [==============================] - 0s 3ms/step - loss: 0.2329\nEpoch:  39\n 1/36 [..............................] - ETA: 0s - loss: 0.2753\n17/36 [=============>................] - ETA: 0s - loss: 0.1367\n33/36 [==========================>...] - ETA: 0s - loss: 0.2293\n36/36 [==============================] - 0s 3ms/step - loss: 0.2368\nEpoch:  40\n 1/36 [..............................] - ETA: 0s - loss: 0.2480\n17/36 [=============>................] - ETA: 0s - loss: 0.1217\n33/36 [==========================>...] - ETA: 0s - loss: 0.2198\n36/36 [==============================] - 0s 3ms/step - loss: 0.2257\nEpoch:  41\n 1/36 [..............................] - ETA: 0s - loss: 0.2056\n17/36 [=============>................] - ETA: 0s - loss: 0.1177\n33/36 [==========================>...] - ETA: 0s - loss: 0.2165\n36/36 [==============================] - 0s 3ms/step - loss: 0.2210\nEpoch:  42\n 1/36 [..............................] - ETA: 0s - loss: 0.1968\n17/36 [=============>................] - ETA: 0s - loss: 0.1282\n33/36 [==========================>...] - ETA: 0s - loss: 0.2209\n36/36 [==============================] - 0s 3ms/step - loss: 0.2221\nEpoch:  43\n 1/36 [..............................] - ETA: 0s - loss: 0.1159\n17/36 [=============>................] - ETA: 0s - loss: 0.1028\n34/36 [===========================>..] - ETA: 0s - loss: 0.2126\n36/36 [==============================] - 0s 3ms/step - loss: 0.2114\nEpoch:  44\n 1/36 [..............................] - ETA: 0s - loss: 0.0685\n17/36 [=============>................] - ETA: 0s - loss: 0.1887\n33/36 [==========================>...] - ETA: 0s - loss: 0.2629\n36/36 [==============================] - 0s 3ms/step - loss: 0.2661\nEpoch:  45\n 1/36 [..............................] - ETA: 0s - loss: 0.1374\n14/36 [==========>...................] - ETA: 0s - loss: 0.1302\n30/36 [========================>.....] - ETA: 0s - loss: 0.1971\n36/36 [==============================] - 0s 4ms/step - loss: 0.2261\nEpoch:  46\n 1/36 [..............................] - ETA: 0s - loss: 0.0310\n18/36 [==============>...............] - ETA: 0s - loss: 0.1639\n34/36 [===========================>..] - ETA: 0s - loss: 0.2395\n36/36 [==============================] - 0s 3ms/step - loss: 0.2421\nEpoch:  47\n 1/36 [..............................] - ETA: 0s - loss: 0.1023\n17/36 [=============>................] - ETA: 0s - loss: 0.1267\n34/36 [===========================>..] - ETA: 0s - loss: 0.2225\n36/36 [==============================] - 0s 3ms/step - loss: 0.2222\nEpoch:  48\n 1/36 [..............................] - ETA: 0s - loss: 0.0448\n17/36 [=============>................] - ETA: 0s - loss: 0.0946\n34/36 [===========================>..] - ETA: 0s - loss: 0.2078\n36/36 [==============================] - 0s 3ms/step - loss: 0.2082\nEpoch:  49\n 1/36 [..............................] - ETA: 0s - loss: 0.1060\n17/36 [=============>................] - ETA: 0s - loss: 0.1609\n31/36 [========================>.....] - ETA: 0s - loss: 0.2255\n36/36 [==============================] - 0s 4ms/step - loss: 0.2337\nEpoch:  50\n 1/36 [..............................] - ETA: 0s - loss: 0.0495\n18/36 [==============>...............] - ETA: 0s - loss: 0.1174\n33/36 [==========================>...] - ETA: 0s - loss: 0.2074\n36/36 [==============================] - 0s 3ms/step - loss: 0.2118\nEpoch:  51\n 1/36 [..............................] - ETA: 0s - loss: 0.0684\n15/36 [===========>..................] - ETA: 0s - loss: 0.1307\n25/36 [===================>..........] - ETA: 0s - loss: 0.2016\n35/36 [============================>.] - ETA: 0s - loss: 0.2128\n36/36 [==============================] - 0s 5ms/step - loss: 0.2109\nEpoch:  52\n 1/36 [..............................] - ETA: 0s - loss: 0.0577\n18/36 [==============>...............] - ETA: 0s - loss: 0.1130\n35/36 [============================>.] - ETA: 0s - loss: 0.1984\n36/36 [==============================] - 0s 3ms/step - loss: 0.1972\nEpoch:  53\n 1/36 [..............................] - ETA: 0s - loss: 0.0913\n17/36 [=============>................] - ETA: 0s - loss: 0.1355\n33/36 [==========================>...] - ETA: 0s - loss: 0.2148\n36/36 [==============================] - 0s 3ms/step - loss: 0.2043\nEpoch:  54\n 1/36 [..............................] - ETA: 0s - loss: 0.0441\n16/36 [============>.................] - ETA: 0s - loss: 0.0875\n33/36 [==========================>...] - ETA: 0s - loss: 0.1949\n36/36 [==============================] - 0s 3ms/step - loss: 0.1889\nEpoch:  55\n 1/36 [..............................] - ETA: 0s - loss: 0.0178\n15/36 [===========>..................] - ETA: 0s - loss: 0.0898\n31/36 [========================>.....] - ETA: 0s - loss: 0.1895\n36/36 [==============================] - 0s 3ms/step - loss: 0.1814\nEpoch:  56\n 1/36 [..............................] - ETA: 0s - loss: 0.0342\n18/36 [==============>...............] - ETA: 0s - loss: 0.1094\n35/36 [============================>.] - ETA: 0s - loss: 0.1895\n36/36 [==============================] - 0s 3ms/step - loss: 0.1854\nEpoch:  57\n 1/36 [..............................] - ETA: 0s - loss: 0.0715\n17/36 [=============>................] - ETA: 0s - loss: 0.1149\n33/36 [==========================>...] - ETA: 0s - loss: 0.2186\n36/36 [==============================] - 0s 3ms/step - loss: 0.2226\nEpoch:  58\n 1/36 [..............................] - ETA: 0s - loss: 0.1127\n17/36 [=============>................] - ETA: 0s - loss: 0.1688\n32/36 [=========================>....] - ETA: 0s - loss: 0.2490\n36/36 [==============================] - 0s 3ms/step - loss: 0.2721\nEpoch:  59\n 1/36 [..............................] - ETA: 0s - loss: 0.0523\n18/36 [==============>...............] - ETA: 0s - loss: 0.1261\n35/36 [============================>.] - ETA: 0s - loss: 0.2306\n36/36 [==============================] - 0s 3ms/step - loss: 0.2351\nEpoch:  60\n 1/36 [..............................] - ETA: 0s - loss: 0.0351\n17/36 [=============>................] - ETA: 0s - loss: 0.1008\n34/36 [===========================>..] - ETA: 0s - loss: 0.2226\n36/36 [==============================] - 0s 3ms/step - loss: 0.2295\nEpoch:  61\n 1/36 [..............................] - ETA: 0s - loss: 0.0293\n17/36 [=============>................] - ETA: 0s - loss: 0.1176\n33/36 [==========================>...] - ETA: 0s - loss: 0.2260\n36/36 [==============================] - 0s 3ms/step - loss: 0.2407\nEpoch:  62\n 1/36 [..............................] - ETA: 0s - loss: 0.0098\n17/36 [=============>................] - ETA: 0s - loss: 0.1016\n33/36 [==========================>...] - ETA: 0s - loss: 0.2185\n36/36 [==============================] - 0s 3ms/step - loss: 0.2337\nEpoch:  63\n 1/36 [..............................] - ETA: 0s - loss: 0.0270\n17/36 [=============>................] - ETA: 0s - loss: 0.1062\n33/36 [==========================>...] - ETA: 0s - loss: 0.2185\n36/36 [==============================] - 0s 3ms/step - loss: 0.2320\nEpoch:  64\n 1/36 [..............................] - ETA: 0s - loss: 0.0335\n16/36 [============>.................] - ETA: 0s - loss: 0.1082\n31/36 [========================>.....] - ETA: 0s - loss: 0.2010\n36/36 [==============================] - 0s 3ms/step - loss: 0.2323\nEpoch:  65\n 1/36 [..............................] - ETA: 0s - loss: 0.0031\n17/36 [=============>................] - ETA: 0s - loss: 0.1119\n33/36 [==========================>...] - ETA: 0s - loss: 0.2183\n36/36 [==============================] - 0s 3ms/step - loss: 0.2295\nEpoch:  66\n 1/36 [..............................] - ETA: 0s - loss: 0.0601\n17/36 [=============>................] - ETA: 0s - loss: 0.1121\n34/36 [===========================>..] - ETA: 0s - loss: 0.2276\n36/36 [==============================] - 0s 3ms/step - loss: 0.2346\nEpoch:  67\n 1/36 [..............................] - ETA: 0s - loss: 0.0256\n16/36 [============>.................] - ETA: 0s - loss: 0.1181\n32/36 [=========================>....] - ETA: 0s - loss: 0.2167\n36/36 [==============================] - 0s 3ms/step - loss: 0.2344\nEpoch:  68\n 1/36 [..............................] - ETA: 0s - loss: 0.0485\n17/36 [=============>................] - ETA: 0s - loss: 0.1029\n31/36 [========================>.....] - ETA: 0s - loss: 0.1985\n36/36 [==============================] - 0s 4ms/step - loss: 0.2330\nEpoch:  69\n 1/36 [..............................] - ETA: 0s - loss: 0.0363\n17/36 [=============>................] - ETA: 0s - loss: 0.1178\n33/36 [==========================>...] - ETA: 0s - loss: 0.2195\n36/36 [==============================] - 0s 3ms/step - loss: 0.2292\nEpoch:  70\n 1/36 [..............................] - ETA: 0s - loss: 0.0582\n17/36 [=============>................] - ETA: 0s - loss: 0.1129\n33/36 [==========================>...] - ETA: 0s - loss: 0.2239\n36/36 [==============================] - 0s 3ms/step - loss: 0.2392\nEpoch:  71\n 1/36 [..............................] - ETA: 0s - loss: 0.0468\n18/36 [==============>...............] - ETA: 0s - loss: 0.1313\n35/36 [============================>.] - ETA: 0s - loss: 0.2268\n36/36 [==============================] - 0s 3ms/step - loss: 0.2303\nEpoch:  72\n 1/36 [..............................] - ETA: 0s - loss: 0.0458\n17/36 [=============>................] - ETA: 0s - loss: 0.1083\n34/36 [===========================>..] - ETA: 0s - loss: 0.2251\n36/36 [==============================] - 0s 3ms/step - loss: 0.2321\nEpoch:  73\n 1/36 [..............................] - ETA: 0s - loss: 0.0382\n17/36 [=============>................] - ETA: 0s - loss: 0.1171\n33/36 [==========================>...] - ETA: 0s - loss: 0.2216\n36/36 [==============================] - 0s 3ms/step - loss: 0.2334\nEpoch:  74\n 1/36 [..............................] - ETA: 0s - loss: 0.0365\n17/36 [=============>................] - ETA: 0s - loss: 0.1104\n34/36 [===========================>..] - ETA: 0s - loss: 0.2240\n36/36 [==============================] - 0s 3ms/step - loss: 0.2300\nEpoch:  75\n 1/36 [..............................] - ETA: 0s - loss: 0.0015\n17/36 [=============>................] - ETA: 0s - loss: 0.1044\n33/36 [==========================>...] - ETA: 0s - loss: 0.2162\n36/36 [==============================] - 0s 3ms/step - loss: 0.2291\nEpoch:  76\n 1/36 [..............................] - ETA: 0s - loss: 0.0147\n17/36 [=============>................] - ETA: 0s - loss: 0.1168\n33/36 [==========================>...] - ETA: 0s - loss: 0.2180\n36/36 [==============================] - 0s 3ms/step - loss: 0.2271\nEpoch:  77\n 1/36 [..............................] - ETA: 0s - loss: 0.0111\n17/36 [=============>................] - ETA: 0s - loss: 0.1099\n32/36 [=========================>....] - ETA: 0s - loss: 0.2146\n36/36 [==============================] - 0s 3ms/step - loss: 0.2361\nEpoch:  78\n 1/36 [..............................] - ETA: 0s - loss: 0.0938\n17/36 [=============>................] - ETA: 0s - loss: 0.1170\n33/36 [==========================>...] - ETA: 0s - loss: 0.2200\n36/36 [==============================] - 0s 3ms/step - loss: 0.2303\nEpoch:  79\n 1/36 [..............................] - ETA: 0s - loss: 0.0019\n17/36 [=============>................] - ETA: 0s - loss: 0.1109\n33/36 [==========================>...] - ETA: 0s - loss: 0.2173\n36/36 [==============================] - 0s 3ms/step - loss: 0.2286\nEpoch:  80\n 1/36 [..............................] - ETA: 0s - loss: 0.0181\n18/36 [==============>...............] - ETA: 0s - loss: 0.1298\n34/36 [===========================>..] - ETA: 0s - loss: 0.2235\n36/36 [==============================] - 0s 3ms/step - loss: 0.2289\nEpoch:  81\n 1/36 [..............................] - ETA: 0s - loss: 0.0202\n17/36 [=============>................] - ETA: 0s - loss: 0.1126\n31/36 [========================>.....] - ETA: 0s - loss: 0.2020\n36/36 [==============================] - 0s 3ms/step - loss: 0.2328\nEpoch:  82\n 1/36 [..............................] - ETA: 0s - loss: 0.0240\n16/36 [============>.................] - ETA: 0s - loss: 0.1142\n32/36 [=========================>....] - ETA: 0s - loss: 0.2117\n36/36 [==============================] - 0s 3ms/step - loss: 0.2259\nEpoch:  83\n 1/36 [..............................] - ETA: 0s - loss: 0.0202\n17/36 [=============>................] - ETA: 0s - loss: 0.1125\n33/36 [==========================>...] - ETA: 0s - loss: 0.2186\n36/36 [==============================] - 0s 3ms/step - loss: 0.2301\nEpoch:  84\n 1/36 [..............................] - ETA: 0s - loss: 0.0679\n17/36 [=============>................] - ETA: 0s - loss: 0.1202\n34/36 [===========================>..] - ETA: 0s - loss: 0.2259\n36/36 [==============================] - 0s 3ms/step - loss: 0.2307\nEpoch:  85\n 1/36 [..............................] - ETA: 0s - loss: 0.0095\n17/36 [=============>................] - ETA: 0s - loss: 0.1041\n33/36 [==========================>...] - ETA: 0s - loss: 0.2159\n36/36 [==============================] - 0s 3ms/step - loss: 0.2287\nEpoch:  86\n 1/36 [..............................] - ETA: 0s - loss: 0.0762\n16/36 [============>.................] - ETA: 0s - loss: 0.1223\n32/36 [=========================>....] - ETA: 0s - loss: 0.2135\n36/36 [==============================] - 0s 3ms/step - loss: 0.2249\nEpoch:  87\n 1/36 [..............................] - ETA: 0s - loss: 0.0209\n17/36 [=============>................] - ETA: 0s - loss: 0.1139\n33/36 [==========================>...] - ETA: 0s - loss: 0.2214\n36/36 [==============================] - 0s 3ms/step - loss: 0.2345\nEpoch:  88\n 1/36 [..............................] - ETA: 0s - loss: 0.0843\n17/36 [=============>................] - ETA: 0s - loss: 0.1148\n34/36 [===========================>..] - ETA: 0s - loss: 0.2213\n36/36 [==============================] - 0s 3ms/step - loss: 0.2251\nEpoch:  89\n 1/36 [..............................] - ETA: 0s - loss: 0.0110\n17/36 [=============>................] - ETA: 0s - loss: 0.1092\n33/36 [==========================>...] - ETA: 0s - loss: 0.2158\n36/36 [==============================] - 0s 3ms/step - loss: 0.2262\nEpoch:  90\n 1/36 [..............................] - ETA: 0s - loss: 0.0736\n17/36 [=============>................] - ETA: 0s - loss: 0.1227\n33/36 [==========================>...] - ETA: 0s - loss: 0.2198\n36/36 [==============================] - 0s 3ms/step - loss: 0.2275\nEpoch:  91\n 1/36 [..............................] - ETA: 0s - loss: 0.0071\n16/36 [============>.................] - ETA: 0s - loss: 0.0994\n32/36 [=========================>....] - ETA: 0s - loss: 0.2082\n36/36 [==============================] - 0s 3ms/step - loss: 0.2261\nEpoch:  92\n 1/36 [..............................] - ETA: 0s - loss: 0.0801\n16/36 [============>.................] - ETA: 0s - loss: 0.1186\n32/36 [=========================>....] - ETA: 0s - loss: 0.2127\n36/36 [==============================] - 0s 3ms/step - loss: 0.2259\nEpoch:  93\n 1/36 [..............................] - ETA: 0s - loss: 2.9087e-05\n17/36 [=============>................] - ETA: 0s - loss: 0.0973    \n33/36 [==========================>...] - ETA: 0s - loss: 0.2124\n36/36 [==============================] - 0s 3ms/step - loss: 0.2247\nEpoch:  94\n 1/36 [..............................] - ETA: 0s - loss: 0.0191\n18/36 [==============>...............] - ETA: 0s - loss: 0.1243\n34/36 [===========================>..] - ETA: 0s - loss: 0.2140\n36/36 [==============================] - 0s 3ms/step - loss: 0.2160\nEpoch:  95\n 1/36 [..............................] - ETA: 0s - loss: 0.0149\n18/36 [==============>...............] - ETA: 0s - loss: 0.1265\n34/36 [===========================>..] - ETA: 0s - loss: 0.2165\n36/36 [==============================] - 0s 3ms/step - loss: 0.2191\nEpoch:  96\n 1/36 [..............................] - ETA: 0s - loss: 0.0712\n17/36 [=============>................] - ETA: 0s - loss: 0.1193\n33/36 [==========================>...] - ETA: 0s - loss: 0.2150\n36/36 [==============================] - 0s 3ms/step - loss: 0.2183\nEpoch:  97\n 1/36 [..............................] - ETA: 0s - loss: 0.0120\n17/36 [=============>................] - ETA: 0s - loss: 0.0963\n34/36 [===========================>..] - ETA: 0s - loss: 0.2083\n36/36 [==============================] - 0s 3ms/step - loss: 0.2093\nEpoch:  98\n 1/36 [..............................] - ETA: 0s - loss: 0.0383\n17/36 [=============>................] - ETA: 0s - loss: 0.1402\n33/36 [==========================>...] - ETA: 0s - loss: 0.2296\n36/36 [==============================] - 0s 3ms/step - loss: 0.2332\nEpoch:  99\n 1/36 [..............................] - ETA: 0s - loss: 0.0696\n18/36 [==============>...............] - ETA: 0s - loss: 0.1232\n35/36 [============================>.] - ETA: 0s - loss: 0.2159\n36/36 [==============================] - 0s 3ms/step - loss: 0.2180\nEpoch:  100\n 1/36 [..............................] - ETA: 0s - loss: 0.1008\n16/36 [============>.................] - ETA: 0s - loss: 0.1495\n32/36 [=========================>....] - ETA: 0s - loss: 0.2374\n36/36 [==============================] - 0s 3ms/step - loss: 0.2625\nEpoch:  101\n 1/36 [..............................] - ETA: 0s - loss: 0.0550\n17/36 [=============>................] - ETA: 0s - loss: 0.1035\n33/36 [==========================>...] - ETA: 0s - loss: 0.2142\n36/36 [==============================] - 0s 3ms/step - loss: 0.2245\nEpoch:  102\n 1/36 [..............................] - ETA: 0s - loss: 0.0719\n17/36 [=============>................] - ETA: 0s - loss: 0.1297\n33/36 [==========================>...] - ETA: 0s - loss: 0.2307\n36/36 [==============================] - 0s 3ms/step - loss: 0.2447\nEpoch:  103\n 1/36 [..............................] - ETA: 0s - loss: 0.0322\n17/36 [=============>................] - ETA: 0s - loss: 0.1072\n34/36 [===========================>..] - ETA: 0s - loss: 0.2250\n36/36 [==============================] - 0s 3ms/step - loss: 0.2322\nEpoch:  104\n 1/36 [..............................] - ETA: 0s - loss: 0.0296\n17/36 [=============>................] - ETA: 0s - loss: 0.1083\n33/36 [==========================>...] - ETA: 0s - loss: 0.2188\n36/36 [==============================] - 0s 3ms/step - loss: 0.2321\nEpoch:  105\n 1/36 [..............................] - ETA: 0s - loss: 0.0109\n18/36 [==============>...............] - ETA: 0s - loss: 0.1283\n35/36 [============================>.] - ETA: 0s - loss: 0.2257\n36/36 [==============================] - 0s 3ms/step - loss: 0.2294\nEpoch:  106\n 1/36 [..............................] - ETA: 0s - loss: 0.0554\n17/36 [=============>................] - ETA: 0s - loss: 0.1155\n33/36 [==========================>...] - ETA: 0s - loss: 0.2197\n36/36 [==============================] - 0s 3ms/step - loss: 0.2311\nEpoch:  107\n 1/36 [..............................] - ETA: 0s - loss: 0.0140\n17/36 [=============>................] - ETA: 0s - loss: 0.1046\n33/36 [==========================>...] - ETA: 0s - loss: 0.2170\n36/36 [==============================] - 0s 3ms/step - loss: 0.2309\nEpoch:  108\n 1/36 [..............................] - ETA: 0s - loss: 0.0726\n17/36 [=============>................] - ETA: 0s - loss: 0.1199\n34/36 [===========================>..] - ETA: 0s - loss: 0.2239\n36/36 [==============================] - 0s 3ms/step - loss: 0.2282\nEpoch:  109\n 1/36 [..............................] - ETA: 0s - loss: 0.0230\n17/36 [=============>................] - ETA: 0s - loss: 0.1142\n33/36 [==========================>...] - ETA: 0s - loss: 0.2225\n36/36 [==============================] - 0s 3ms/step - loss: 0.2367\nEpoch:  110\n 1/36 [..............................] - ETA: 0s - loss: 0.0804\n17/36 [=============>................] - ETA: 0s - loss: 0.1160\n33/36 [==========================>...] - ETA: 0s - loss: 0.2187\n36/36 [==============================] - 0s 3ms/step - loss: 0.2290\nEpoch:  111\n 1/36 [..............................] - ETA: 0s - loss: 0.0137\n17/36 [=============>................] - ETA: 0s - loss: 0.1099\n34/36 [===========================>..] - ETA: 0s - loss: 0.2239\n36/36 [==============================] - 0s 3ms/step - loss: 0.2304\nEpoch:  112\n 1/36 [..............................] - ETA: 0s - loss: 0.0705\n18/36 [==============>...............] - ETA: 0s - loss: 0.1319\n35/36 [============================>.] - ETA: 0s - loss: 0.2260\n36/36 [==============================] - 0s 3ms/step - loss: 0.2295\nEpoch:  113\n 1/36 [..............................] - ETA: 0s - loss: 0.0061\n17/36 [=============>................] - ETA: 0s - loss: 0.1147\n33/36 [==========================>...] - ETA: 0s - loss: 0.2201\n36/36 [==============================] - 0s 3ms/step - loss: 0.2324\nEpoch:  114\n 1/36 [..............................] - ETA: 0s - loss: 0.0443\n16/36 [============>.................] - ETA: 0s - loss: 0.1068\n32/36 [=========================>....] - ETA: 0s - loss: 0.2113\n36/36 [==============================] - 0s 3ms/step - loss: 0.2296\nEpoch:  115\n 1/36 [..............................] - ETA: 0s - loss: 0.0021\n17/36 [=============>................] - ETA: 0s - loss: 0.1047\n33/36 [==========================>...] - ETA: 0s - loss: 0.2151\n36/36 [==============================] - 0s 3ms/step - loss: 0.2276\nEpoch:  116\n 1/36 [..............................] - ETA: 0s - loss: 0.0405\n17/36 [=============>................] - ETA: 0s - loss: 0.1111\n32/36 [=========================>....] - ETA: 0s - loss: 0.2111\n36/36 [==============================] - 0s 3ms/step - loss: 0.2270\nEpoch:  117\n 1/36 [..............................] - ETA: 0s - loss: 0.0282\n18/36 [==============>...............] - ETA: 0s - loss: 0.1261\n35/36 [============================>.] - ETA: 0s - loss: 0.2260\n36/36 [==============================] - 0s 3ms/step - loss: 0.2302\nEpoch:  118\n 1/36 [..............................] - ETA: 0s - loss: 0.0583\n15/36 [===========>..................] - ETA: 0s - loss: 0.1266\n29/36 [=======================>......] - ETA: 0s - loss: 0.1879\n36/36 [==============================] - 0s 4ms/step - loss: 0.2263\nEpoch:  119\n 1/36 [..............................] - ETA: 0s - loss: 0.0396\n14/36 [==========>...................] - ETA: 0s - loss: 0.1242\n28/36 [======================>.......] - ETA: 0s - loss: 0.1872\n36/36 [==============================] - 0s 4ms/step - loss: 0.2365\nEpoch:  120\n 1/36 [..............................] - ETA: 0s - loss: 0.0661\n17/36 [=============>................] - ETA: 0s - loss: 0.1169\n33/36 [==========================>...] - ETA: 0s - loss: 0.2178\n36/36 [==============================] - 0s 3ms/step - loss: 0.2273\nEpoch:  121\n 1/36 [..............................] - ETA: 0s - loss: 0.0300\n17/36 [=============>................] - ETA: 0s - loss: 0.1141\n33/36 [==========================>...] - ETA: 0s - loss: 0.2188\n36/36 [==============================] - 0s 3ms/step - loss: 0.2303\nEpoch:  122\n 1/36 [..............................] - ETA: 0s - loss: 0.0562\n18/36 [==============>...............] - ETA: 0s - loss: 0.1366\n35/36 [============================>.] - ETA: 0s - loss: 0.2271\n36/36 [==============================] - 0s 3ms/step - loss: 0.2303\nEpoch:  123\n 1/36 [..............................] - ETA: 0s - loss: 0.0230\n16/36 [============>.................] - ETA: 0s - loss: 0.1072\n32/36 [=========================>....] - ETA: 0s - loss: 0.2112\n36/36 [==============================] - 0s 3ms/step - loss: 0.2297\nEpoch:  124\n 1/36 [..............................] - ETA: 0s - loss: 0.0637\n17/36 [=============>................] - ETA: 0s - loss: 0.1202\n33/36 [==========================>...] - ETA: 0s - loss: 0.2177\n36/36 [==============================] - 0s 3ms/step - loss: 0.2259\nEpoch:  125\n 1/36 [..............................] - ETA: 0s - loss: 0.0343\n17/36 [=============>................] - ETA: 0s - loss: 0.1184\n33/36 [==========================>...] - ETA: 0s - loss: 0.2228\n36/36 [==============================] - 0s 3ms/step - loss: 0.2358\nEpoch:  126\n 1/36 [..............................] - ETA: 0s - loss: 0.0712\n17/36 [=============>................] - ETA: 0s - loss: 0.1170\n33/36 [==========================>...] - ETA: 0s - loss: 0.2175\n36/36 [==============================] - 0s 3ms/step - loss: 0.2268\nEpoch:  127\n 1/36 [..............................] - ETA: 0s - loss: 0.0251\n18/36 [==============>...............] - ETA: 0s - loss: 0.1316\n35/36 [============================>.] - ETA: 0s - loss: 0.2262\n36/36 [==============================] - 0s 3ms/step - loss: 0.2298\nEpoch:  128\n 1/36 [..............................] - ETA: 0s - loss: 0.0611\n17/36 [=============>................] - ETA: 0s - loss: 0.1165\n33/36 [==========================>...] - ETA: 0s - loss: 0.2178\n36/36 [==============================] - 0s 3ms/step - loss: 0.2277\nEpoch:  129\n 1/36 [..............................] - ETA: 0s - loss: 0.0054\n17/36 [=============>................] - ETA: 0s - loss: 0.1126\n33/36 [==========================>...] - ETA: 0s - loss: 0.2190\n36/36 [==============================] - 0s 3ms/step - loss: 0.2315\nEpoch:  130\n 1/36 [..............................] - ETA: 0s - loss: 0.0546\n15/36 [===========>..................] - ETA: 0s - loss: 0.1226\n31/36 [========================>.....] - ETA: 0s - loss: 0.2014\n36/36 [==============================] - 0s 3ms/step - loss: 0.2246\nEpoch:  131\n 1/36 [..............................] - ETA: 0s - loss: 0.0455\n17/36 [=============>................] - ETA: 0s - loss: 0.1191\n34/36 [===========================>..] - ETA: 0s - loss: 0.2295\n36/36 [==============================] - 0s 3ms/step - loss: 0.2364\nEpoch:  132\n 1/36 [..............................] - ETA: 0s - loss: 0.0626\n17/36 [=============>................] - ETA: 0s - loss: 0.1136\n32/36 [=========================>....] - ETA: 0s - loss: 0.2113\n36/36 [==============================] - 0s 3ms/step - loss: 0.2255\nEpoch:  133\n 1/36 [..............................] - ETA: 0s - loss: 0.0355\n17/36 [=============>................] - ETA: 0s - loss: 0.1156\n33/36 [==========================>...] - ETA: 0s - loss: 0.2193\n36/36 [==============================] - 0s 3ms/step - loss: 0.2307\nEpoch:  134\n 1/36 [..............................] - ETA: 0s - loss: 0.0529\n17/36 [=============>................] - ETA: 0s - loss: 0.1140\n33/36 [==========================>...] - ETA: 0s - loss: 0.2167\n36/36 [==============================] - 0s 3ms/step - loss: 0.2268\nEpoch:  135\n 1/36 [..............................] - ETA: 0s - loss: 0.0148\n17/36 [=============>................] - ETA: 0s - loss: 0.1108\n34/36 [===========================>..] - ETA: 0s - loss: 0.2242\n36/36 [==============================] - 0s 3ms/step - loss: 0.2309\nEpoch:  136\n 1/36 [..............................] - ETA: 0s - loss: 0.0461\n17/36 [=============>................] - ETA: 0s - loss: 0.1063\n33/36 [==========================>...] - ETA: 0s - loss: 0.2146\n36/36 [==============================] - 0s 3ms/step - loss: 0.2262\nEpoch:  137\n 1/36 [..............................] - ETA: 0s - loss: 0.0225\n16/36 [============>.................] - ETA: 0s - loss: 0.0993\n32/36 [=========================>....] - ETA: 0s - loss: 0.2085\n36/36 [==============================] - 0s 3ms/step - loss: 0.2285\nEpoch:  138\n 1/36 [..............................] - ETA: 0s - loss: 0.0641\n17/36 [=============>................] - ETA: 0s - loss: 0.1160\n33/36 [==========================>...] - ETA: 0s - loss: 0.2169\n36/36 [==============================] - 0s 3ms/step - loss: 0.2261\nEpoch:  139\n 1/36 [..............................] - ETA: 0s - loss: 0.0339\n17/36 [=============>................] - ETA: 0s - loss: 0.1144\n33/36 [==========================>...] - ETA: 0s - loss: 0.2184\n36/36 [==============================] - 0s 3ms/step - loss: 0.2296\nEpoch:  140\n 1/36 [..............................] - ETA: 0s - loss: 0.0532\n17/36 [=============>................] - ETA: 0s - loss: 0.1195\n33/36 [==========================>...] - ETA: 0s - loss: 0.2191\n36/36 [==============================] - 0s 3ms/step - loss: 0.2289\nEpoch:  141\n 1/36 [..............................] - ETA: 0s - loss: 0.0270\n17/36 [=============>................] - ETA: 0s - loss: 0.1090\n32/36 [=========================>....] - ETA: 0s - loss: 0.2111\n36/36 [==============================] - 0s 3ms/step - loss: 0.2291\nEpoch:  142\n 1/36 [..............................] - ETA: 0s - loss: 0.0603\n17/36 [=============>................] - ETA: 0s - loss: 0.1194\n33/36 [==========================>...] - ETA: 0s - loss: 0.2167\n36/36 [==============================] - 0s 3ms/step - loss: 0.2247\nEpoch:  143\n 1/36 [..............................] - ETA: 0s - loss: 0.0384\n17/36 [=============>................] - ETA: 0s - loss: 0.1192\n33/36 [==========================>...] - ETA: 0s - loss: 0.2225\n36/36 [==============================] - 0s 3ms/step - loss: 0.2350\nEpoch:  144\n 1/36 [..............................] - ETA: 0s - loss: 0.0676\n18/36 [==============>...............] - ETA: 0s - loss: 0.1326\n34/36 [===========================>..] - ETA: 0s - loss: 0.2214\n36/36 [==============================] - 0s 3ms/step - loss: 0.2256\nEpoch:  145\n 1/36 [..............................] - ETA: 0s - loss: 0.0293\n16/36 [============>.................] - ETA: 0s - loss: 0.1164\n32/36 [=========================>....] - ETA: 0s - loss: 0.2133\n36/36 [==============================] - 0s 3ms/step - loss: 0.2293\nEpoch:  146\n 1/36 [..............................] - ETA: 0s - loss: 0.0575\n17/36 [=============>................] - ETA: 0s - loss: 0.1163\n34/36 [===========================>..] - ETA: 0s - loss: 0.2220\n36/36 [==============================] - 0s 3ms/step - loss: 0.2265\nEpoch:  147\n 1/36 [..............................] - ETA: 0s - loss: 0.0101\n17/36 [=============>................] - ETA: 0s - loss: 0.1132\n33/36 [==========================>...] - ETA: 0s - loss: 0.2185\n36/36 [==============================] - 0s 3ms/step - loss: 0.2305\nEpoch:  148\n 1/36 [..............................] - ETA: 0s - loss: 0.0508\n17/36 [=============>................] - ETA: 0s - loss: 0.1089\n32/36 [=========================>....] - ETA: 0s - loss: 0.2098\n36/36 [==============================] - 0s 3ms/step - loss: 0.2260\nEpoch:  149\n 1/36 [..............................] - ETA: 0s - loss: 0.0177\n17/36 [=============>................] - ETA: 0s - loss: 0.1096\n33/36 [==========================>...] - ETA: 0s - loss: 0.2149\n36/36 [==============================] - 0s 3ms/step - loss: 0.2256\nEpoch:  150\n 1/36 [..............................] - ETA: 0s - loss: 0.0254\n17/36 [=============>................] - ETA: 0s - loss: 0.1090\n33/36 [==========================>...] - ETA: 0s - loss: 0.2156\n36/36 [==============================] - 0s 3ms/step - loss: 0.2271\nEpoch:  151\n 1/36 [..............................] - ETA: 0s - loss: 7.1549e-04\n17/36 [=============>................] - ETA: 0s - loss: 0.1150    \n34/36 [===========================>..] - ETA: 0s - loss: 0.2195\n36/36 [==============================] - 0s 3ms/step - loss: 0.2234\nEpoch:  152\n 1/36 [..............................] - ETA: 0s - loss: 0.0122\n17/36 [=============>................] - ETA: 0s - loss: 0.1188\n33/36 [==========================>...] - ETA: 0s - loss: 0.2210\n36/36 [==============================] - 0s 3ms/step - loss: 0.2326\nEpoch:  153\n 1/36 [..............................] - ETA: 0s - loss: 0.0040\n16/36 [============>.................] - ETA: 0s - loss: 0.1182\n32/36 [=========================>....] - ETA: 0s - loss: 0.2106\n36/36 [==============================] - 0s 3ms/step - loss: 0.2226\nEpoch:  154\n 1/36 [..............................] - ETA: 0s - loss: 0.0992\n17/36 [=============>................] - ETA: 0s - loss: 0.1232\n33/36 [==========================>...] - ETA: 0s - loss: 0.2243\n36/36 [==============================] - 0s 3ms/step - loss: 0.2365\nEpoch:  155\n 1/36 [..............................] - ETA: 0s - loss: 0.0111\n16/36 [============>.................] - ETA: 0s - loss: 0.1145\n30/36 [========================>.....] - ETA: 0s - loss: 0.1872\n36/36 [==============================] - 0s 4ms/step - loss: 0.2234\nEpoch:  156\n 1/36 [..............................] - ETA: 0s - loss: 0.0884\n17/36 [=============>................] - ETA: 0s - loss: 0.1196\n34/36 [===========================>..] - ETA: 0s - loss: 0.2255\n36/36 [==============================] - 0s 3ms/step - loss: 0.2308\nEpoch:  157\n 1/36 [..............................] - ETA: 0s - loss: 0.0015\n17/36 [=============>................] - ETA: 0s - loss: 0.1131\n33/36 [==========================>...] - ETA: 0s - loss: 0.2151\n36/36 [==============================] - 0s 3ms/step - loss: 0.2245\nEpoch:  158\n 1/36 [..............................] - ETA: 0s - loss: 0.0677\n17/36 [=============>................] - ETA: 0s - loss: 0.1166\n33/36 [==========================>...] - ETA: 0s - loss: 0.2199\n36/36 [==============================] - 0s 3ms/step - loss: 0.2316\nEpoch:  159\n 1/36 [..............................] - ETA: 0s - loss: 0.0043\n17/36 [=============>................] - ETA: 0s - loss: 0.1096\n33/36 [==========================>...] - ETA: 0s - loss: 0.2132\n36/36 [==============================] - 0s 3ms/step - loss: 0.2226\nEpoch:  160\n 1/36 [..............................] - ETA: 0s - loss: 0.0115\n17/36 [=============>................] - ETA: 0s - loss: 0.1142\n33/36 [==========================>...] - ETA: 0s - loss: 0.2197\n36/36 [==============================] - 0s 3ms/step - loss: 0.2321\nEpoch:  161\n 1/36 [..............................] - ETA: 0s - loss: 0.0031\n17/36 [=============>................] - ETA: 0s - loss: 0.1101\n33/36 [==========================>...] - ETA: 0s - loss: 0.2128\n36/36 [==============================] - 0s 3ms/step - loss: 0.2216\nEpoch:  162\n 1/36 [..............................] - ETA: 0s - loss: 0.1010\n18/36 [==============>...............] - ETA: 0s - loss: 0.1392\n34/36 [===========================>..] - ETA: 0s - loss: 0.2270\n36/36 [==============================] - 0s 3ms/step - loss: 0.2320\nEpoch:  163\n 1/36 [..............................] - ETA: 0s - loss: 0.0085\n17/36 [=============>................] - ETA: 0s - loss: 0.1082\n33/36 [==========================>...] - ETA: 0s - loss: 0.2141\n36/36 [==============================] - 0s 3ms/step - loss: 0.2248\nEpoch:  164\n 1/36 [..............................] - ETA: 0s - loss: 0.0377\n17/36 [=============>................] - ETA: 0s - loss: 0.1068\n33/36 [==========================>...] - ETA: 0s - loss: 0.2144\n36/36 [==============================] - 0s 3ms/step - loss: 0.2259\nEpoch:  165\n 1/36 [..............................] - ETA: 0s - loss: 0.0106\n17/36 [=============>................] - ETA: 0s - loss: 0.1154\n33/36 [==========================>...] - ETA: 0s - loss: 0.2167\n36/36 [==============================] - 0s 3ms/step - loss: 0.2265\nEpoch:  166\n 1/36 [..............................] - ETA: 0s - loss: 0.0729\n17/36 [=============>................] - ETA: 0s - loss: 0.1090\n34/36 [===========================>..] - ETA: 0s - loss: 0.2223\n36/36 [==============================] - 0s 3ms/step - loss: 0.2286\nEpoch:  167\n 1/36 [..............................] - ETA: 0s - loss: 0.0154\n16/36 [============>.................] - ETA: 0s - loss: 0.1180\n32/36 [=========================>....] - ETA: 0s - loss: 0.2105\n36/36 [==============================] - 0s 3ms/step - loss: 0.2224\nEpoch:  168\n 1/36 [..............................] - ETA: 0s - loss: 0.0841\n17/36 [=============>................] - ETA: 0s - loss: 0.1185\n33/36 [==========================>...] - ETA: 0s - loss: 0.2217\n36/36 [==============================] - 0s 3ms/step - loss: 0.2339\nEpoch:  169\n 1/36 [..............................] - ETA: 0s - loss: 0.0227\n17/36 [=============>................] - ETA: 0s - loss: 0.1130\n34/36 [===========================>..] - ETA: 0s - loss: 0.2190\n36/36 [==============================] - 0s 3ms/step - loss: 0.2230\nEpoch:  170\n 1/36 [..............................] - ETA: 0s - loss: 0.0749\n16/36 [============>.................] - ETA: 0s - loss: 0.1166\n32/36 [=========================>....] - ETA: 0s - loss: 0.2130\n36/36 [==============================] - 0s 3ms/step - loss: 0.2284\nEpoch:  171\n 1/36 [..............................] - ETA: 0s - loss: 0.0124\n17/36 [=============>................] - ETA: 0s - loss: 0.1121\n34/36 [===========================>..] - ETA: 0s - loss: 0.2191\n36/36 [==============================] - 0s 3ms/step - loss: 0.2234\nEpoch:  172\n 1/36 [..............................] - ETA: 0s - loss: 0.0561\n17/36 [=============>................] - ETA: 0s - loss: 0.1174\n33/36 [==========================>...] - ETA: 0s - loss: 0.2164\n36/36 [==============================] - 0s 3ms/step - loss: 0.2250\nEpoch:  173\n 1/36 [..............................] - ETA: 0s - loss: 0.0121\n18/36 [==============>...............] - ETA: 0s - loss: 0.1276\n34/36 [===========================>..] - ETA: 0s - loss: 0.2216\n36/36 [==============================] - 0s 3ms/step - loss: 0.2273\nEpoch:  174\n 1/36 [..............................] - ETA: 0s - loss: 0.0511\n17/36 [=============>................] - ETA: 0s - loss: 0.1145\n33/36 [==========================>...] - ETA: 0s - loss: 0.2154\n36/36 [==============================] - 0s 3ms/step - loss: 0.2247\nEpoch:  175\n 1/36 [..............................] - ETA: 0s - loss: 0.0326\n17/36 [=============>................] - ETA: 0s - loss: 0.1055\n33/36 [==========================>...] - ETA: 0s - loss: 0.2152\n36/36 [==============================] - 0s 3ms/step - loss: 0.2274\nEpoch:  176\n 1/36 [..............................] - ETA: 0s - loss: 0.0577\n17/36 [=============>................] - ETA: 0s - loss: 0.1113\n33/36 [==========================>...] - ETA: 0s - loss: 0.2125\n36/36 [==============================] - 0s 3ms/step - loss: 0.2201\nEpoch:  177\n 1/36 [..............................] - ETA: 0s - loss: 0.0412\n17/36 [=============>................] - ETA: 0s - loss: 0.1176\n33/36 [==========================>...] - ETA: 0s - loss: 0.2177\n36/36 [==============================] - 0s 3ms/step - loss: 0.2268\nEpoch:  178\n 1/36 [..............................] - ETA: 0s - loss: 0.0463\n17/36 [=============>................] - ETA: 0s - loss: 0.1115\n33/36 [==========================>...] - ETA: 0s - loss: 0.2126\n36/36 [==============================] - 0s 3ms/step - loss: 0.2204\nEpoch:  179\n 1/36 [..............................] - ETA: 0s - loss: 0.0234\n17/36 [=============>................] - ETA: 0s - loss: 0.1081\n33/36 [==========================>...] - ETA: 0s - loss: 0.2136\n36/36 [==============================] - 0s 3ms/step - loss: 0.2234\nEpoch:  180\n 1/36 [..............................] - ETA: 0s - loss: 0.0605\n16/36 [============>.................] - ETA: 0s - loss: 0.1225\n32/36 [=========================>....] - ETA: 0s - loss: 0.2126\n36/36 [==============================] - 0s 3ms/step - loss: 0.2233\nEpoch:  181\n 1/36 [..............................] - ETA: 0s - loss: 0.0209\n17/36 [=============>................] - ETA: 0s - loss: 0.1039\n33/36 [==========================>...] - ETA: 0s - loss: 0.2125\n36/36 [==============================] - 0s 3ms/step - loss: 0.2230\nEpoch:  182\n 1/36 [..............................] - ETA: 0s - loss: 0.0651\n17/36 [=============>................] - ETA: 0s - loss: 0.1154\n33/36 [==========================>...] - ETA: 0s - loss: 0.2147\n36/36 [==============================] - 0s 3ms/step - loss: 0.2222\nEpoch:  183\n 1/36 [..............................] - ETA: 0s - loss: 0.0158\n17/36 [=============>................] - ETA: 0s - loss: 0.0986\n33/36 [==========================>...] - ETA: 0s - loss: 0.2108\n36/36 [==============================] - 0s 3ms/step - loss: 0.2221\nEpoch:  184\n 1/36 [..............................] - ETA: 0s - loss: 0.0695\n17/36 [=============>................] - ETA: 0s - loss: 0.1119\n33/36 [==========================>...] - ETA: 0s - loss: 0.2108\n36/36 [==============================] - 0s 3ms/step - loss: 0.2160\nEpoch:  185\n 1/36 [..............................] - ETA: 0s - loss: 0.0268\n16/36 [============>.................] - ETA: 0s - loss: 0.1152\n31/36 [========================>.....] - ETA: 0s - loss: 0.1990\n36/36 [==============================] - 0s 3ms/step - loss: 0.2176\nEpoch:  186\n 1/36 [..............................] - ETA: 0s - loss: 0.0559\n17/36 [=============>................] - ETA: 0s - loss: 0.1156\n32/36 [=========================>....] - ETA: 0s - loss: 0.2107\n36/36 [==============================] - 0s 3ms/step - loss: 0.2217\nEpoch:  187\n 1/36 [..............................] - ETA: 0s - loss: 0.0091\n17/36 [=============>................] - ETA: 0s - loss: 0.0899\n33/36 [==========================>...] - ETA: 0s - loss: 0.2046\n36/36 [==============================] - 0s 3ms/step - loss: 0.2129\nEpoch:  188\n 1/36 [..............................] - ETA: 0s - loss: 0.0438\n16/36 [============>.................] - ETA: 0s - loss: 0.1221\n32/36 [=========================>....] - ETA: 0s - loss: 0.2118\n36/36 [==============================] - 0s 3ms/step - loss: 0.2204\nEpoch:  189\n 1/36 [..............................] - ETA: 0s - loss: 0.0047\n16/36 [============>.................] - ETA: 0s - loss: 0.0999\n32/36 [=========================>....] - ETA: 0s - loss: 0.2036\n36/36 [==============================] - 0s 3ms/step - loss: 0.2154\nEpoch:  190\n 1/36 [..............................] - ETA: 0s - loss: 0.0964\n16/36 [============>.................] - ETA: 0s - loss: 0.1190\n31/36 [========================>.....] - ETA: 0s - loss: 0.2013\n36/36 [==============================] - 0s 3ms/step - loss: 0.2181\nEpoch:  191\n 1/36 [..............................] - ETA: 0s - loss: 0.0086\n16/36 [============>.................] - ETA: 0s - loss: 0.1005\n31/36 [========================>.....] - ETA: 0s - loss: 0.1914\n36/36 [==============================] - 0s 3ms/step - loss: 0.2054\nEpoch:  192\n 1/36 [..............................] - ETA: 0s - loss: 0.0345\n16/36 [============>.................] - ETA: 0s - loss: 0.0991\n32/36 [=========================>....] - ETA: 0s - loss: 0.1997\n36/36 [==============================] - 0s 3ms/step - loss: 0.2027\nEpoch:  193\n 1/36 [..............................] - ETA: 0s - loss: 0.0015\n17/36 [=============>................] - ETA: 0s - loss: 0.1106\n34/36 [===========================>..] - ETA: 0s - loss: 0.2051\n36/36 [==============================] - 0s 3ms/step - loss: 0.1975\nEpoch:  194\n 1/36 [..............................] - ETA: 0s - loss: 0.0589\n18/36 [==============>...............] - ETA: 0s - loss: 0.1177\n34/36 [===========================>..] - ETA: 0s - loss: 0.2226\n36/36 [==============================] - 0s 3ms/step - loss: 0.2301\nEpoch:  195\n 1/36 [..............................] - ETA: 0s - loss: 0.1236\n17/36 [=============>................] - ETA: 0s - loss: 0.1643\n33/36 [==========================>...] - ETA: 0s - loss: 0.2570\n36/36 [==============================] - 0s 3ms/step - loss: 0.2762\nEpoch:  196\n 1/36 [..............................] - ETA: 0s - loss: 0.0272\n13/36 [=========>....................] - ETA: 0s - loss: 0.0928\n29/36 [=======================>......] - ETA: 0s - loss: 0.1725\n36/36 [==============================] - 0s 4ms/step - loss: 0.2297\nEpoch:  197\n 1/36 [..............................] - ETA: 0s - loss: 0.0497\n17/36 [=============>................] - ETA: 0s - loss: 0.1083\n29/36 [=======================>......] - ETA: 0s - loss: 0.1807\n36/36 [==============================] - 0s 4ms/step - loss: 0.2322\nEpoch:  198\n 1/36 [..............................] - ETA: 0s - loss: 0.0168\n12/36 [=========>....................] - ETA: 0s - loss: 0.1158\n25/36 [===================>..........] - ETA: 0s - loss: 0.1756\n33/36 [==========================>...] - ETA: 0s - loss: 0.2181\n36/36 [==============================] - 0s 5ms/step - loss: 0.2319\nEpoch:  199\n 1/36 [..............................] - ETA: 0s - loss: 0.0127\n13/36 [=========>....................] - ETA: 0s - loss: 0.1165\n25/36 [===================>..........] - ETA: 0s - loss: 0.1737\n33/36 [==========================>...] - ETA: 0s - loss: 0.2162\n36/36 [==============================] - 0s 6ms/step - loss: 0.2300\nEpoch:  200\n 1/36 [..............................] - ETA: 0s - loss: 0.0311\n12/36 [=========>....................] - ETA: 0s - loss: 0.1146\n22/36 [=================>............] - ETA: 0s - loss: 0.1418\n35/36 [============================>.] - ETA: 0s - loss: 0.2242\n36/36 [==============================] - 0s 5ms/step - loss: 0.2282\nEpoch:  201\n 1/36 [..............................] - ETA: 0s - loss: 0.0366\n11/36 [========>.....................] - ETA: 0s - loss: 0.1070\n21/36 [================>.............] - ETA: 0s - loss: 0.1333\n32/36 [=========================>....] - ETA: 0s - loss: 0.2098\n36/36 [==============================] - 0s 5ms/step - loss: 0.2304\nEpoch:  202\n 1/36 [..............................] - ETA: 0s - loss: 0.0448\n12/36 [=========>....................] - ETA: 0s - loss: 0.1197\n23/36 [==================>...........] - ETA: 0s - loss: 0.1477\n33/36 [==========================>...] - ETA: 0s - loss: 0.2162\n36/36 [==============================] - 0s 5ms/step - loss: 0.2264\nEpoch:  203\n 1/36 [..............................] - ETA: 0s - loss: 0.0479\n11/36 [========>.....................] - ETA: 0s - loss: 0.1159\n20/36 [===============>..............] - ETA: 0s - loss: 0.1424\n30/36 [========================>.....] - ETA: 0s - loss: 0.1884\n36/36 [==============================] - 0s 6ms/step - loss: 0.2308\nEpoch:  204\n 1/36 [..............................] - ETA: 0s - loss: 0.0339\n15/36 [===========>..................] - ETA: 0s - loss: 0.1177\n26/36 [====================>.........] - ETA: 0s - loss: 0.1861\n36/36 [==============================] - 0s 4ms/step - loss: 0.2268\nEpoch:  205\n 1/36 [..............................] - ETA: 0s - loss: 0.0328\n14/36 [==========>...................] - ETA: 0s - loss: 0.1159\n27/36 [=====================>........] - ETA: 0s - loss: 0.1797\n36/36 [==============================] - 0s 4ms/step - loss: 0.2312\nEpoch:  206\n 1/36 [..............................] - ETA: 0s - loss: 0.0278\n 8/36 [=====>........................] - ETA: 0s - loss: 0.1179\n14/36 [==========>...................] - ETA: 0s - loss: 0.1162\n20/36 [===============>..............] - ETA: 0s - loss: 0.1368\n30/36 [========================>.....] - ETA: 0s - loss: 0.1866\n36/36 [==============================] - 0s 7ms/step - loss: 0.2235\nEpoch:  207\n 1/36 [..............................] - ETA: 0s - loss: 0.0673\n12/36 [=========>....................] - ETA: 0s - loss: 0.1279\n26/36 [====================>.........] - ETA: 0s - loss: 0.1874\n36/36 [==============================] - 0s 4ms/step - loss: 0.2358\nEpoch:  208\n 1/36 [..............................] - ETA: 0s - loss: 0.0340\n18/36 [==============>...............] - ETA: 0s - loss: 0.1267\n35/36 [============================>.] - ETA: 0s - loss: 0.2207\n36/36 [==============================] - 0s 3ms/step - loss: 0.2241\nEpoch:  209\n 1/36 [..............................] - ETA: 0s - loss: 0.0595\n13/36 [=========>....................] - ETA: 0s - loss: 0.1279\n29/36 [=======================>......] - ETA: 0s - loss: 0.1842\n36/36 [==============================] - 0s 4ms/step - loss: 0.2308\nEpoch:  210\n 1/36 [..............................] - ETA: 0s - loss: 0.0241\n12/36 [=========>....................] - ETA: 0s - loss: 0.1139\n27/36 [=====================>........] - ETA: 0s - loss: 0.1814\n36/36 [==============================] - 0s 4ms/step - loss: 0.2251\nEpoch:  211\n 1/36 [..............................] - ETA: 0s - loss: 0.0440\n14/36 [==========>...................] - ETA: 0s - loss: 0.1122\n28/36 [======================>.......] - ETA: 0s - loss: 0.1818\n36/36 [==============================] - 0s 4ms/step - loss: 0.2286\nEpoch:  212\n 1/36 [..............................] - ETA: 0s - loss: 0.0379\n11/36 [========>.....................] - ETA: 0s - loss: 0.1124\n25/36 [===================>..........] - ETA: 0s - loss: 0.1824\n36/36 [==============================] - 0s 4ms/step - loss: 0.2239\nEpoch:  213\n 1/36 [..............................] - ETA: 0s - loss: 0.0558\n16/36 [============>.................] - ETA: 0s - loss: 0.1168\n30/36 [========================>.....] - ETA: 0s - loss: 0.1895\n36/36 [==============================] - 0s 4ms/step - loss: 0.2337\nEpoch:  214\n 1/36 [..............................] - ETA: 0s - loss: 0.0434\n17/36 [=============>................] - ETA: 0s - loss: 0.1137\n33/36 [==========================>...] - ETA: 0s - loss: 0.2151\n36/36 [==============================] - 0s 3ms/step - loss: 0.2246\nEpoch:  215\n 1/36 [..............................] - ETA: 0s - loss: 0.0488\n15/36 [===========>..................] - ETA: 0s - loss: 0.1199\n30/36 [========================>.....] - ETA: 0s - loss: 0.1880\n36/36 [==============================] - 0s 4ms/step - loss: 0.2289\nEpoch:  216\n 1/36 [..............................] - ETA: 0s - loss: 0.0331\n15/36 [===========>..................] - ETA: 0s - loss: 0.1179\n30/36 [========================>.....] - ETA: 0s - loss: 0.1867\n36/36 [==============================] - 0s 4ms/step - loss: 0.2251\nEpoch:  217\n 1/36 [..............................] - ETA: 0s - loss: 0.0343\n12/36 [=========>....................] - ETA: 0s - loss: 0.1174\n21/36 [================>.............] - ETA: 0s - loss: 0.1352\n28/36 [======================>.......] - ETA: 0s - loss: 0.1843\n36/36 [==============================] - 0s 6ms/step - loss: 0.2296\nEpoch:  218\n 1/36 [..............................] - ETA: 0s - loss: 0.0268\n 8/36 [=====>........................] - ETA: 0s - loss: 0.1163\n20/36 [===============>..............] - ETA: 0s - loss: 0.1365\n30/36 [========================>.....] - ETA: 0s - loss: 0.1868\n36/36 [==============================] - 0s 5ms/step - loss: 0.2222\nEpoch:  219\n 1/36 [..............................] - ETA: 0s - loss: 0.0688\n13/36 [=========>....................] - ETA: 0s - loss: 0.1335\n25/36 [===================>..........] - ETA: 0s - loss: 0.1836\n34/36 [===========================>..] - ETA: 0s - loss: 0.2282\n36/36 [==============================] - 0s 5ms/step - loss: 0.2347\nEpoch:  220\n 1/36 [..............................] - ETA: 0s - loss: 0.0328\n15/36 [===========>..................] - ETA: 0s - loss: 0.1160\n25/36 [===================>..........] - ETA: 0s - loss: 0.1788\n36/36 [==============================] - 0s 4ms/step - loss: 0.2228\nEpoch:  221\n 1/36 [..............................] - ETA: 0s - loss: 0.0610\n15/36 [===========>..................] - ETA: 0s - loss: 0.1236\n28/36 [======================>.......] - ETA: 0s - loss: 0.1885\n36/36 [==============================] - 0s 4ms/step - loss: 0.2300\nEpoch:  222\n 1/36 [..............................] - ETA: 0s - loss: 0.0229\n12/36 [=========>....................] - ETA: 0s - loss: 0.1144\n25/36 [===================>..........] - ETA: 0s - loss: 0.1787\n36/36 [==============================] - 0s 4ms/step - loss: 0.2240\nEpoch:  223\n 1/36 [..............................] - ETA: 0s - loss: 0.0458\n 9/36 [======>.......................] - ETA: 0s - loss: 0.1107\n23/36 [==================>...........] - ETA: 0s - loss: 0.1461\n36/36 [==============================] - 0s 4ms/step - loss: 0.2280\nEpoch:  224\n 1/36 [..............................] - ETA: 0s - loss: 0.0362\n14/36 [==========>...................] - ETA: 0s - loss: 0.1216\n27/36 [=====================>........] - ETA: 0s - loss: 0.1891\n36/36 [==============================] - 0s 4ms/step - loss: 0.2228\nEpoch:  225\n 1/36 [..............................] - ETA: 0s - loss: 0.0576\n14/36 [==========>...................] - ETA: 0s - loss: 0.1261\n27/36 [=====================>........] - ETA: 0s - loss: 0.1860\n36/36 [==============================] - 0s 4ms/step - loss: 0.2334\nEpoch:  226\n 1/36 [..............................] - ETA: 0s - loss: 0.0417\n16/36 [============>.................] - ETA: 0s - loss: 0.1169\n30/36 [========================>.....] - ETA: 0s - loss: 0.1879\n36/36 [==============================] - 0s 4ms/step - loss: 0.2235\nEpoch:  227\n 1/36 [..............................] - ETA: 0s - loss: 0.0505\n11/36 [========>.....................] - ETA: 0s - loss: 0.1154\n24/36 [===================>..........] - ETA: 0s - loss: 0.1641\n36/36 [==============================] - 0s 5ms/step - loss: 0.2321\nEpoch:  228\n 1/36 [..............................] - ETA: 0s - loss: 0.0480\n14/36 [==========>...................] - ETA: 0s - loss: 0.1175\n28/36 [======================>.......] - ETA: 0s - loss: 0.1869\n36/36 [==============================] - 0s 4ms/step - loss: 0.2242\nEpoch:  229\n 1/36 [..............................] - ETA: 0s - loss: 0.0436\n16/36 [============>.................] - ETA: 0s - loss: 0.1131\n30/36 [========================>.....] - ETA: 0s - loss: 0.1869\n36/36 [==============================] - 0s 4ms/step - loss: 0.2279\nEpoch:  230\n 1/36 [..............................] - ETA: 0s - loss: 0.0377\n16/36 [============>.................] - ETA: 0s - loss: 0.1126\n30/36 [========================>.....] - ETA: 0s - loss: 0.1862\n36/36 [==============================] - 0s 4ms/step - loss: 0.2245\nEpoch:  231\n 1/36 [..............................] - ETA: 0s - loss: 0.0296\n14/36 [==========>...................] - ETA: 0s - loss: 0.1180\n24/36 [===================>..........] - ETA: 0s - loss: 0.1634\n36/36 [==============================] - ETA: 0s - loss: 0.2250\n36/36 [==============================] - 0s 5ms/step - loss: 0.2250\nEpoch:  232\n 1/36 [..............................] - ETA: 0s - loss: 0.0150\n14/36 [==========>...................] - ETA: 0s - loss: 0.1151\n27/36 [=====================>........] - ETA: 0s - loss: 0.1825\n33/36 [==========================>...] - ETA: 0s - loss: 0.2147\n36/36 [==============================] - 0s 5ms/step - loss: 0.2253\nEpoch:  233\n 1/36 [..............................] - ETA: 0s - loss: 0.0173\n12/36 [=========>....................] - ETA: 0s - loss: 0.1151\n24/36 [===================>..........] - ETA: 0s - loss: 0.1616\n32/36 [=========================>....] - ETA: 0s - loss: 0.2095\n36/36 [==============================] - 0s 5ms/step - loss: 0.2249\nEpoch:  234\n 1/36 [..............................] - ETA: 0s - loss: 0.0271\n10/36 [=======>......................] - ETA: 0s - loss: 0.1035\n23/36 [==================>...........] - ETA: 0s - loss: 0.1463\n36/36 [==============================] - ETA: 0s - loss: 0.2273\n36/36 [==============================] - 0s 5ms/step - loss: 0.2273\nEpoch:  235\n 1/36 [..............................] - ETA: 0s - loss: 0.0247\n15/36 [===========>..................] - ETA: 0s - loss: 0.1186\n31/36 [========================>.....] - ETA: 0s - loss: 0.1989\n36/36 [==============================] - 0s 4ms/step - loss: 0.2225\nEpoch:  236\n 1/36 [..............................] - ETA: 0s - loss: 0.0051\n15/36 [===========>..................] - ETA: 0s - loss: 0.1199\n30/36 [========================>.....] - ETA: 0s - loss: 0.1876\n36/36 [==============================] - 0s 4ms/step - loss: 0.2272\nEpoch:  237\n 1/36 [..............................] - ETA: 0s - loss: 0.0786\n14/36 [==========>...................] - ETA: 0s - loss: 0.1244\n28/36 [======================>.......] - ETA: 0s - loss: 0.1906\n36/36 [==============================] - 0s 4ms/step - loss: 0.2265\nEpoch:  238\n 1/36 [..............................] - ETA: 0s - loss: 0.0022\n17/36 [=============>................] - ETA: 0s - loss: 0.1150\n34/36 [===========================>..] - ETA: 0s - loss: 0.2211\n36/36 [==============================] - 0s 3ms/step - loss: 0.2261\nEpoch:  239\n 1/36 [..............................] - ETA: 0s - loss: 0.0328\n17/36 [=============>................] - ETA: 0s - loss: 0.1123\n33/36 [==========================>...] - ETA: 0s - loss: 0.2145\n36/36 [==============================] - 0s 3ms/step - loss: 0.2246\nEpoch:  240\n 1/36 [..............................] - ETA: 0s - loss: 0.0128\n16/36 [============>.................] - ETA: 0s - loss: 0.1099\n30/36 [========================>.....] - ETA: 0s - loss: 0.1849\n36/36 [==============================] - 0s 4ms/step - loss: 0.2249\nEpoch:  241\n 1/36 [..............................] - ETA: 0s - loss: 0.0196\n17/36 [=============>................] - ETA: 0s - loss: 0.1136\n33/36 [==========================>...] - ETA: 0s - loss: 0.2158\n36/36 [==============================] - 0s 3ms/step - loss: 0.2263\nEpoch:  242\n 1/36 [..............................] - ETA: 0s - loss: 0.0167\n18/36 [==============>...............] - ETA: 0s - loss: 0.1242\n35/36 [============================>.] - ETA: 0s - loss: 0.2210\n36/36 [==============================] - 0s 3ms/step - loss: 0.2248\nEpoch:  243\n 1/36 [..............................] - ETA: 0s - loss: 0.0153\n17/36 [=============>................] - ETA: 0s - loss: 0.1143\n34/36 [===========================>..] - ETA: 0s - loss: 0.2187\n36/36 [==============================] - 0s 3ms/step - loss: 0.2228\nEpoch:  244\n 1/36 [..............................] - ETA: 0s - loss: 0.0040\n16/36 [============>.................] - ETA: 0s - loss: 0.1153\n31/36 [========================>.....] - ETA: 0s - loss: 0.2010\n36/36 [==============================] - 0s 3ms/step - loss: 0.2292\nEpoch:  245\n 1/36 [..............................] - ETA: 0s - loss: 0.0119\n17/36 [=============>................] - ETA: 0s - loss: 0.1119\n33/36 [==========================>...] - ETA: 0s - loss: 0.2137\n36/36 [==============================] - 0s 3ms/step - loss: 0.2232\nEpoch:  246\n 1/36 [..............................] - ETA: 0s - loss: 0.0081\n17/36 [=============>................] - ETA: 0s - loss: 0.1135\n33/36 [==========================>...] - ETA: 0s - loss: 0.2150\n36/36 [==============================] - 0s 3ms/step - loss: 0.2250\nEpoch:  247\n 1/36 [..............................] - ETA: 0s - loss: 0.0249\n17/36 [=============>................] - ETA: 0s - loss: 0.1130\n33/36 [==========================>...] - ETA: 0s - loss: 0.2147\n36/36 [==============================] - 0s 3ms/step - loss: 0.2246\nEpoch:  248\n 1/36 [..............................] - ETA: 0s - loss: 0.0200\n17/36 [=============>................] - ETA: 0s - loss: 0.1137\n33/36 [==========================>...] - ETA: 0s - loss: 0.2160\n36/36 [==============================] - 0s 3ms/step - loss: 0.2267\nEpoch:  249\n 1/36 [..............................] - ETA: 0s - loss: 0.0322\n17/36 [=============>................] - ETA: 0s - loss: 0.1083\n32/36 [=========================>....] - ETA: 0s - loss: 0.2084\n36/36 [==============================] - 0s 3ms/step - loss: 0.2243\nEpoch:  250\n 1/36 [..............................] - ETA: 0s - loss: 0.0134\n17/36 [=============>................] - ETA: 0s - loss: 0.1052\n33/36 [==========================>...] - ETA: 0s - loss: 0.2128\n36/36 [==============================] - 0s 3ms/step - loss: 0.2245\nEpoch:  251\n 1/36 [..............................] - ETA: 0s - loss: 0.0187\n17/36 [=============>................] - ETA: 0s - loss: 0.1139\n33/36 [==========================>...] - ETA: 0s - loss: 0.2140\n36/36 [==============================] - 0s 3ms/step - loss: 0.2229\nEpoch:  252\n 1/36 [..............................] - ETA: 0s - loss: 5.0116e-04\n17/36 [=============>................] - ETA: 0s - loss: 0.1132    \n33/36 [==========================>...] - ETA: 0s - loss: 0.2170\n36/36 [==============================] - 0s 3ms/step - loss: 0.2287\nEpoch:  253\n 1/36 [..............................] - ETA: 0s - loss: 0.0152\n15/36 [===========>..................] - ETA: 0s - loss: 0.1168\n30/36 [========================>.....] - ETA: 0s - loss: 0.1859\n36/36 [==============================] - 0s 4ms/step - loss: 0.2232\nEpoch:  254\n 1/36 [..............................] - ETA: 0s - loss: 0.0048\n17/36 [=============>................] - ETA: 0s - loss: 0.1124\n32/36 [=========================>....] - ETA: 0s - loss: 0.2098\n36/36 [==============================] - 0s 3ms/step - loss: 0.2247\nEpoch:  255\n 1/36 [..............................] - ETA: 0s - loss: 0.0282\n17/36 [=============>................] - ETA: 0s - loss: 0.1119\n33/36 [==========================>...] - ETA: 0s - loss: 0.2142\n36/36 [==============================] - 0s 3ms/step - loss: 0.2242\nEpoch:  256\n 1/36 [..............................] - ETA: 0s - loss: 0.0166\n16/36 [============>.................] - ETA: 0s - loss: 0.1129\n31/36 [========================>.....] - ETA: 0s - loss: 0.1991\n36/36 [==============================] - 0s 4ms/step - loss: 0.2260\nEpoch:  257\n 1/36 [..............................] - ETA: 0s - loss: 0.0356\n17/36 [=============>................] - ETA: 0s - loss: 0.1139\n32/36 [=========================>....] - ETA: 0s - loss: 0.2090\n36/36 [==============================] - 0s 3ms/step - loss: 0.2216\nEpoch:  258\n 1/36 [..............................] - ETA: 0s - loss: 0.0160\n16/36 [============>.................] - ETA: 0s - loss: 0.1148\n30/36 [========================>.....] - ETA: 0s - loss: 0.1880\n36/36 [==============================] - 0s 4ms/step - loss: 0.2310\nEpoch:  259\n 1/36 [..............................] - ETA: 0s - loss: 0.0850\n17/36 [=============>................] - ETA: 0s - loss: 0.1141\n33/36 [==========================>...] - ETA: 0s - loss: 0.2144\n36/36 [==============================] - 0s 3ms/step - loss: 0.2234\nEpoch:  260\n 1/36 [..............................] - ETA: 0s - loss: 0.0062\n17/36 [=============>................] - ETA: 0s - loss: 0.1130\n33/36 [==========================>...] - ETA: 0s - loss: 0.2158\n36/36 [==============================] - 0s 3ms/step - loss: 0.2266\nEpoch:  261\n 1/36 [..............................] - ETA: 0s - loss: 0.0750\n16/36 [============>.................] - ETA: 0s - loss: 0.1184\n32/36 [=========================>....] - ETA: 0s - loss: 0.2114\n36/36 [==============================] - 0s 3ms/step - loss: 0.2252\nEpoch:  262\n 1/36 [..............................] - ETA: 0s - loss: 0.0012\n16/36 [============>.................] - ETA: 0s - loss: 0.1093\n32/36 [=========================>....] - ETA: 0s - loss: 0.2095\n36/36 [==============================] - 0s 3ms/step - loss: 0.2263\nEpoch:  263\n 1/36 [..............................] - ETA: 0s - loss: 0.0804\n17/36 [=============>................] - ETA: 0s - loss: 0.1173\n32/36 [=========================>....] - ETA: 0s - loss: 0.2103\n36/36 [==============================] - 0s 3ms/step - loss: 0.2219\nEpoch:  264\n 1/36 [..............................] - ETA: 0s - loss: 0.0126\n17/36 [=============>................] - ETA: 0s - loss: 0.1185\n33/36 [==========================>...] - ETA: 0s - loss: 0.2197\n36/36 [==============================] - 0s 3ms/step - loss: 0.2312\nEpoch:  265\n 1/36 [..............................] - ETA: 0s - loss: 0.0847\n17/36 [=============>................] - ETA: 0s - loss: 0.1153\n32/36 [=========================>....] - ETA: 0s - loss: 0.2100\n36/36 [==============================] - 0s 4ms/step - loss: 0.2225\nEpoch:  266\n 1/36 [..............................] - ETA: 0s - loss: 0.0058\n15/36 [===========>..................] - ETA: 0s - loss: 0.1221\n28/36 [======================>.......] - ETA: 0s - loss: 0.1882\n36/36 [==============================] - 0s 4ms/step - loss: 0.2266\nEpoch:  267\n 1/36 [..............................] - ETA: 0s - loss: 0.0743\n16/36 [============>.................] - ETA: 0s - loss: 0.1090\n30/36 [========================>.....] - ETA: 0s - loss: 0.1847\n36/36 [==============================] - 0s 4ms/step - loss: 0.2252\nEpoch:  268\n 1/36 [..............................] - ETA: 0s - loss: 0.0434\n18/36 [==============>...............] - ETA: 0s - loss: 0.1322\n34/36 [===========================>..] - ETA: 0s - loss: 0.2207\n36/36 [==============================] - 0s 3ms/step - loss: 0.2252\nEpoch:  269\n 1/36 [..............................] - ETA: 0s - loss: 0.0334\n17/36 [=============>................] - ETA: 0s - loss: 0.1073\n33/36 [==========================>...] - ETA: 0s - loss: 0.2139\n36/36 [==============================] - 0s 3ms/step - loss: 0.2255\nEpoch:  270\n 1/36 [..............................] - ETA: 0s - loss: 0.0460\n17/36 [=============>................] - ETA: 0s - loss: 0.1172\n31/36 [========================>.....] - ETA: 0s - loss: 0.2004\n36/36 [==============================] - 0s 4ms/step - loss: 0.2219\nEpoch:  271\n 1/36 [..............................] - ETA: 0s - loss: 0.0448\n17/36 [=============>................] - ETA: 0s - loss: 0.1162\n34/36 [===========================>..] - ETA: 0s - loss: 0.2242\n36/36 [==============================] - 0s 3ms/step - loss: 0.2302\nEpoch:  272\n 1/36 [..............................] - ETA: 0s - loss: 0.0512\n17/36 [=============>................] - ETA: 0s - loss: 0.1153\n33/36 [==========================>...] - ETA: 0s - loss: 0.2141\n36/36 [==============================] - 0s 3ms/step - loss: 0.2224\nEpoch:  273\n 1/36 [..............................] - ETA: 0s - loss: 0.0380\n17/36 [=============>................] - ETA: 0s - loss: 0.1146\n33/36 [==========================>...] - ETA: 0s - loss: 0.2157\n36/36 [==============================] - 0s 3ms/step - loss: 0.2257\nEpoch:  274\n 1/36 [..............................] - ETA: 0s - loss: 0.0407\n15/36 [===========>..................] - ETA: 0s - loss: 0.1195\n27/36 [=====================>........] - ETA: 0s - loss: 0.1861\n36/36 [==============================] - 0s 4ms/step - loss: 0.2226\nEpoch:  275\n 1/36 [..............................] - ETA: 0s - loss: 0.0252\n16/36 [============>.................] - ETA: 0s - loss: 0.1139\n31/36 [========================>.....] - ETA: 0s - loss: 0.1996\n36/36 [==============================] - 0s 4ms/step - loss: 0.2265\nEpoch:  276\n 1/36 [..............................] - ETA: 0s - loss: 0.0351\n18/36 [==============>...............] - ETA: 0s - loss: 0.1305\n35/36 [============================>.] - ETA: 0s - loss: 0.2205\n36/36 [==============================] - 0s 3ms/step - loss: 0.2235\nEpoch:  277\n 1/36 [..............................] - ETA: 0s - loss: 0.0422\n16/36 [============>.................] - ETA: 0s - loss: 0.1097\n30/36 [========================>.....] - ETA: 0s - loss: 0.1854\n36/36 [==============================] - 0s 4ms/step - loss: 0.2265\nEpoch:  278\n 1/36 [..............................] - ETA: 0s - loss: 0.0406\n17/36 [=============>................] - ETA: 0s - loss: 0.1136\n34/36 [===========================>..] - ETA: 0s - loss: 0.2165\n36/36 [==============================] - 0s 3ms/step - loss: 0.2199\nEpoch:  279\n 1/36 [..............................] - ETA: 0s - loss: 0.0508\n15/36 [===========>..................] - ETA: 0s - loss: 0.1237\n30/36 [========================>.....] - ETA: 0s - loss: 0.1896\n36/36 [==============================] - 0s 4ms/step - loss: 0.2306\nEpoch:  280\n 1/36 [..............................] - ETA: 0s - loss: 0.0459\n16/36 [============>.................] - ETA: 0s - loss: 0.1130\n32/36 [=========================>....] - ETA: 0s - loss: 0.2079\n36/36 [==============================] - 0s 3ms/step - loss: 0.2202\nEpoch:  281\n 1/36 [..............................] - ETA: 0s - loss: 0.0438\n17/36 [=============>................] - ETA: 0s - loss: 0.1164\n32/36 [=========================>....] - ETA: 0s - loss: 0.2118\n36/36 [==============================] - 0s 3ms/step - loss: 0.2260\nEpoch:  282\n 1/36 [..............................] - ETA: 0s - loss: 0.0356\n17/36 [=============>................] - ETA: 0s - loss: 0.1116\n33/36 [==========================>...] - ETA: 0s - loss: 0.2123\n36/36 [==============================] - 0s 3ms/step - loss: 0.2209\nEpoch:  283\n 1/36 [..............................] - ETA: 0s - loss: 0.0310\n17/36 [=============>................] - ETA: 0s - loss: 0.1094\n33/36 [==========================>...] - ETA: 0s - loss: 0.2137\n36/36 [==============================] - 0s 3ms/step - loss: 0.2241\nEpoch:  284\n 1/36 [..............................] - ETA: 0s - loss: 0.0464\n17/36 [=============>................] - ETA: 0s - loss: 0.1178\n33/36 [==========================>...] - ETA: 0s - loss: 0.2153\n36/36 [==============================] - 0s 3ms/step - loss: 0.2234\nEpoch:  285\n 1/36 [..............................] - ETA: 0s - loss: 0.0286\n17/36 [=============>................] - ETA: 0s - loss: 0.1070\n32/36 [=========================>....] - ETA: 0s - loss: 0.2080\n36/36 [==============================] - 0s 4ms/step - loss: 0.2240\nEpoch:  286\n 1/36 [..............................] - ETA: 0s - loss: 0.0507\n16/36 [============>.................] - ETA: 0s - loss: 0.1179\n32/36 [=========================>....] - ETA: 0s - loss: 0.2102\n36/36 [==============================] - 0s 3ms/step - loss: 0.2229\nEpoch:  287\n 1/36 [..............................] - ETA: 0s - loss: 0.0237\n17/36 [=============>................] - ETA: 0s - loss: 0.1035\n32/36 [=========================>....] - ETA: 0s - loss: 0.2067\n36/36 [==============================] - 0s 3ms/step - loss: 0.2234\nEpoch:  288\n 1/36 [..............................] - ETA: 0s - loss: 0.0550\n17/36 [=============>................] - ETA: 0s - loss: 0.1135\n33/36 [==========================>...] - ETA: 0s - loss: 0.2118\n36/36 [==============================] - 0s 3ms/step - loss: 0.2187\nEpoch:  289\n 1/36 [..............................] - ETA: 0s - loss: 0.0335\n17/36 [=============>................] - ETA: 0s - loss: 0.1154\n32/36 [=========================>....] - ETA: 0s - loss: 0.2101\n36/36 [==============================] - 0s 3ms/step - loss: 0.2224\nEpoch:  290\n 1/36 [..............................] - ETA: 0s - loss: 0.0429\n17/36 [=============>................] - ETA: 0s - loss: 0.1123\n33/36 [==========================>...] - ETA: 0s - loss: 0.2113\n36/36 [==============================] - 0s 3ms/step - loss: 0.2183\nEpoch:  291\n 1/36 [..............................] - ETA: 0s - loss: 0.0230\n16/36 [============>.................] - ETA: 0s - loss: 0.1078\n31/36 [========================>.....] - ETA: 0s - loss: 0.1962\n36/36 [==============================] - 0s 4ms/step - loss: 0.2208\nEpoch:  292\n 1/36 [..............................] - ETA: 0s - loss: 0.0520\n16/36 [============>.................] - ETA: 0s - loss: 0.1211\n31/36 [========================>.....] - ETA: 0s - loss: 0.2012\n36/36 [==============================] - 0s 3ms/step - loss: 0.2197\nEpoch:  293\n 1/36 [..............................] - ETA: 0s - loss: 0.0220\n16/36 [============>.................] - ETA: 0s - loss: 0.1048\n31/36 [========================>.....] - ETA: 0s - loss: 0.1954\n36/36 [==============================] - 0s 4ms/step - loss: 0.2212\nEpoch:  294\n 1/36 [..............................] - ETA: 0s - loss: 0.0549\n16/36 [============>.................] - ETA: 0s - loss: 0.1173\n32/36 [=========================>....] - ETA: 0s - loss: 0.2089\n36/36 [==============================] - 0s 3ms/step - loss: 0.2187\nEpoch:  295\n 1/36 [..............................] - ETA: 0s - loss: 0.0190\n16/36 [============>.................] - ETA: 0s - loss: 0.1021\n31/36 [========================>.....] - ETA: 0s - loss: 0.1942\n36/36 [==============================] - 0s 4ms/step - loss: 0.2197\nEpoch:  296\n 1/36 [..............................] - ETA: 0s - loss: 0.0575\n17/36 [=============>................] - ETA: 0s - loss: 0.1132\n33/36 [==========================>...] - ETA: 0s - loss: 0.2111\n36/36 [==============================] - 0s 3ms/step - loss: 0.2169\nEpoch:  297\n 1/36 [..............................] - ETA: 0s - loss: 0.0165\n17/36 [=============>................] - ETA: 0s - loss: 0.1008\n33/36 [==========================>...] - ETA: 0s - loss: 0.2088\n36/36 [==============================] - 0s 3ms/step - loss: 0.2182\nEpoch:  298\n 1/36 [..............................] - ETA: 0s - loss: 0.0595\n16/36 [============>.................] - ETA: 0s - loss: 0.1127\n31/36 [========================>.....] - ETA: 0s - loss: 0.1969\n36/36 [==============================] - 0s 4ms/step - loss: 0.2139\nEpoch:  299\n 1/36 [..............................] - ETA: 0s - loss: 0.0149\n17/36 [=============>................] - ETA: 0s - loss: 0.0994\n33/36 [==========================>...] - ETA: 0s - loss: 0.2075\n36/36 [==============================] - 0s 3ms/step - loss: 0.2160\nEpoch:  300\n 1/12 [=>............................] - ETA: 9s\n12/12 [==============================] - 1s 2ms/step\n```\n:::\n:::\n\n::: {.cell hash='modelo_sltm_cache/html/unnamed-chunk-36_012b1c9c0d2ff213e47c602b59652307'}\n\n```{.r .cell-code}\nfuture_gold_ts_tbl %>%\n    filter_time(\"2013\" ~ \"end\") %>%\n    plot_prediction(id = NULL, alpha = 0.4, size = 1.5) +\n    theme(legend.position = \"bottom\") +\n    ggtitle(\"Sunspots: Ten Year Forecast\", subtitle = \"Forecast Horizon: 2013 - 2023\")\n```\n\n::: {.cell-output-display}\n![](modelo_sltm_files/figure-html/unnamed-chunk-36-1.png){width=1440}\n:::\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}