<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Pedro Lima">
<meta name="dcterms.date" content="2023-10-30">

<title>PeDrOOM Blog - Cotação do ouro - Parte 4</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../">
<script src="../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../../index.html">
    <span class="navbar-title">PeDrOOM Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../CV.html" rel="" target="">
 <span class="menu-text">Curriculum vitæ</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../blog.html" rel="" target="">
 <span class="menu-text">Posts</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/cruz-ml-pedro" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/pedro-lima-8a9356268/" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Cotação do ouro - Parte 4</h1>
            <p class="subtitle lead">Modelos ARIMA</p>
                                <div class="quarto-categories">
                <div class="quarto-category">Modelos Estatísticos</div>
                <div class="quarto-category">Série-Temporal</div>
                <div class="quarto-category">R</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Pedro Lima </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">October 30, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introdução" id="toc-introdução" class="nav-link active" data-scroll-target="#introdução">Introdução</a></li>
  <li><a href="#modelos-arima-sarima" id="toc-modelos-arima-sarima" class="nav-link" data-scroll-target="#modelos-arima-sarima">Modelos ARIMA-SARIMA</a></li>
  <li><a href="#validação-cruzada" id="toc-validação-cruzada" class="nav-link" data-scroll-target="#validação-cruzada">Validação cruzada</a></li>
  <li><a href="#modelos" id="toc-modelos" class="nav-link" data-scroll-target="#modelos">Modelos</a>
  <ul class="collapse">
  <li><a href="#auto-arima" id="toc-auto-arima" class="nav-link" data-scroll-target="#auto-arima">Auto ARIMA</a></li>
  <li><a href="#sarima" id="toc-sarima" class="nav-link" data-scroll-target="#sarima">SARIMA</a></li>
  <li><a href="#sarima-com-multiplas-periodicidades" id="toc-sarima-com-multiplas-periodicidades" class="nav-link" data-scroll-target="#sarima-com-multiplas-periodicidades">SARIMA com multiplas periodicidades</a></li>
  <li><a href="#arima-xgboost-dos-erros" id="toc-arima-xgboost-dos-erros" class="nav-link" data-scroll-target="#arima-xgboost-dos-erros">ARIMA + XGBOOST dos erros</a></li>
  </ul></li>
  <li><a href="#comparando-os-modelos" id="toc-comparando-os-modelos" class="nav-link" data-scroll-target="#comparando-os-modelos">Comparando os modelos</a></li>
  <li><a href="#calibrando" id="toc-calibrando" class="nav-link" data-scroll-target="#calibrando">Calibrando</a></li>
  <li><a href="#residual" id="toc-residual" class="nav-link" data-scroll-target="#residual">Residual</a></li>
  <li><a href="#acurácia" id="toc-acurácia" class="nav-link" data-scroll-target="#acurácia">Acurácia</a></li>
  <li><a href="#visualização-do-conjunto-de-testes" id="toc-visualização-do-conjunto-de-testes" class="nav-link" data-scroll-target="#visualização-do-conjunto-de-testes">Visualização do conjunto de testes</a></li>
  <li><a href="#validação-cruzada---k-fold" id="toc-validação-cruzada---k-fold" class="nav-link" data-scroll-target="#validação-cruzada---k-fold">Validação Cruzada - K-fold</a>
  <ul class="collapse">
  <li><a href="#ajustando-os-modelos-aos-diferentes-conjuntos-de-dados-folds." id="toc-ajustando-os-modelos-aos-diferentes-conjuntos-de-dados-folds." class="nav-link" data-scroll-target="#ajustando-os-modelos-aos-diferentes-conjuntos-de-dados-folds.">Ajustando os modelos aos diferentes conjuntos de dados (folds).</a></li>
  </ul></li>
  <li><a href="#visualizando-o-desempenho-dos-modelos-nos-diferentes-conjuntos-de-dados-folds" id="toc-visualizando-o-desempenho-dos-modelos-nos-diferentes-conjuntos-de-dados-folds" class="nav-link" data-scroll-target="#visualizando-o-desempenho-dos-modelos-nos-diferentes-conjuntos-de-dados-folds">Visualizando o desempenho dos modelos nos diferentes conjuntos de dados (folds)</a></li>
  <li><a href="#tabela-com-o-desempenho-médios-dos-modelos" id="toc-tabela-com-o-desempenho-médios-dos-modelos" class="nav-link" data-scroll-target="#tabela-com-o-desempenho-médios-dos-modelos">Tabela com o desempenho médios dos modelos</a></li>
  <li><a href="#criando-as-previsões" id="toc-criando-as-previsões" class="nav-link" data-scroll-target="#criando-as-previsões">Criando as previsões</a></li>
  <li><a href="#conclusão" id="toc-conclusão" class="nav-link" data-scroll-target="#conclusão">Conclusão</a></li>
  <li><a href="#referências" id="toc-referências" class="nav-link" data-scroll-target="#referências">Referências</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="introdução" class="level1">
<h1>Introdução</h1>
<p>Nessa segunda post sobre a cotação do ouro, vou criar o primeiro modelo para realizar previsão dos valores de interesse. Os dados utilizados, assim como a escolha dos parâmetros utilizados para criar os modelos a seguir foram, respectivamente, adiquridos e escolhidos na <a href="">parte um</a> dessa série de postos.</p>
</section>
<section id="modelos-arima-sarima" class="level1">
<h1>Modelos ARIMA-SARIMA</h1>
<p>Modelos ARIMA (Autoregressive Integrated Moving Average) e SARIMA (Seasonal ARIMA) são poderosas ferramentas de análise e previsão de séries temporais amplamente usadas em estatísticas e ciência de dados.</p>
<p>Os modelos ARIMA combinam três componentes principais: o componente autoregressivo (AR), que leva em consideração as dependências lineares entre observações passadas; o componente de média móvel (MA), que modela o ruído da série; e a diferenciação integrada (I), que lida com tendências e sazonalidades não estacionárias.</p>
<p>Os modelos ARIMA podem ser representados da seguinte forma:</p>
<p><span class="math display">\[(1 - \phi_1 L - \phi_2 L^2 - \ldots - \phi_p L^p)(1 - L)^d X_t = (1 + \theta_1 L + \theta_2 L^2 + \ldots + \theta_q L^q) \varepsilon_t\]</span></p>
<p>Onde:</p>
<ul>
<li><span class="math inline">\((X_t)\)</span> é a série temporal.</li>
<li><span class="math inline">\((L)\)</span> é o operador de defasagem (lag).</li>
<li><span class="math inline">\((p)\)</span> é a ordem do componente AR (auto-regressivo).</li>
<li><span class="math inline">\((d)\)</span> é o número de diferenciações necessárias para tornar a série temporal estacionária.</li>
<li><span class="math inline">\((q)\)</span> é a ordem do componente MA (média móvel).</li>
<li><span class="math inline">\((\phi_1, \phi_2, \ldots, \phi_p)\)</span> são os coeficientes AR.</li>
<li><span class="math inline">\((\theta_1, \theta_2, \ldots, \theta_q)\)</span> são os coeficientes MA.</li>
<li><span class="math inline">\((\varepsilon_t)\)</span> são erros aleatórios.</li>
</ul>
<p>Os modelos SARIMA, por sua vez, estendem os modelos ARIMA para acomodar dados que exibam componentes periódicos, fazendo isso através da inclusão da componente (S) as demais componentes presentes nos modelos ARIMA.</p>
<p>Os modelos SARIMA podem ser representados da seguinte forma:</p>
<p><span class="math display">\[\begin{split}
&amp; (1 - \phi_1 L - \phi_2 L^2 - \ldots - \phi_p L^p)(1 - L)^d \cdot \\
&amp; (1 - \Phi_1 L^S - \Phi_2 L^{2S} - \ldots - \Phi_P L^{PS})X_t = \cdot \\
&amp; (1 + \theta_1 L + \theta_2 L^2 + \ldots + \theta_q L^q)(1 + \Theta_1 L^S + \Theta_2 L^{2S} + \ldots + \Theta_Q L^{QS})\varepsilon_t
\end{split}\]</span></p>
<p>Onde:</p>
<ul>
<li><span class="math inline">\((X_t)\)</span> é a série temporal.</li>
<li><span class="math inline">\((L)\)</span> é o operador de defasagem (lag).</li>
<li><span class="math inline">\((p)\)</span> é a ordem do componente AR (auto-regressivo).</li>
<li><span class="math inline">\((d)\)</span> é o número de diferenciações necessárias para tornar a série temporal estacionária.</li>
<li><span class="math inline">\((q)\)</span> é a ordem do componente MA (média móvel).</li>
<li><span class="math inline">\((P)\)</span> é a ordem do componente SAR (auto-regressivo sazonal).</li>
<li><span class="math inline">\((D)\)</span> é a ordem da diferenciação sazonal.</li>
<li><span class="math inline">\((Q)\)</span> é a ordem do componente SMA (média móvel sazonal).</li>
<li><span class="math inline">\((S)\)</span> é o período sazonal.</li>
<li><span class="math inline">\((\phi_1, \phi_2, \ldots, \phi_p)\)</span> são os coeficientes AR.</li>
<li><span class="math inline">\((\theta_1, \theta_2, \ldots, \theta_q)\)</span> são os coeficientes MA.</li>
<li><span class="math inline">\((\Phi_1, \Phi_2, \ldots, \Phi_P)\)</span> são os coeficientes SAR.</li>
<li><span class="math inline">\((\Theta_1, \Theta_2, \ldots, \Theta_Q)\)</span> são os coeficientes SMA.</li>
<li><span class="math inline">\((\varepsilon_t)\)</span> são erros aleatórios.</li>
</ul>
<p>Ambos os modelos exigem a escolha adequada das ordens dos componentes (p, d, q) e (P, D, Q, S), respectivamente, O que pode ser realizado por meio de <a href="">análise exploratória</a> dos dados. Uma vez ajustados, esses componentes permitem modelar e prever uma ampla variedade de padrões em séries temporais univariadas.</p>
</section>
<section id="validação-cruzada" class="level1">
<h1>Validação cruzada</h1>
<p>Antes de iniciarmos a construção do modelo vamos estabelecer um plano de validação cruzada.</p>
<p>A validação cruzada é uma técnica fundamental em aprendizado de máquina e estatística. Ela ajuda a avaliar o desempenho de modelos ao dividir os dados em conjuntos de treinamento e teste múltiplos, mitigando o viés de seleção do conjunto de teste e fornecendo uma estimativa mais confiável do desempenho do modelo em dados não vistos. Isso é essencial para escolher e ajustar modelos de maneira adequada e geralmente envolve k-folds, onde o conjunto de dados é dividido em k partes iguais, alternando entre treinamento e teste para cada iteração.</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-4_3461f924a5ee9cede3abb9ff8379713f">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>cv <span class="ot">&lt;-</span> </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  gold_mean <span class="sc">%&gt;%</span> </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">time_series_cv</span>(</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">assess      =</span> <span class="dv">12</span> <span class="sc">*</span> <span class="dv">1</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">initial     =</span> <span class="dv">12</span> <span class="sc">*</span> <span class="dv">7</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">skip        =</span> <span class="dv">12</span> <span class="sc">*</span> <span class="fl">0.5</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">slice_limit =</span> <span class="dv">8</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">culmulatime =</span> <span class="cn">TRUE</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-5_1af899da8c98373256d2c4b2ea926a00">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>cv <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tk_time_series_cv_plan</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_time_series_cv_plan</span>(mes,media, <span class="at">.facet_ncol =</span> <span class="dv">2</span>, <span class="at">.interactive =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
</section>
<section id="modelos" class="level1">
<h1>Modelos</h1>
<p>A seguir, serão criados diversos modelos, todos eles pertencentes à família ARIMA, e, posteriormente, serão comparados. Para a criação desses modelos, diferentes funções e “motores” serão empregados, e estes serão melhor explicados nos próximos tópicos. É importante destacar que a mesma função pode ser utilizada com diferentes “motores”. A escolha dos “motores” é sempre feita por meio da função <code>set_engine()</code>.</p>
<section id="auto-arima" class="level2">
<h2 class="anchored" data-anchor-id="auto-arima">Auto ARIMA</h2>
<p>A função auto_arima foi projetada para facilitar a modelagem e previsão de séries temporais, automatizando o processo de seleção do melhor modelo ARIMA. A função utiliza critérios de avaliação estatística, como o Critério de Informação de Akaike (AIC) e o Critério de Informação Bayesiano (BIC), para avaliar e comparar o ajuste de diferentes modelos. Além dos parâmetros ARIMA, a função também pode lidar com modelos SARIMA e selecionar automaticamente os parâmetros sazonais (P, D, Q, S) quando a série apresenta sazonalidade.</p>
<p>Apesar da automação também é permitido que você insira algumas restrições ou diretrizes para o processo de seleção, como limitar os valores máximos de p, d e q, ou forçar a inclusão de sazonalidade. Contudo a função será utilizado apenas em sua forma automática, deixando os parametros identificados durante a EDA para os demais modelos.</p>
<p>O código a seguir faz a seleção automática do melhor modelo ARIMA através da função <code>arima_reg()</code> e do “motor” <code>auto_arima</code>.</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-6_444500648d5c1ea54452208c684ec360">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>auto_arima <span class="ot">&lt;-</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arima_reg</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"auto_arima"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(media <span class="sc">~</span> mes, <span class="fu">training</span>(cv<span class="sc">$</span>splits[[<span class="dv">1</span>]]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sarima" class="level2">
<h2 class="anchored" data-anchor-id="sarima">SARIMA</h2>
<p>Para ajustar o modelo SARIMA, será utilizada a mesma função anterior, <code>arima_reg()</code>, mas com a ‘engine’ arima. Neste modelo, todos os parâmetros (p, d, q) e (P, D, Q, S) serão empregados. Para fins de comparação, serão criados dois modelos SARIMA, um com um componente S de 18 meses e outro com um componente S de 12 meses.</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-7_8526b5a71319b644b01e5381ac8e94c7">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>model_arima <span class="ot">&lt;-</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arima_reg</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">seasonal_period =</span> <span class="dv">16</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">non_seasonal_ar =</span> <span class="dv">1</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">non_seasonal_differences =</span> <span class="dv">1</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">non_seasonal_ma          =</span> <span class="dv">0</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">seasonal_ar              =</span> <span class="dv">1</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">seasonal_differences     =</span> <span class="dv">1</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">seasonal_ma              =</span> <span class="dv">0</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"arima"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(media <span class="sc">~</span> mes, <span class="fu">training</span>(cv<span class="sc">$</span>splits[[<span class="dv">1</span>]]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-8_c769f7bae0d422e3d36c489fd6c28410">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>model_arima2 <span class="ot">&lt;-</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arima_reg</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">seasonal_period =</span> <span class="dv">12</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">non_seasonal_ar =</span> <span class="dv">1</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">non_seasonal_differences =</span> <span class="dv">1</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">non_seasonal_ma          =</span> <span class="dv">0</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">seasonal_ar              =</span> <span class="dv">1</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">seasonal_differences     =</span> <span class="dv">1</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">seasonal_ma              =</span> <span class="dv">0</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"arima"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(media <span class="sc">~</span> mes, <span class="fu">training</span>(cv<span class="sc">$</span>splits[[<span class="dv">1</span>]]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sarima-com-multiplas-periodicidades" class="level2">
<h2 class="anchored" data-anchor-id="sarima-com-multiplas-periodicidades">SARIMA com multiplas periodicidades</h2>
<p>Trata-se de uma extensão do modelo SARIMA tradicional, que possibilita a incorporação de múltiplas sazonalidades em uma série temporal. Este modelo é especialmente útil quando os dados apresentam padrões sazonais em diferentes escalas de tempo.</p>
<p>Para a criação desse modelo foi utilizada a função <code>season_reg()</code> e a ‘engine’ <code>stlm_arima</code>. Uma aordagem que combina a decomposição de sazonalidade e tendência usando STLM (Seasonal and Trend decomposition using Loess) com a modelagem ARIMA para fazer previsões em séries temporais. Isso é comum ao usar a decomposição STLM para entender a estrutura da série temporal e, em seguida, aplicar modelos ARIMA ajustados aos dados decompostos para fazer previsões mais precisas.</p>
<p>Serão consideradas apenas as componentes de 18 e 12 meses, uma vez que a componente de 6 meses não se mostrou consistente ao longo dos dados.</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-9_4638342f85410503776da0350411ad1c">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>arima_m_season <span class="ot">&lt;-</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">seasonal_reg</span>(</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">seasonal_period_1 =</span> <span class="dv">16</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">seasonal_period_2 =</span> <span class="dv">12</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"stlm_arima"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(media <span class="sc">~</span> mes, <span class="fu">training</span>(cv<span class="sc">$</span>splits[[<span class="dv">1</span>]]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="arima-xgboost-dos-erros" class="level2">
<h2 class="anchored" data-anchor-id="arima-xgboost-dos-erros">ARIMA + XGBOOST dos erros</h2>
<p>A combinação de modelos SARIMA com algoritmos de machine learning, como o XGBoost (Extreme Gradient Boosting), é uma abordagem útil para melhorar a previsão de séries temporais, especialmente quando os dados exibem padrões complexos e não lineares. A ideia principal é aproveitar a capacidade de ambos os modelos para capturar diferentes aspectos da série temporal.</p>
<p>A função aqui utilizada, arima_boost(), é uma maneira de gerar uma especificação de um modelo de série temporal que utiliza o boosting para melhorar a modelagem de erros (residuais) em Regressores Exógenos. Funciona tanto com o ARIMA “automático” (auto_arima) quanto com o ARIMA padrão (arima). Os principais algoritmos são:</p>
<ul>
<li><p>engine = auto_arima_xgboost</p></li>
<li><p>ngine = arima_xgboost</p></li>
</ul>
<p>Esta função permite não apenas a seleção dos parâmetros comuns aos modelos SARIMA, mas também a seleção dos parâmetros associados ao modelo XGBoost. Como mencionado, essa abordagem tem como foco a melhoria dos resultados relacionados aos regressores exógenos, que são criados no seguinte trecho de código: <code>media ~ mes + as.numeric(mes) + factor(month(mes, label = TRUE), ordered = F)</code>.</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-10_5ea4bf549ec43b4eddb468de54e7d688">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>model_fit_arima_boosted <span class="ot">&lt;-</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arima_boost</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">seasonal_period =</span> <span class="dv">16</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">non_seasonal_ar =</span> <span class="dv">1</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">non_seasonal_differences =</span> <span class="dv">1</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">non_seasonal_ma =</span> <span class="dv">0</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">seasonal_ar     =</span> <span class="dv">1</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">seasonal_differences =</span> <span class="dv">1</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">seasonal_ma     =</span> <span class="dv">0</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># XGBoost Args</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">tree_depth =</span> <span class="dv">6</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">learn_rate =</span> <span class="fl">0.015</span>,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_n =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"arima_xgboost"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(media <span class="sc">~</span> mes <span class="sc">+</span> <span class="fu">as.numeric</span>(mes) <span class="sc">+</span> <span class="fu">factor</span>(<span class="fu">month</span>(mes, <span class="at">label =</span> <span class="cn">TRUE</span>), <span class="at">ordered =</span> F),</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> <span class="fu">training</span>(cv<span class="sc">$</span>splits[[<span class="dv">1</span>]]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="comparando-os-modelos" class="level1">
<h1>Comparando os modelos</h1>
<p>Para realizar a comparação dos modelos ajustados, o pacote <code>modeltime</code> disponibiliza a função <code>model_table()</code>, que permite a aplicação de diferentes procedimentos a todos os modelos de uma só vez.</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-11_1bd60c0fd6c1f276f117ef016f4db3be">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>model_table <span class="ot">&lt;-</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">modeltime_table</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  auto_arima,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  model_arima,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  model_arima2,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  arima_m_season,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  model_fit_arima_boosted</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="calibrando" class="level1">
<h1>Calibrando</h1>
<p>A seguir, iremos calibrar os modelos usando os dados de teste. A calibração estabelece os fundamentos para a criação dos resultados de acurácia, resíduos dos modelos, e dos intervalos de confiança nas previsões.</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-12_ff993982f82befff4d60dea8e2311e84">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>calib_table <span class="ot">&lt;-</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  model_table <span class="sc">%&gt;%</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modeltime_calibrate</span>(<span class="fu">testing</span>(cv<span class="sc">$</span>splits[[<span class="dv">1</span>]]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="residual" class="level1">
<h1>Residual</h1>
<p>Com os modelos calibrados, podemos avaliar os resíduos dos modelos. A função <code>modeltime_residuals()</code>, em conjunto com a função <code>plot_modeltime_residuals()</code>, oferece diversas opções de visualização dos resíduos, que incluem:</p>
<ul>
<li>timeplot</li>
<li>acf</li>
<li>seasonality</li>
</ul>
<p>Aqui será utilizado a opção acf/pacf</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-13_4bd82df54af4108b64d96c1658a9f37d">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>calib_table <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modeltime_residuals</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_modeltime_residuals</span>(</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">.type =</span> <span class="st">"acf"</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">.interactive =</span> <span class="cn">FALSE</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>     )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
</section>
<section id="acurácia" class="level1">
<h1>Acurácia</h1>
<p>Operando da mesma forma que as funções relacionadas aos resíduos dos modelos, o código a seguir gera uma tabela com os valores das métricas usadas para avaliar a qualidade dos modelos.</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-14_232d548f1e2fdf9f9c9f6656cd5a6d75">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>calib_table <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modeltime_accuracy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">table_modeltime_accuracy</span>(<span class="at">.interactive =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="swmgsjztja" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#swmgsjztja table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#swmgsjztja thead, #swmgsjztja tbody, #swmgsjztja tfoot, #swmgsjztja tr, #swmgsjztja td, #swmgsjztja th {
  border-style: none;
}

#swmgsjztja p {
  margin: 0;
  padding: 0;
}

#swmgsjztja .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#swmgsjztja .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#swmgsjztja .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#swmgsjztja .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#swmgsjztja .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#swmgsjztja .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#swmgsjztja .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#swmgsjztja .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#swmgsjztja .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#swmgsjztja .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#swmgsjztja .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#swmgsjztja .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#swmgsjztja .gt_spanner_row {
  border-bottom-style: hidden;
}

#swmgsjztja .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#swmgsjztja .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#swmgsjztja .gt_from_md > :first-child {
  margin-top: 0;
}

#swmgsjztja .gt_from_md > :last-child {
  margin-bottom: 0;
}

#swmgsjztja .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#swmgsjztja .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#swmgsjztja .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#swmgsjztja .gt_row_group_first td {
  border-top-width: 2px;
}

#swmgsjztja .gt_row_group_first th {
  border-top-width: 2px;
}

#swmgsjztja .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#swmgsjztja .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#swmgsjztja .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#swmgsjztja .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#swmgsjztja .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#swmgsjztja .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#swmgsjztja .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#swmgsjztja .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#swmgsjztja .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#swmgsjztja .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#swmgsjztja .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#swmgsjztja .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#swmgsjztja .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#swmgsjztja .gt_left {
  text-align: left;
}

#swmgsjztja .gt_center {
  text-align: center;
}

#swmgsjztja .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#swmgsjztja .gt_font_normal {
  font-weight: normal;
}

#swmgsjztja .gt_font_bold {
  font-weight: bold;
}

#swmgsjztja .gt_font_italic {
  font-style: italic;
}

#swmgsjztja .gt_super {
  font-size: 65%;
}

#swmgsjztja .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#swmgsjztja .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#swmgsjztja .gt_indent_1 {
  text-indent: 5px;
}

#swmgsjztja .gt_indent_2 {
  text-indent: 10px;
}

#swmgsjztja .gt_indent_3 {
  text-indent: 15px;
}

#swmgsjztja .gt_indent_4 {
  text-indent: 20px;
}

#swmgsjztja .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="9" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Accuracy Table</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id=".model_id">.model_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id=".model_desc">.model_desc</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id=".type">.type</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="mae">mae</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="mape">mape</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="mase">mase</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="smape">smape</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rmse">rmse</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rsq">rsq</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers=".model_id" class="gt_row gt_right">1</td>
<td headers=".model_desc" class="gt_row gt_left">ARIMA(1,1,0)</td>
<td headers=".type" class="gt_row gt_left">Test</td>
<td headers="mae" class="gt_row gt_right">21.82</td>
<td headers="mape" class="gt_row gt_right">12.22</td>
<td headers="mase" class="gt_row gt_right">5.16</td>
<td headers="smape" class="gt_row gt_right">13.09</td>
<td headers="rmse" class="gt_row gt_right">22.86</td>
<td headers="rsq" class="gt_row gt_right">0.64</td></tr>
    <tr><td headers=".model_id" class="gt_row gt_right">2</td>
<td headers=".model_desc" class="gt_row gt_left">ARIMA(1,1,0)(1,1,0)[16]</td>
<td headers=".type" class="gt_row gt_left">Test</td>
<td headers="mae" class="gt_row gt_right">13.06</td>
<td headers="mape" class="gt_row gt_right">7.36</td>
<td headers="mase" class="gt_row gt_right">3.09</td>
<td headers="smape" class="gt_row gt_right">7.67</td>
<td headers="rmse" class="gt_row gt_right">13.64</td>
<td headers="rsq" class="gt_row gt_right">0.67</td></tr>
    <tr><td headers=".model_id" class="gt_row gt_right">3</td>
<td headers=".model_desc" class="gt_row gt_left">ARIMA(1,1,0)(1,1,0)[12]</td>
<td headers=".type" class="gt_row gt_left">Test</td>
<td headers="mae" class="gt_row gt_right">23.67</td>
<td headers="mape" class="gt_row gt_right">13.27</td>
<td headers="mase" class="gt_row gt_right">5.60</td>
<td headers="smape" class="gt_row gt_right">14.34</td>
<td headers="rmse" class="gt_row gt_right">25.11</td>
<td headers="rsq" class="gt_row gt_right">0.00</td></tr>
    <tr><td headers=".model_id" class="gt_row gt_right">4</td>
<td headers=".model_desc" class="gt_row gt_left">SEASONAL DECOMP: ARIMA(0,1,1)</td>
<td headers=".type" class="gt_row gt_left">Test</td>
<td headers="mae" class="gt_row gt_right">14.29</td>
<td headers="mape" class="gt_row gt_right">8.04</td>
<td headers="mase" class="gt_row gt_right">3.38</td>
<td headers="smape" class="gt_row gt_right">8.40</td>
<td headers="rmse" class="gt_row gt_right">14.86</td>
<td headers="rsq" class="gt_row gt_right">0.66</td></tr>
    <tr><td headers=".model_id" class="gt_row gt_right">5</td>
<td headers=".model_desc" class="gt_row gt_left">ARIMA(1,1,0)(1,1,0)[16] W/ XGBOOST ERRORS</td>
<td headers=".type" class="gt_row gt_left">Test</td>
<td headers="mae" class="gt_row gt_right">12.53</td>
<td headers="mape" class="gt_row gt_right">7.07</td>
<td headers="mase" class="gt_row gt_right">2.97</td>
<td headers="smape" class="gt_row gt_right">7.35</td>
<td headers="rmse" class="gt_row gt_right">13.13</td>
<td headers="rsq" class="gt_row gt_right">0.67</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="visualização-do-conjunto-de-testes" class="level1">
<h1>Visualização do conjunto de testes</h1>
<p>Vamos agora avaliar o desempenho dos modelos em relação aos dados de teste. É importante lembrar que os modelos não foram treinados com o conjunto de dados completo, que abrange aproximadamente 10 anos, mas sim com um intervalo de 7 anos, conforme explicado durante o planejamento da validação cruzada.</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-15_073d2e0f67f684536bde65b80650fd36">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>calib_table <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modeltime_forecast</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">new_data =</span> <span class="fu">testing</span>(cv<span class="sc">$</span>splits[[<span class="dv">1</span>]]),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">actual_data =</span> gold_mean</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_modeltime_forecast</span>(<span class="at">.interactive =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
</section>
<section id="validação-cruzada---k-fold" class="level1">
<h1>Validação Cruzada - K-fold</h1>
<p>Até o momento utilizamos apenas o primeiro folder criado para realização da validação cruzada. Vamos agora varificar o desempenho médio em todos folders criados. A principal vantagem dessa abordagem é fornecer uma avaliação robusta e imparcial do desempenho de um modelo, mitigando problemas como overfitting (ajuste excessivo) e subajuste (underfitting).</p>
<p>Para realizar essa etapa é necessário a utilização do pacote <code>modeltime.resample</code>, uma extenção do pacote <code>modeltime</code>.</p>
<section id="ajustando-os-modelos-aos-diferentes-conjuntos-de-dados-folds." class="level2">
<h2 class="anchored" data-anchor-id="ajustando-os-modelos-aos-diferentes-conjuntos-de-dados-folds.">Ajustando os modelos aos diferentes conjuntos de dados (folds).</h2>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-16_257d643eae6a10a79967dcabb27ef690">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>resamples_fitted <span class="ot">&lt;-</span> model_table <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">modeltime_fit_resamples</span>(</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">resamples =</span> cv,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">control   =</span> <span class="fu">control_resamples</span>(<span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>resamples_fitted</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Modeltime Table
# A tibble: 5 × 4
  .model_id .model   .model_desc                               .resample_results
      &lt;int&gt; &lt;list&gt;   &lt;chr&gt;                                     &lt;list&gt;           
1         1 &lt;fit[+]&gt; ARIMA(1,1,0)                              &lt;rsmp[+]&gt;        
2         2 &lt;fit[+]&gt; ARIMA(1,1,0)(1,1,0)[16]                   &lt;rsmp[+]&gt;        
3         3 &lt;fit[+]&gt; ARIMA(1,1,0)(1,1,0)[12]                   &lt;rsmp[+]&gt;        
4         4 &lt;fit[+]&gt; SEASONAL DECOMP: ARIMA(0,1,1)             &lt;rsmp[+]&gt;        
5         5 &lt;fit[+]&gt; ARIMA(1,1,0)(1,1,0)[16] W/ XGBOOST ERRORS &lt;lgl [1]&gt;        </code></pre>
</div>
</div>
</section>
</section>
<section id="visualizando-o-desempenho-dos-modelos-nos-diferentes-conjuntos-de-dados-folds" class="level1">
<h1>Visualizando o desempenho dos modelos nos diferentes conjuntos de dados (folds)</h1>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-17_94e6fe3a8deb54257b760d365c5e39a1">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>resamples_fitted <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot_modeltime_resamples</span>(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">.point_size  =</span> <span class="dv">3</span>, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">.point_alpha =</span> <span class="fl">0.8</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">.interactive =</span> <span class="cn">FALSE</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
</section>
<section id="tabela-com-o-desempenho-médios-dos-modelos" class="level1">
<h1>Tabela com o desempenho médios dos modelos</h1>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-18_d11360c61c6716f19fe9608660f97cac">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>resamples_fitted <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">modeltime_resample_accuracy</span>(<span class="at">summary_fns =</span> mean) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">table_modeltime_accuracy</span>(<span class="at">.interactive =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="agzlvvbraw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#agzlvvbraw table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#agzlvvbraw thead, #agzlvvbraw tbody, #agzlvvbraw tfoot, #agzlvvbraw tr, #agzlvvbraw td, #agzlvvbraw th {
  border-style: none;
}

#agzlvvbraw p {
  margin: 0;
  padding: 0;
}

#agzlvvbraw .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#agzlvvbraw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#agzlvvbraw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#agzlvvbraw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#agzlvvbraw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#agzlvvbraw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#agzlvvbraw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#agzlvvbraw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#agzlvvbraw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#agzlvvbraw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#agzlvvbraw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#agzlvvbraw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#agzlvvbraw .gt_spanner_row {
  border-bottom-style: hidden;
}

#agzlvvbraw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#agzlvvbraw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#agzlvvbraw .gt_from_md > :first-child {
  margin-top: 0;
}

#agzlvvbraw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#agzlvvbraw .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#agzlvvbraw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#agzlvvbraw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#agzlvvbraw .gt_row_group_first td {
  border-top-width: 2px;
}

#agzlvvbraw .gt_row_group_first th {
  border-top-width: 2px;
}

#agzlvvbraw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#agzlvvbraw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#agzlvvbraw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#agzlvvbraw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#agzlvvbraw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#agzlvvbraw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#agzlvvbraw .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#agzlvvbraw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#agzlvvbraw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#agzlvvbraw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#agzlvvbraw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#agzlvvbraw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#agzlvvbraw .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#agzlvvbraw .gt_left {
  text-align: left;
}

#agzlvvbraw .gt_center {
  text-align: center;
}

#agzlvvbraw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#agzlvvbraw .gt_font_normal {
  font-weight: normal;
}

#agzlvvbraw .gt_font_bold {
  font-weight: bold;
}

#agzlvvbraw .gt_font_italic {
  font-style: italic;
}

#agzlvvbraw .gt_super {
  font-size: 65%;
}

#agzlvvbraw .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#agzlvvbraw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#agzlvvbraw .gt_indent_1 {
  text-indent: 5px;
}

#agzlvvbraw .gt_indent_2 {
  text-indent: 10px;
}

#agzlvvbraw .gt_indent_3 {
  text-indent: 15px;
}

#agzlvvbraw .gt_indent_4 {
  text-indent: 20px;
}

#agzlvvbraw .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="10" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Accuracy Table</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id=".model_id">.model_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id=".model_desc">.model_desc</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id=".type">.type</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n">n</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="mae">mae</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="mape">mape</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="mase">mase</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="smape">smape</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rmse">rmse</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rsq">rsq</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers=".model_id" class="gt_row gt_right">1</td>
<td headers=".model_desc" class="gt_row gt_left">ARIMA(1,1,0)</td>
<td headers=".type" class="gt_row gt_left">Resamples</td>
<td headers="n" class="gt_row gt_right">6</td>
<td headers="mae" class="gt_row gt_right">13.18</td>
<td headers="mape" class="gt_row gt_right">7.71</td>
<td headers="mase" class="gt_row gt_right">3.40</td>
<td headers="smape" class="gt_row gt_right">7.60</td>
<td headers="rmse" class="gt_row gt_right">15.01</td>
<td headers="rsq" class="gt_row gt_right">NA</td></tr>
    <tr><td headers=".model_id" class="gt_row gt_right">2</td>
<td headers=".model_desc" class="gt_row gt_left">ARIMA(1,1,0)(1,1,0)[16]</td>
<td headers=".type" class="gt_row gt_left">Resamples</td>
<td headers="n" class="gt_row gt_right">6</td>
<td headers="mae" class="gt_row gt_right">11.70</td>
<td headers="mape" class="gt_row gt_right">6.89</td>
<td headers="mase" class="gt_row gt_right">3.07</td>
<td headers="smape" class="gt_row gt_right">6.72</td>
<td headers="rmse" class="gt_row gt_right">13.57</td>
<td headers="rsq" class="gt_row gt_right">0.22</td></tr>
    <tr><td headers=".model_id" class="gt_row gt_right">3</td>
<td headers=".model_desc" class="gt_row gt_left">ARIMA(1,1,0)(1,1,0)[12]</td>
<td headers=".type" class="gt_row gt_left">Resamples</td>
<td headers="n" class="gt_row gt_right">6</td>
<td headers="mae" class="gt_row gt_right">16.55</td>
<td headers="mape" class="gt_row gt_right">9.72</td>
<td headers="mase" class="gt_row gt_right">4.22</td>
<td headers="smape" class="gt_row gt_right">9.53</td>
<td headers="rmse" class="gt_row gt_right">18.81</td>
<td headers="rsq" class="gt_row gt_right">0.16</td></tr>
    <tr><td headers=".model_id" class="gt_row gt_right">4</td>
<td headers=".model_desc" class="gt_row gt_left">SEASONAL DECOMP: ARIMA(0,1,1)</td>
<td headers=".type" class="gt_row gt_left">Resamples</td>
<td headers="n" class="gt_row gt_right">6</td>
<td headers="mae" class="gt_row gt_right">11.86</td>
<td headers="mape" class="gt_row gt_right">6.96</td>
<td headers="mase" class="gt_row gt_right">3.17</td>
<td headers="smape" class="gt_row gt_right">6.80</td>
<td headers="rmse" class="gt_row gt_right">13.66</td>
<td headers="rsq" class="gt_row gt_right">0.32</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="criando-as-previsões" class="level1">
<h1>Criando as previsões</h1>
<p>Por último vamos criar previsões futuras dos diferentes modelo que foram ajustados. Para isso vamos reajustar os modelos, desta vez no conjunto de dados completo.</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-19_17495263b7bb9d4fbbfa4886ea1bc840">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>future_forecast_tbl <span class="ot">&lt;-</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  calib_table <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modeltime_refit</span>(gold_mean) <span class="sc">%&gt;%</span> </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modeltime_forecast</span>(</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">h  =</span> <span class="st">"1 year"</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">actual_data =</span> gold_mean</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-20_e144ae1e0da8a8592ac2c48424326e1d">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>future_forecast_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_modeltime_forecast</span>(<span class="at">.interactive =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
</section>
<section id="conclusão" class="level1">
<h1>Conclusão</h1>
</section>
<section id="referências" class="level1">
<h1>Referências</h1>
<ul>
<li><p><a href="https://otexts.com/fpp3/arima.html">Forecasting: Principles and Practice (3rd ed)/Chapter 9 ARIMA models</a></p></li>
<li><p><a href="https://business-science.github.io/modeltime/articles/getting-started-with-modeltime.html">Getting Started with Modeltime</a></p></li>
<li><p><a href="https://business-science.github.io/modeltime/reference/arima_reg.html">General Interface for ARIMA Regression Models</a></p></li>
<li><p><a href="https://business-science.github.io/modeltime.resample/articles/getting-started.html">Getting Started with Modeltime Resample</a></p></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>